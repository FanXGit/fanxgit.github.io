<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>字符串匹配 - 文本预处理：后缀树（Suffix Tree） | Fanx 知识库</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/logo.svg">[object Object]
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.6ece31e0.css" as="style"><link rel="preload" href="/assets/js/app.38fd400a.js" as="script"><link rel="preload" href="/assets/js/3.e11db813.js" as="script"><link rel="preload" href="/assets/js/14.bc6d3062.js" as="script"><link rel="prefetch" href="/assets/js/10.939e2dd4.js"><link rel="prefetch" href="/assets/js/100.4a08f581.js"><link rel="prefetch" href="/assets/js/101.45cd45c9.js"><link rel="prefetch" href="/assets/js/102.ac1359d1.js"><link rel="prefetch" href="/assets/js/103.22344102.js"><link rel="prefetch" href="/assets/js/104.5071cdfd.js"><link rel="prefetch" href="/assets/js/105.7767c121.js"><link rel="prefetch" href="/assets/js/106.809b79f1.js"><link rel="prefetch" href="/assets/js/107.62fd626a.js"><link rel="prefetch" href="/assets/js/108.0583fdc1.js"><link rel="prefetch" href="/assets/js/109.fa127771.js"><link rel="prefetch" href="/assets/js/11.6463adc8.js"><link rel="prefetch" href="/assets/js/110.5cf9f09c.js"><link rel="prefetch" href="/assets/js/111.9d963667.js"><link rel="prefetch" href="/assets/js/112.bc2b8a6e.js"><link rel="prefetch" href="/assets/js/113.2ae29573.js"><link rel="prefetch" href="/assets/js/114.0b2cedfa.js"><link rel="prefetch" href="/assets/js/115.652e433e.js"><link rel="prefetch" href="/assets/js/116.bcc5d64a.js"><link rel="prefetch" href="/assets/js/117.30b02d0d.js"><link rel="prefetch" href="/assets/js/118.87f4f927.js"><link rel="prefetch" href="/assets/js/119.05839492.js"><link rel="prefetch" href="/assets/js/12.a17960e5.js"><link rel="prefetch" href="/assets/js/120.3d772c9c.js"><link rel="prefetch" href="/assets/js/121.bd8fcebf.js"><link rel="prefetch" href="/assets/js/122.e58d2205.js"><link rel="prefetch" href="/assets/js/123.f2c2826d.js"><link rel="prefetch" href="/assets/js/124.12d9ff87.js"><link rel="prefetch" href="/assets/js/125.c7e4bf1c.js"><link rel="prefetch" href="/assets/js/126.71c358fb.js"><link rel="prefetch" href="/assets/js/127.fb1922e5.js"><link rel="prefetch" href="/assets/js/128.25cbf771.js"><link rel="prefetch" href="/assets/js/129.50047ea3.js"><link rel="prefetch" href="/assets/js/13.727ebfda.js"><link rel="prefetch" href="/assets/js/130.a77cfa28.js"><link rel="prefetch" href="/assets/js/131.1618c1f5.js"><link rel="prefetch" href="/assets/js/132.4073573b.js"><link rel="prefetch" href="/assets/js/133.f6e4882f.js"><link rel="prefetch" href="/assets/js/134.1de81973.js"><link rel="prefetch" href="/assets/js/135.43148a0c.js"><link rel="prefetch" href="/assets/js/136.12b3ef34.js"><link rel="prefetch" href="/assets/js/137.accefc34.js"><link rel="prefetch" href="/assets/js/138.8d3115ff.js"><link rel="prefetch" href="/assets/js/139.6e492e2b.js"><link rel="prefetch" href="/assets/js/140.3d98f006.js"><link rel="prefetch" href="/assets/js/141.542d08af.js"><link rel="prefetch" href="/assets/js/142.c91a19a2.js"><link rel="prefetch" href="/assets/js/143.0c681ed2.js"><link rel="prefetch" href="/assets/js/144.62e9c646.js"><link rel="prefetch" href="/assets/js/145.ebc34777.js"><link rel="prefetch" href="/assets/js/146.d94a04a7.js"><link rel="prefetch" href="/assets/js/147.b45158de.js"><link rel="prefetch" href="/assets/js/148.5dfa6740.js"><link rel="prefetch" href="/assets/js/149.cb6f2cb0.js"><link rel="prefetch" href="/assets/js/15.a9468bf1.js"><link rel="prefetch" href="/assets/js/150.9f58dbc6.js"><link rel="prefetch" href="/assets/js/151.0a1c07e3.js"><link rel="prefetch" href="/assets/js/152.eafe4843.js"><link rel="prefetch" href="/assets/js/153.fb94cab5.js"><link rel="prefetch" href="/assets/js/154.07f7a11d.js"><link rel="prefetch" href="/assets/js/155.7f6da40b.js"><link rel="prefetch" href="/assets/js/156.2f007ca1.js"><link rel="prefetch" href="/assets/js/157.a35b5249.js"><link rel="prefetch" href="/assets/js/158.540f7a5a.js"><link rel="prefetch" href="/assets/js/159.f62e0315.js"><link rel="prefetch" href="/assets/js/16.ace3b806.js"><link rel="prefetch" href="/assets/js/160.e043c758.js"><link rel="prefetch" href="/assets/js/161.d90141bf.js"><link rel="prefetch" href="/assets/js/162.ddcdbfb9.js"><link rel="prefetch" href="/assets/js/163.f1ba395e.js"><link rel="prefetch" href="/assets/js/164.9f398973.js"><link rel="prefetch" href="/assets/js/165.0db3da51.js"><link rel="prefetch" href="/assets/js/166.b5305797.js"><link rel="prefetch" href="/assets/js/167.e7b2f76b.js"><link rel="prefetch" href="/assets/js/168.a2ecf883.js"><link rel="prefetch" href="/assets/js/169.88bd4d26.js"><link rel="prefetch" href="/assets/js/17.60481837.js"><link rel="prefetch" href="/assets/js/170.fb1699e2.js"><link rel="prefetch" href="/assets/js/171.47268bef.js"><link rel="prefetch" href="/assets/js/172.79002327.js"><link rel="prefetch" href="/assets/js/173.3b1813fb.js"><link rel="prefetch" href="/assets/js/174.362811a9.js"><link rel="prefetch" href="/assets/js/175.bb48bcd7.js"><link rel="prefetch" href="/assets/js/176.97bbf32c.js"><link rel="prefetch" href="/assets/js/177.0717ff7a.js"><link rel="prefetch" href="/assets/js/178.75bff3b7.js"><link rel="prefetch" href="/assets/js/179.3e7db0a2.js"><link rel="prefetch" href="/assets/js/18.dd3c5709.js"><link rel="prefetch" href="/assets/js/180.c81da8dd.js"><link rel="prefetch" href="/assets/js/181.142d6d1c.js"><link rel="prefetch" href="/assets/js/182.fb312040.js"><link rel="prefetch" href="/assets/js/183.3684267e.js"><link rel="prefetch" href="/assets/js/184.ec2a13bc.js"><link rel="prefetch" href="/assets/js/185.a7acace4.js"><link rel="prefetch" href="/assets/js/186.7df28551.js"><link rel="prefetch" href="/assets/js/187.347e9348.js"><link rel="prefetch" href="/assets/js/188.07356026.js"><link rel="prefetch" href="/assets/js/189.0816176d.js"><link rel="prefetch" href="/assets/js/19.cc2d4ad1.js"><link rel="prefetch" href="/assets/js/190.fd5dd8cc.js"><link rel="prefetch" href="/assets/js/191.a938967e.js"><link rel="prefetch" href="/assets/js/192.859b71a1.js"><link rel="prefetch" href="/assets/js/193.adcf2ec3.js"><link rel="prefetch" href="/assets/js/194.69d1169c.js"><link rel="prefetch" href="/assets/js/195.ad7cbcc4.js"><link rel="prefetch" href="/assets/js/196.b65138da.js"><link rel="prefetch" href="/assets/js/197.b4fca73b.js"><link rel="prefetch" href="/assets/js/198.2494a23f.js"><link rel="prefetch" href="/assets/js/199.404b9ce1.js"><link rel="prefetch" href="/assets/js/2.938bab56.js"><link rel="prefetch" href="/assets/js/20.361e2bf6.js"><link rel="prefetch" href="/assets/js/200.42b54eae.js"><link rel="prefetch" href="/assets/js/201.ab495eb8.js"><link rel="prefetch" href="/assets/js/202.2cbc5c9a.js"><link rel="prefetch" href="/assets/js/203.abf3fde5.js"><link rel="prefetch" href="/assets/js/204.4fdd4cfb.js"><link rel="prefetch" href="/assets/js/205.411987d7.js"><link rel="prefetch" href="/assets/js/206.dbcab3ae.js"><link rel="prefetch" href="/assets/js/207.f1429354.js"><link rel="prefetch" href="/assets/js/208.f763286c.js"><link rel="prefetch" href="/assets/js/209.c1edbca5.js"><link rel="prefetch" href="/assets/js/21.ae1e88a3.js"><link rel="prefetch" href="/assets/js/210.b2a1501d.js"><link rel="prefetch" href="/assets/js/211.fe1fd5f7.js"><link rel="prefetch" href="/assets/js/212.0fd39a8f.js"><link rel="prefetch" href="/assets/js/213.bb3fc163.js"><link rel="prefetch" href="/assets/js/214.c42e1ef3.js"><link rel="prefetch" href="/assets/js/215.4f0fa915.js"><link rel="prefetch" href="/assets/js/216.07c485c9.js"><link rel="prefetch" href="/assets/js/217.ada25e7a.js"><link rel="prefetch" href="/assets/js/218.2f761d3c.js"><link rel="prefetch" href="/assets/js/219.32d1a663.js"><link rel="prefetch" href="/assets/js/22.0b09d67f.js"><link rel="prefetch" href="/assets/js/220.36c56cf4.js"><link rel="prefetch" href="/assets/js/221.3e0431e2.js"><link rel="prefetch" href="/assets/js/222.90aa0ff7.js"><link rel="prefetch" href="/assets/js/223.5966d7df.js"><link rel="prefetch" href="/assets/js/224.7e2329e1.js"><link rel="prefetch" href="/assets/js/225.2ed3675d.js"><link rel="prefetch" href="/assets/js/226.fa3cef02.js"><link rel="prefetch" href="/assets/js/227.07bf7bca.js"><link rel="prefetch" href="/assets/js/228.9ac2589a.js"><link rel="prefetch" href="/assets/js/229.b980e141.js"><link rel="prefetch" href="/assets/js/23.31ed5c2f.js"><link rel="prefetch" href="/assets/js/230.2c32e874.js"><link rel="prefetch" href="/assets/js/231.723e20cb.js"><link rel="prefetch" href="/assets/js/232.1f94511c.js"><link rel="prefetch" href="/assets/js/233.2d477f71.js"><link rel="prefetch" href="/assets/js/234.10141c75.js"><link rel="prefetch" href="/assets/js/235.a328b127.js"><link rel="prefetch" href="/assets/js/236.42419c3b.js"><link rel="prefetch" href="/assets/js/237.648ca44e.js"><link rel="prefetch" href="/assets/js/238.4b363b75.js"><link rel="prefetch" href="/assets/js/239.fe711a73.js"><link rel="prefetch" href="/assets/js/24.fe75e3fa.js"><link rel="prefetch" href="/assets/js/240.6baa12bf.js"><link rel="prefetch" href="/assets/js/241.6f375dc4.js"><link rel="prefetch" href="/assets/js/242.aee8e39d.js"><link rel="prefetch" href="/assets/js/243.bfc7f6e1.js"><link rel="prefetch" href="/assets/js/244.c73a14a7.js"><link rel="prefetch" href="/assets/js/245.a2352aa1.js"><link rel="prefetch" href="/assets/js/246.b12c3ae6.js"><link rel="prefetch" href="/assets/js/247.2f768275.js"><link rel="prefetch" href="/assets/js/248.3f79dfb1.js"><link rel="prefetch" href="/assets/js/249.7fd0cb75.js"><link rel="prefetch" href="/assets/js/25.f2e379df.js"><link rel="prefetch" href="/assets/js/250.df3f1d0a.js"><link rel="prefetch" href="/assets/js/251.a3865750.js"><link rel="prefetch" href="/assets/js/252.d62542df.js"><link rel="prefetch" href="/assets/js/253.59b2f200.js"><link rel="prefetch" href="/assets/js/254.522d17b5.js"><link rel="prefetch" href="/assets/js/255.0f95a196.js"><link rel="prefetch" href="/assets/js/256.31b37cbe.js"><link rel="prefetch" href="/assets/js/257.ff22ad12.js"><link rel="prefetch" href="/assets/js/258.15205e0b.js"><link rel="prefetch" href="/assets/js/259.f3b7c5aa.js"><link rel="prefetch" href="/assets/js/26.45264b04.js"><link rel="prefetch" href="/assets/js/260.fec3c7aa.js"><link rel="prefetch" href="/assets/js/261.d965ee56.js"><link rel="prefetch" href="/assets/js/262.76a7105b.js"><link rel="prefetch" href="/assets/js/263.e684cc46.js"><link rel="prefetch" href="/assets/js/264.59297da0.js"><link rel="prefetch" href="/assets/js/265.66182ed2.js"><link rel="prefetch" href="/assets/js/266.eec50d90.js"><link rel="prefetch" href="/assets/js/267.c85bce12.js"><link rel="prefetch" href="/assets/js/268.ef544f0c.js"><link rel="prefetch" href="/assets/js/269.8cfb5c6a.js"><link rel="prefetch" href="/assets/js/27.4e065810.js"><link rel="prefetch" href="/assets/js/270.b66cab3c.js"><link rel="prefetch" href="/assets/js/271.c1b7d136.js"><link rel="prefetch" href="/assets/js/272.0d7950c3.js"><link rel="prefetch" href="/assets/js/273.06349cca.js"><link rel="prefetch" href="/assets/js/274.9b442c09.js"><link rel="prefetch" href="/assets/js/275.11082d81.js"><link rel="prefetch" href="/assets/js/276.ce0abe31.js"><link rel="prefetch" href="/assets/js/277.4b7fcc53.js"><link rel="prefetch" href="/assets/js/278.129d0397.js"><link rel="prefetch" href="/assets/js/279.5c021f7c.js"><link rel="prefetch" href="/assets/js/28.126ecd33.js"><link rel="prefetch" href="/assets/js/280.d183c9e3.js"><link rel="prefetch" href="/assets/js/281.0df67750.js"><link rel="prefetch" href="/assets/js/282.8fdd2372.js"><link rel="prefetch" href="/assets/js/283.dae956df.js"><link rel="prefetch" href="/assets/js/284.c5dc7189.js"><link rel="prefetch" href="/assets/js/285.7f5a7367.js"><link rel="prefetch" href="/assets/js/286.d9bfcef5.js"><link rel="prefetch" href="/assets/js/287.4fa6a5c5.js"><link rel="prefetch" href="/assets/js/288.57904d2d.js"><link rel="prefetch" href="/assets/js/289.b96d7c2f.js"><link rel="prefetch" href="/assets/js/29.8f5db82a.js"><link rel="prefetch" href="/assets/js/290.8dda9646.js"><link rel="prefetch" href="/assets/js/291.ab433493.js"><link rel="prefetch" href="/assets/js/292.e2d59796.js"><link rel="prefetch" href="/assets/js/293.30f9fcc4.js"><link rel="prefetch" href="/assets/js/294.158492dc.js"><link rel="prefetch" href="/assets/js/295.33e3a53d.js"><link rel="prefetch" href="/assets/js/296.49d7a2de.js"><link rel="prefetch" href="/assets/js/297.1b7572ac.js"><link rel="prefetch" href="/assets/js/298.00e4586a.js"><link rel="prefetch" href="/assets/js/299.d8fb6ff9.js"><link rel="prefetch" href="/assets/js/30.ef97cb8e.js"><link rel="prefetch" href="/assets/js/300.90e9dadf.js"><link rel="prefetch" href="/assets/js/301.d5592ea1.js"><link rel="prefetch" href="/assets/js/302.b08dc1ea.js"><link rel="prefetch" href="/assets/js/303.bef541c8.js"><link rel="prefetch" href="/assets/js/304.be3f7081.js"><link rel="prefetch" href="/assets/js/305.13718421.js"><link rel="prefetch" href="/assets/js/306.41685aa2.js"><link rel="prefetch" href="/assets/js/307.6d569102.js"><link rel="prefetch" href="/assets/js/308.aaabab89.js"><link rel="prefetch" href="/assets/js/309.910ecc42.js"><link rel="prefetch" href="/assets/js/31.795b3334.js"><link rel="prefetch" href="/assets/js/310.104b7753.js"><link rel="prefetch" href="/assets/js/311.45f4a7da.js"><link rel="prefetch" href="/assets/js/312.180c7e45.js"><link rel="prefetch" href="/assets/js/313.87d3a801.js"><link rel="prefetch" href="/assets/js/314.7739b1ef.js"><link rel="prefetch" href="/assets/js/315.54a1fac0.js"><link rel="prefetch" href="/assets/js/316.a978a787.js"><link rel="prefetch" href="/assets/js/317.84f65f2c.js"><link rel="prefetch" href="/assets/js/318.7f8caff8.js"><link rel="prefetch" href="/assets/js/319.0b5276f3.js"><link rel="prefetch" href="/assets/js/32.e65c7229.js"><link rel="prefetch" href="/assets/js/320.ba90589a.js"><link rel="prefetch" href="/assets/js/321.b6810c5a.js"><link rel="prefetch" href="/assets/js/322.2eaa727d.js"><link rel="prefetch" href="/assets/js/323.17573ee3.js"><link rel="prefetch" href="/assets/js/324.806fd6ca.js"><link rel="prefetch" href="/assets/js/325.4cd65079.js"><link rel="prefetch" href="/assets/js/326.fe0e2e22.js"><link rel="prefetch" href="/assets/js/327.a64d0209.js"><link rel="prefetch" href="/assets/js/328.aca1c89a.js"><link rel="prefetch" href="/assets/js/329.53ccf1dd.js"><link rel="prefetch" href="/assets/js/33.9a57aab8.js"><link rel="prefetch" href="/assets/js/330.92822a09.js"><link rel="prefetch" href="/assets/js/331.6b82baff.js"><link rel="prefetch" href="/assets/js/332.fc20f585.js"><link rel="prefetch" href="/assets/js/333.005ba8e3.js"><link rel="prefetch" href="/assets/js/334.9d3309b8.js"><link rel="prefetch" href="/assets/js/335.0e938f19.js"><link rel="prefetch" href="/assets/js/336.01fe9903.js"><link rel="prefetch" href="/assets/js/337.e207d67c.js"><link rel="prefetch" href="/assets/js/338.bfcf6bc8.js"><link rel="prefetch" href="/assets/js/339.a502aa64.js"><link rel="prefetch" href="/assets/js/34.3835d35c.js"><link rel="prefetch" href="/assets/js/340.3888b147.js"><link rel="prefetch" href="/assets/js/341.20297f95.js"><link rel="prefetch" href="/assets/js/342.9cd149e9.js"><link rel="prefetch" href="/assets/js/343.faac8369.js"><link rel="prefetch" href="/assets/js/344.da8cd079.js"><link rel="prefetch" href="/assets/js/345.78303b88.js"><link rel="prefetch" href="/assets/js/346.d8eaca82.js"><link rel="prefetch" href="/assets/js/347.edd389a1.js"><link rel="prefetch" href="/assets/js/348.21ee9617.js"><link rel="prefetch" href="/assets/js/349.0251471a.js"><link rel="prefetch" href="/assets/js/35.76dc7096.js"><link rel="prefetch" href="/assets/js/350.710b7d30.js"><link rel="prefetch" href="/assets/js/351.535f8d60.js"><link rel="prefetch" href="/assets/js/352.c66fe42e.js"><link rel="prefetch" href="/assets/js/353.ebbcd333.js"><link rel="prefetch" href="/assets/js/354.7cbba2f1.js"><link rel="prefetch" href="/assets/js/355.0106db16.js"><link rel="prefetch" href="/assets/js/356.7debf350.js"><link rel="prefetch" href="/assets/js/357.a43eb887.js"><link rel="prefetch" href="/assets/js/358.28e5d2ed.js"><link rel="prefetch" href="/assets/js/359.956fc3b8.js"><link rel="prefetch" href="/assets/js/36.fc54452c.js"><link rel="prefetch" href="/assets/js/360.13fb600a.js"><link rel="prefetch" href="/assets/js/361.d100f85b.js"><link rel="prefetch" href="/assets/js/362.35277df2.js"><link rel="prefetch" href="/assets/js/363.d993a7fc.js"><link rel="prefetch" href="/assets/js/364.0168c2b0.js"><link rel="prefetch" href="/assets/js/365.bc8af0bb.js"><link rel="prefetch" href="/assets/js/366.2645dc0d.js"><link rel="prefetch" href="/assets/js/367.87368acb.js"><link rel="prefetch" href="/assets/js/368.0b7d41fc.js"><link rel="prefetch" href="/assets/js/369.4bf3f46e.js"><link rel="prefetch" href="/assets/js/37.5a47cee9.js"><link rel="prefetch" href="/assets/js/370.ea5f965e.js"><link rel="prefetch" href="/assets/js/371.1af764ef.js"><link rel="prefetch" href="/assets/js/372.bf6c68e2.js"><link rel="prefetch" href="/assets/js/373.1a605cc8.js"><link rel="prefetch" href="/assets/js/374.34a41a4a.js"><link rel="prefetch" href="/assets/js/375.1d2d3776.js"><link rel="prefetch" href="/assets/js/376.4b7b0b10.js"><link rel="prefetch" href="/assets/js/377.b3d9748a.js"><link rel="prefetch" href="/assets/js/378.7f00fa88.js"><link rel="prefetch" href="/assets/js/379.adcd298a.js"><link rel="prefetch" href="/assets/js/38.6614c565.js"><link rel="prefetch" href="/assets/js/380.6d08bb56.js"><link rel="prefetch" href="/assets/js/381.164bb4e3.js"><link rel="prefetch" href="/assets/js/382.f71f0ca4.js"><link rel="prefetch" href="/assets/js/383.01ba70ad.js"><link rel="prefetch" href="/assets/js/384.22b98cde.js"><link rel="prefetch" href="/assets/js/385.5f1298a9.js"><link rel="prefetch" href="/assets/js/386.01a912bc.js"><link rel="prefetch" href="/assets/js/387.3db4713f.js"><link rel="prefetch" href="/assets/js/388.4cde7d0f.js"><link rel="prefetch" href="/assets/js/389.d96bafad.js"><link rel="prefetch" href="/assets/js/39.1a09ed15.js"><link rel="prefetch" href="/assets/js/390.343bbc06.js"><link rel="prefetch" href="/assets/js/391.68b3e72a.js"><link rel="prefetch" href="/assets/js/392.f4f15e43.js"><link rel="prefetch" href="/assets/js/393.82475934.js"><link rel="prefetch" href="/assets/js/394.3101ea10.js"><link rel="prefetch" href="/assets/js/395.34083342.js"><link rel="prefetch" href="/assets/js/396.780d6efe.js"><link rel="prefetch" href="/assets/js/397.cb686f39.js"><link rel="prefetch" href="/assets/js/398.c4ad669f.js"><link rel="prefetch" href="/assets/js/399.ee8d28ad.js"><link rel="prefetch" href="/assets/js/4.c1dcb1a7.js"><link rel="prefetch" href="/assets/js/40.4216f4f9.js"><link rel="prefetch" href="/assets/js/400.23d48a38.js"><link rel="prefetch" href="/assets/js/401.319d7a68.js"><link rel="prefetch" href="/assets/js/402.25b27bd0.js"><link rel="prefetch" href="/assets/js/403.9a898a40.js"><link rel="prefetch" href="/assets/js/404.e3b49b79.js"><link rel="prefetch" href="/assets/js/405.7695b9f1.js"><link rel="prefetch" href="/assets/js/406.edb801f7.js"><link rel="prefetch" href="/assets/js/407.03c3f725.js"><link rel="prefetch" href="/assets/js/408.4345ef1f.js"><link rel="prefetch" href="/assets/js/409.77c34447.js"><link rel="prefetch" href="/assets/js/41.f035663a.js"><link rel="prefetch" href="/assets/js/410.7f6c0744.js"><link rel="prefetch" href="/assets/js/411.cb19323e.js"><link rel="prefetch" href="/assets/js/412.4b16959d.js"><link rel="prefetch" href="/assets/js/413.ff4f1ca2.js"><link rel="prefetch" href="/assets/js/414.b1ca1298.js"><link rel="prefetch" href="/assets/js/415.c2111593.js"><link rel="prefetch" href="/assets/js/416.a6d18039.js"><link rel="prefetch" href="/assets/js/417.dc36c66d.js"><link rel="prefetch" href="/assets/js/418.e7eba879.js"><link rel="prefetch" href="/assets/js/419.57673b9e.js"><link rel="prefetch" href="/assets/js/42.9c8cf569.js"><link rel="prefetch" href="/assets/js/420.ccd41fe0.js"><link rel="prefetch" href="/assets/js/421.ea69f0b0.js"><link rel="prefetch" href="/assets/js/422.093448e2.js"><link rel="prefetch" href="/assets/js/423.ae003f31.js"><link rel="prefetch" href="/assets/js/424.f670cd2b.js"><link rel="prefetch" href="/assets/js/425.6e814335.js"><link rel="prefetch" href="/assets/js/426.faf45206.js"><link rel="prefetch" href="/assets/js/427.cf6be942.js"><link rel="prefetch" href="/assets/js/428.9ff6199c.js"><link rel="prefetch" href="/assets/js/429.b6ef4678.js"><link rel="prefetch" href="/assets/js/43.717fe06b.js"><link rel="prefetch" href="/assets/js/430.e9575d07.js"><link rel="prefetch" href="/assets/js/431.8bf26a3e.js"><link rel="prefetch" href="/assets/js/432.5eaa2162.js"><link rel="prefetch" href="/assets/js/433.6dab12a1.js"><link rel="prefetch" href="/assets/js/434.fca918e8.js"><link rel="prefetch" href="/assets/js/435.4c8f9ad9.js"><link rel="prefetch" href="/assets/js/436.0f0de1a8.js"><link rel="prefetch" href="/assets/js/437.2221ab9f.js"><link rel="prefetch" href="/assets/js/438.37f28cfb.js"><link rel="prefetch" href="/assets/js/439.1e3f3611.js"><link rel="prefetch" href="/assets/js/44.705dc411.js"><link rel="prefetch" href="/assets/js/440.28ab35e8.js"><link rel="prefetch" href="/assets/js/441.8d006af8.js"><link rel="prefetch" href="/assets/js/442.2618a6e3.js"><link rel="prefetch" href="/assets/js/443.a7723674.js"><link rel="prefetch" href="/assets/js/444.18f23e7c.js"><link rel="prefetch" href="/assets/js/445.f4807c5a.js"><link rel="prefetch" href="/assets/js/446.77a5afc2.js"><link rel="prefetch" href="/assets/js/447.7f653483.js"><link rel="prefetch" href="/assets/js/448.1143c566.js"><link rel="prefetch" href="/assets/js/449.b788a288.js"><link rel="prefetch" href="/assets/js/45.6a225373.js"><link rel="prefetch" href="/assets/js/450.b6463ba3.js"><link rel="prefetch" href="/assets/js/451.fd4d46b9.js"><link rel="prefetch" href="/assets/js/452.e8de4fc2.js"><link rel="prefetch" href="/assets/js/453.4125e5e6.js"><link rel="prefetch" href="/assets/js/454.30af5d0a.js"><link rel="prefetch" href="/assets/js/455.9c919e58.js"><link rel="prefetch" href="/assets/js/456.22dbfa8f.js"><link rel="prefetch" href="/assets/js/457.e9c5248a.js"><link rel="prefetch" href="/assets/js/458.c0a9cf1d.js"><link rel="prefetch" href="/assets/js/459.b5e96042.js"><link rel="prefetch" href="/assets/js/46.515d085a.js"><link rel="prefetch" href="/assets/js/460.b4097efb.js"><link rel="prefetch" href="/assets/js/461.5d545741.js"><link rel="prefetch" href="/assets/js/462.402d4cdd.js"><link rel="prefetch" href="/assets/js/463.e6d6ea07.js"><link rel="prefetch" href="/assets/js/464.df817445.js"><link rel="prefetch" href="/assets/js/465.18a6bc2b.js"><link rel="prefetch" href="/assets/js/466.da313c0c.js"><link rel="prefetch" href="/assets/js/467.41294182.js"><link rel="prefetch" href="/assets/js/468.41c59467.js"><link rel="prefetch" href="/assets/js/469.d55da13c.js"><link rel="prefetch" href="/assets/js/47.a41193df.js"><link rel="prefetch" href="/assets/js/470.7457a92e.js"><link rel="prefetch" href="/assets/js/471.ed739bdf.js"><link rel="prefetch" href="/assets/js/472.83882459.js"><link rel="prefetch" href="/assets/js/473.fe2df51c.js"><link rel="prefetch" href="/assets/js/474.d40797b8.js"><link rel="prefetch" href="/assets/js/475.a00992a2.js"><link rel="prefetch" href="/assets/js/476.c7687189.js"><link rel="prefetch" href="/assets/js/477.fd4fd227.js"><link rel="prefetch" href="/assets/js/478.1ae08c3b.js"><link rel="prefetch" href="/assets/js/479.04a246c6.js"><link rel="prefetch" href="/assets/js/48.fe693306.js"><link rel="prefetch" href="/assets/js/480.36acb4ff.js"><link rel="prefetch" href="/assets/js/481.05d3129e.js"><link rel="prefetch" href="/assets/js/482.1741a02c.js"><link rel="prefetch" href="/assets/js/483.44cf2d25.js"><link rel="prefetch" href="/assets/js/484.9c14e5c6.js"><link rel="prefetch" href="/assets/js/485.ea0c1de1.js"><link rel="prefetch" href="/assets/js/486.8c683697.js"><link rel="prefetch" href="/assets/js/487.8b1eb604.js"><link rel="prefetch" href="/assets/js/488.ae16fca6.js"><link rel="prefetch" href="/assets/js/489.7f674a0d.js"><link rel="prefetch" href="/assets/js/49.a7d05a3d.js"><link rel="prefetch" href="/assets/js/490.52983854.js"><link rel="prefetch" href="/assets/js/491.968e7af4.js"><link rel="prefetch" href="/assets/js/492.e7f58bac.js"><link rel="prefetch" href="/assets/js/493.55afbb68.js"><link rel="prefetch" href="/assets/js/494.ac17d05b.js"><link rel="prefetch" href="/assets/js/495.d1ca2a12.js"><link rel="prefetch" href="/assets/js/496.d6841a0e.js"><link rel="prefetch" href="/assets/js/497.99431b4b.js"><link rel="prefetch" href="/assets/js/498.cacac1d8.js"><link rel="prefetch" href="/assets/js/499.c6b7fab0.js"><link rel="prefetch" href="/assets/js/5.f74a04c4.js"><link rel="prefetch" href="/assets/js/50.f59b29ea.js"><link rel="prefetch" href="/assets/js/500.abba24c7.js"><link rel="prefetch" href="/assets/js/501.e9496674.js"><link rel="prefetch" href="/assets/js/502.3ece0e86.js"><link rel="prefetch" href="/assets/js/503.974421d1.js"><link rel="prefetch" href="/assets/js/504.6e8d8539.js"><link rel="prefetch" href="/assets/js/505.b8161483.js"><link rel="prefetch" href="/assets/js/506.a6a6f2de.js"><link rel="prefetch" href="/assets/js/507.9c6955ee.js"><link rel="prefetch" href="/assets/js/508.223e145d.js"><link rel="prefetch" href="/assets/js/509.553e6f2c.js"><link rel="prefetch" href="/assets/js/51.428c5495.js"><link rel="prefetch" href="/assets/js/510.46e2eab7.js"><link rel="prefetch" href="/assets/js/511.24962b3f.js"><link rel="prefetch" href="/assets/js/512.a29fe236.js"><link rel="prefetch" href="/assets/js/513.8729b339.js"><link rel="prefetch" href="/assets/js/514.41199019.js"><link rel="prefetch" href="/assets/js/515.b1a71e99.js"><link rel="prefetch" href="/assets/js/516.001e3634.js"><link rel="prefetch" href="/assets/js/517.4de05581.js"><link rel="prefetch" href="/assets/js/518.57697c31.js"><link rel="prefetch" href="/assets/js/519.e962365e.js"><link rel="prefetch" href="/assets/js/52.c97c3911.js"><link rel="prefetch" href="/assets/js/520.e7775961.js"><link rel="prefetch" href="/assets/js/521.05b0ce57.js"><link rel="prefetch" href="/assets/js/522.49f7412e.js"><link rel="prefetch" href="/assets/js/523.b3d821b2.js"><link rel="prefetch" href="/assets/js/524.ab2395b7.js"><link rel="prefetch" href="/assets/js/525.25559bb4.js"><link rel="prefetch" href="/assets/js/526.23111d2a.js"><link rel="prefetch" href="/assets/js/527.c61f6e86.js"><link rel="prefetch" href="/assets/js/528.032fa7b6.js"><link rel="prefetch" href="/assets/js/529.3953f346.js"><link rel="prefetch" href="/assets/js/53.77f22b1a.js"><link rel="prefetch" href="/assets/js/530.b882066e.js"><link rel="prefetch" href="/assets/js/531.62dddf23.js"><link rel="prefetch" href="/assets/js/532.1826fe1a.js"><link rel="prefetch" href="/assets/js/533.a2e014bb.js"><link rel="prefetch" href="/assets/js/534.d5d89c00.js"><link rel="prefetch" href="/assets/js/535.4e5d7739.js"><link rel="prefetch" href="/assets/js/536.f2c700db.js"><link rel="prefetch" href="/assets/js/537.80aa278c.js"><link rel="prefetch" href="/assets/js/538.95e2f471.js"><link rel="prefetch" href="/assets/js/539.4e4ecfe8.js"><link rel="prefetch" href="/assets/js/54.d85b2f2e.js"><link rel="prefetch" href="/assets/js/540.00bd44e5.js"><link rel="prefetch" href="/assets/js/541.d740df14.js"><link rel="prefetch" href="/assets/js/542.5aadeaee.js"><link rel="prefetch" href="/assets/js/543.d42c9d9a.js"><link rel="prefetch" href="/assets/js/544.29704685.js"><link rel="prefetch" href="/assets/js/545.7fdb1a83.js"><link rel="prefetch" href="/assets/js/546.6b5655ea.js"><link rel="prefetch" href="/assets/js/547.c98e27c4.js"><link rel="prefetch" href="/assets/js/548.8edec06f.js"><link rel="prefetch" href="/assets/js/549.33b8eae3.js"><link rel="prefetch" href="/assets/js/55.80a4fa71.js"><link rel="prefetch" href="/assets/js/550.cb706b0e.js"><link rel="prefetch" href="/assets/js/551.79598cc6.js"><link rel="prefetch" href="/assets/js/552.69aa5f8b.js"><link rel="prefetch" href="/assets/js/553.7ccb8831.js"><link rel="prefetch" href="/assets/js/554.954013b2.js"><link rel="prefetch" href="/assets/js/555.960d7f8b.js"><link rel="prefetch" href="/assets/js/556.5c054c14.js"><link rel="prefetch" href="/assets/js/557.890045ea.js"><link rel="prefetch" href="/assets/js/558.f72f6668.js"><link rel="prefetch" href="/assets/js/559.452d8ff3.js"><link rel="prefetch" href="/assets/js/56.009b0340.js"><link rel="prefetch" href="/assets/js/560.1656e33f.js"><link rel="prefetch" href="/assets/js/561.bb4650eb.js"><link rel="prefetch" href="/assets/js/562.7322fd81.js"><link rel="prefetch" href="/assets/js/563.a34a68ea.js"><link rel="prefetch" href="/assets/js/564.6da92e18.js"><link rel="prefetch" href="/assets/js/565.01d288e5.js"><link rel="prefetch" href="/assets/js/566.6a3459a1.js"><link rel="prefetch" href="/assets/js/567.e3eb8e54.js"><link rel="prefetch" href="/assets/js/568.f95e0fba.js"><link rel="prefetch" href="/assets/js/569.a42d134c.js"><link rel="prefetch" href="/assets/js/57.25e8dd1c.js"><link rel="prefetch" href="/assets/js/570.87887d15.js"><link rel="prefetch" href="/assets/js/571.ce4b478b.js"><link rel="prefetch" href="/assets/js/572.634418a6.js"><link rel="prefetch" href="/assets/js/573.cd4cf02b.js"><link rel="prefetch" href="/assets/js/574.8bf073fa.js"><link rel="prefetch" href="/assets/js/575.c194dddb.js"><link rel="prefetch" href="/assets/js/576.7750193f.js"><link rel="prefetch" href="/assets/js/577.5daa388a.js"><link rel="prefetch" href="/assets/js/578.54bb0029.js"><link rel="prefetch" href="/assets/js/579.92f58c76.js"><link rel="prefetch" href="/assets/js/58.9c1eb9e5.js"><link rel="prefetch" href="/assets/js/580.0e543efb.js"><link rel="prefetch" href="/assets/js/581.4e0b0b47.js"><link rel="prefetch" href="/assets/js/582.8c172f83.js"><link rel="prefetch" href="/assets/js/583.c91c43e0.js"><link rel="prefetch" href="/assets/js/584.ca68d52b.js"><link rel="prefetch" href="/assets/js/585.663b17d3.js"><link rel="prefetch" href="/assets/js/586.9494847d.js"><link rel="prefetch" href="/assets/js/587.f3805773.js"><link rel="prefetch" href="/assets/js/588.8ae14be1.js"><link rel="prefetch" href="/assets/js/589.b4af88be.js"><link rel="prefetch" href="/assets/js/59.2a730e41.js"><link rel="prefetch" href="/assets/js/590.fb77fea8.js"><link rel="prefetch" href="/assets/js/591.a3aaa57c.js"><link rel="prefetch" href="/assets/js/592.54ec5f32.js"><link rel="prefetch" href="/assets/js/593.96eab5cb.js"><link rel="prefetch" href="/assets/js/594.e356725c.js"><link rel="prefetch" href="/assets/js/595.0a2c4ad4.js"><link rel="prefetch" href="/assets/js/596.2c075cd8.js"><link rel="prefetch" href="/assets/js/597.e904811b.js"><link rel="prefetch" href="/assets/js/598.f6ca8b71.js"><link rel="prefetch" href="/assets/js/599.ae3d12c4.js"><link rel="prefetch" href="/assets/js/6.451e012f.js"><link rel="prefetch" href="/assets/js/60.e6b60343.js"><link rel="prefetch" href="/assets/js/600.e71a0062.js"><link rel="prefetch" href="/assets/js/601.2571a19d.js"><link rel="prefetch" href="/assets/js/602.0f4fa961.js"><link rel="prefetch" href="/assets/js/603.d8387c37.js"><link rel="prefetch" href="/assets/js/604.69433906.js"><link rel="prefetch" href="/assets/js/605.1bc7d87a.js"><link rel="prefetch" href="/assets/js/606.ec419517.js"><link rel="prefetch" href="/assets/js/607.b473fb0b.js"><link rel="prefetch" href="/assets/js/608.a361b48c.js"><link rel="prefetch" href="/assets/js/609.9186f226.js"><link rel="prefetch" href="/assets/js/61.d50a156d.js"><link rel="prefetch" href="/assets/js/610.ff3cf241.js"><link rel="prefetch" href="/assets/js/611.c3c7e648.js"><link rel="prefetch" href="/assets/js/612.2a520ebd.js"><link rel="prefetch" href="/assets/js/613.42936ffc.js"><link rel="prefetch" href="/assets/js/614.3ca0de21.js"><link rel="prefetch" href="/assets/js/615.ecf60a47.js"><link rel="prefetch" href="/assets/js/616.17185e83.js"><link rel="prefetch" href="/assets/js/617.769d4cdf.js"><link rel="prefetch" href="/assets/js/618.015c6376.js"><link rel="prefetch" href="/assets/js/619.3af186d0.js"><link rel="prefetch" href="/assets/js/62.e24b7811.js"><link rel="prefetch" href="/assets/js/620.f8ff3784.js"><link rel="prefetch" href="/assets/js/621.4c21311f.js"><link rel="prefetch" href="/assets/js/622.355178df.js"><link rel="prefetch" href="/assets/js/623.45a30695.js"><link rel="prefetch" href="/assets/js/624.61e89d34.js"><link rel="prefetch" href="/assets/js/625.49e0d1ce.js"><link rel="prefetch" href="/assets/js/626.1b7ae767.js"><link rel="prefetch" href="/assets/js/627.b8c507cf.js"><link rel="prefetch" href="/assets/js/628.c5a43517.js"><link rel="prefetch" href="/assets/js/629.274eb0fd.js"><link rel="prefetch" href="/assets/js/63.b804baab.js"><link rel="prefetch" href="/assets/js/630.69e055ce.js"><link rel="prefetch" href="/assets/js/631.0892fc51.js"><link rel="prefetch" href="/assets/js/632.6a68e9a2.js"><link rel="prefetch" href="/assets/js/633.d536fe74.js"><link rel="prefetch" href="/assets/js/634.24695f39.js"><link rel="prefetch" href="/assets/js/635.3aeede9c.js"><link rel="prefetch" href="/assets/js/636.3628d8a6.js"><link rel="prefetch" href="/assets/js/637.40af5a79.js"><link rel="prefetch" href="/assets/js/638.15e257ae.js"><link rel="prefetch" href="/assets/js/639.31e6597c.js"><link rel="prefetch" href="/assets/js/64.eb5699ff.js"><link rel="prefetch" href="/assets/js/640.a071f6df.js"><link rel="prefetch" href="/assets/js/641.f9edd7bf.js"><link rel="prefetch" href="/assets/js/642.adcb583f.js"><link rel="prefetch" href="/assets/js/643.7c98a990.js"><link rel="prefetch" href="/assets/js/644.fb1213d8.js"><link rel="prefetch" href="/assets/js/645.220a5034.js"><link rel="prefetch" href="/assets/js/646.d66a419b.js"><link rel="prefetch" href="/assets/js/647.12ef89ab.js"><link rel="prefetch" href="/assets/js/648.a3112300.js"><link rel="prefetch" href="/assets/js/649.f457dfa5.js"><link rel="prefetch" href="/assets/js/65.0d8501b5.js"><link rel="prefetch" href="/assets/js/650.cc63d03b.js"><link rel="prefetch" href="/assets/js/651.16d1bbd6.js"><link rel="prefetch" href="/assets/js/652.0f5343f0.js"><link rel="prefetch" href="/assets/js/653.28f7710a.js"><link rel="prefetch" href="/assets/js/654.b343d473.js"><link rel="prefetch" href="/assets/js/655.215fe67b.js"><link rel="prefetch" href="/assets/js/656.79aa1653.js"><link rel="prefetch" href="/assets/js/657.c57f2b5c.js"><link rel="prefetch" href="/assets/js/658.d0aa0b95.js"><link rel="prefetch" href="/assets/js/659.2dfaed93.js"><link rel="prefetch" href="/assets/js/66.8361cc16.js"><link rel="prefetch" href="/assets/js/660.c00b347e.js"><link rel="prefetch" href="/assets/js/661.ecc4f968.js"><link rel="prefetch" href="/assets/js/662.06f83919.js"><link rel="prefetch" href="/assets/js/663.67d8849e.js"><link rel="prefetch" href="/assets/js/664.74dba1a9.js"><link rel="prefetch" href="/assets/js/665.28b450f0.js"><link rel="prefetch" href="/assets/js/666.0f4bb6ba.js"><link rel="prefetch" href="/assets/js/667.586074e3.js"><link rel="prefetch" href="/assets/js/668.b13c0e70.js"><link rel="prefetch" href="/assets/js/669.9d0d4cbc.js"><link rel="prefetch" href="/assets/js/67.37f46ba2.js"><link rel="prefetch" href="/assets/js/670.6b36ca72.js"><link rel="prefetch" href="/assets/js/671.33b2e754.js"><link rel="prefetch" href="/assets/js/672.3b02c287.js"><link rel="prefetch" href="/assets/js/673.3f274929.js"><link rel="prefetch" href="/assets/js/674.7d75584f.js"><link rel="prefetch" href="/assets/js/675.0de52334.js"><link rel="prefetch" href="/assets/js/676.6734133e.js"><link rel="prefetch" href="/assets/js/677.c6f4a973.js"><link rel="prefetch" href="/assets/js/678.1344b6be.js"><link rel="prefetch" href="/assets/js/679.23fed56f.js"><link rel="prefetch" href="/assets/js/68.27dbce5b.js"><link rel="prefetch" href="/assets/js/680.c49329d6.js"><link rel="prefetch" href="/assets/js/681.8df66615.js"><link rel="prefetch" href="/assets/js/682.77b4bff8.js"><link rel="prefetch" href="/assets/js/683.6cf41cf4.js"><link rel="prefetch" href="/assets/js/684.58deecd5.js"><link rel="prefetch" href="/assets/js/685.d2f7480e.js"><link rel="prefetch" href="/assets/js/686.0b77a241.js"><link rel="prefetch" href="/assets/js/687.2cc04b4f.js"><link rel="prefetch" href="/assets/js/688.da24cbae.js"><link rel="prefetch" href="/assets/js/689.a9961f74.js"><link rel="prefetch" href="/assets/js/69.8052a977.js"><link rel="prefetch" href="/assets/js/690.cb736269.js"><link rel="prefetch" href="/assets/js/691.21c13be1.js"><link rel="prefetch" href="/assets/js/692.3ed557d0.js"><link rel="prefetch" href="/assets/js/693.066efe93.js"><link rel="prefetch" href="/assets/js/694.5368f98a.js"><link rel="prefetch" href="/assets/js/695.4fdb93d5.js"><link rel="prefetch" href="/assets/js/696.9c055ac6.js"><link rel="prefetch" href="/assets/js/697.51e0c47c.js"><link rel="prefetch" href="/assets/js/698.08ca1dbd.js"><link rel="prefetch" href="/assets/js/699.ce7e9e2a.js"><link rel="prefetch" href="/assets/js/7.7e21c947.js"><link rel="prefetch" href="/assets/js/70.19faeb78.js"><link rel="prefetch" href="/assets/js/700.3676fa7f.js"><link rel="prefetch" href="/assets/js/701.82db4887.js"><link rel="prefetch" href="/assets/js/702.73425f22.js"><link rel="prefetch" href="/assets/js/703.d9391c74.js"><link rel="prefetch" href="/assets/js/704.d6e275cf.js"><link rel="prefetch" href="/assets/js/705.d2f23969.js"><link rel="prefetch" href="/assets/js/706.1c66dcc1.js"><link rel="prefetch" href="/assets/js/707.0fc5a26a.js"><link rel="prefetch" href="/assets/js/708.97471ee6.js"><link rel="prefetch" href="/assets/js/709.9b4d5665.js"><link rel="prefetch" href="/assets/js/71.d1683810.js"><link rel="prefetch" href="/assets/js/710.75fa8103.js"><link rel="prefetch" href="/assets/js/711.43777b40.js"><link rel="prefetch" href="/assets/js/712.5c583e39.js"><link rel="prefetch" href="/assets/js/713.5aa72111.js"><link rel="prefetch" href="/assets/js/714.e8215702.js"><link rel="prefetch" href="/assets/js/715.46614e7c.js"><link rel="prefetch" href="/assets/js/716.eaac6d69.js"><link rel="prefetch" href="/assets/js/717.c344c042.js"><link rel="prefetch" href="/assets/js/718.437bf0b2.js"><link rel="prefetch" href="/assets/js/719.23aa3deb.js"><link rel="prefetch" href="/assets/js/72.9fa783f0.js"><link rel="prefetch" href="/assets/js/720.9456a449.js"><link rel="prefetch" href="/assets/js/721.67fd324a.js"><link rel="prefetch" href="/assets/js/722.fc5e79ca.js"><link rel="prefetch" href="/assets/js/723.46db8115.js"><link rel="prefetch" href="/assets/js/724.31a11b8c.js"><link rel="prefetch" href="/assets/js/725.49cef603.js"><link rel="prefetch" href="/assets/js/726.7d0a2e7f.js"><link rel="prefetch" href="/assets/js/727.a1de6f02.js"><link rel="prefetch" href="/assets/js/728.7e0a727e.js"><link rel="prefetch" href="/assets/js/729.b6bf04fa.js"><link rel="prefetch" href="/assets/js/73.1ac0ac37.js"><link rel="prefetch" href="/assets/js/730.1c102528.js"><link rel="prefetch" href="/assets/js/731.80403e3d.js"><link rel="prefetch" href="/assets/js/732.cf8b4a6d.js"><link rel="prefetch" href="/assets/js/733.aab88d38.js"><link rel="prefetch" href="/assets/js/734.965a0adc.js"><link rel="prefetch" href="/assets/js/735.f9d33608.js"><link rel="prefetch" href="/assets/js/736.d1621f9e.js"><link rel="prefetch" href="/assets/js/737.a12ea0d3.js"><link rel="prefetch" href="/assets/js/738.96e61512.js"><link rel="prefetch" href="/assets/js/739.9bce4dfe.js"><link rel="prefetch" href="/assets/js/74.1913daec.js"><link rel="prefetch" href="/assets/js/740.c1a0bf7b.js"><link rel="prefetch" href="/assets/js/741.0185115e.js"><link rel="prefetch" href="/assets/js/742.21e99d78.js"><link rel="prefetch" href="/assets/js/743.e5f2407e.js"><link rel="prefetch" href="/assets/js/744.53d4e25a.js"><link rel="prefetch" href="/assets/js/745.9fb6722c.js"><link rel="prefetch" href="/assets/js/746.893e3a2f.js"><link rel="prefetch" href="/assets/js/747.ad94fed4.js"><link rel="prefetch" href="/assets/js/748.3421b09b.js"><link rel="prefetch" href="/assets/js/749.15c364e9.js"><link rel="prefetch" href="/assets/js/75.d63a9540.js"><link rel="prefetch" href="/assets/js/750.4e5379b7.js"><link rel="prefetch" href="/assets/js/751.18b0273f.js"><link rel="prefetch" href="/assets/js/752.24717596.js"><link rel="prefetch" href="/assets/js/753.5868bcc4.js"><link rel="prefetch" href="/assets/js/754.77808a6c.js"><link rel="prefetch" href="/assets/js/755.af7f7a71.js"><link rel="prefetch" href="/assets/js/76.342d837c.js"><link rel="prefetch" href="/assets/js/77.466349c3.js"><link rel="prefetch" href="/assets/js/78.886d05b6.js"><link rel="prefetch" href="/assets/js/79.b478bdab.js"><link rel="prefetch" href="/assets/js/8.9f40767d.js"><link rel="prefetch" href="/assets/js/80.9205cc43.js"><link rel="prefetch" href="/assets/js/81.77f831c9.js"><link rel="prefetch" href="/assets/js/82.650475d1.js"><link rel="prefetch" href="/assets/js/83.aa7e3d4b.js"><link rel="prefetch" href="/assets/js/84.2fc92fb4.js"><link rel="prefetch" href="/assets/js/85.0f633e10.js"><link rel="prefetch" href="/assets/js/86.e862f4bc.js"><link rel="prefetch" href="/assets/js/87.8a869468.js"><link rel="prefetch" href="/assets/js/88.6c584051.js"><link rel="prefetch" href="/assets/js/89.3ab84e02.js"><link rel="prefetch" href="/assets/js/9.7ed864ce.js"><link rel="prefetch" href="/assets/js/90.41e6925d.js"><link rel="prefetch" href="/assets/js/91.55055993.js"><link rel="prefetch" href="/assets/js/92.ced7b439.js"><link rel="prefetch" href="/assets/js/93.41cc8a7f.js"><link rel="prefetch" href="/assets/js/94.6d2b144f.js"><link rel="prefetch" href="/assets/js/95.399a7909.js"><link rel="prefetch" href="/assets/js/96.556f8f9f.js"><link rel="prefetch" href="/assets/js/97.47ecdf46.js"><link rel="prefetch" href="/assets/js/98.fdbe6822.js"><link rel="prefetch" href="/assets/js/99.db8442e4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6ece31e0.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Fanx 知识库" class="logo"> <span class="site-name can-hide">Fanx 知识库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/779590/" class="nav-link">Java基础</a></li><li class="dropdown-item"><!----> <a href="/pages/dc7834/" class="nav-link">Java集合框架</a></li><li class="dropdown-item"><!----> <a href="/pages/f2d7db/" class="nav-link">Java多线程并发</a></li><li class="dropdown-item"><!----> <a href="/pages/dbec4d/" class="nav-link">JavaIo&amp;NIO&amp;AIO</a></li><li class="dropdown-item"><!----> <a href="/pages/b908ce/" class="nav-link">JDK相关特性</a></li><li class="dropdown-item"><!----> <a href="/pages/e59bea/" class="nav-link">JVM相关</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f8c059/" class="nav-link">数据库基础知识</a></li><li class="dropdown-item"><!----> <a href="/pages/d192fd/" class="nav-link">Mysql</a></li><li class="dropdown-item"><!----> <a href="/pages/8aa877/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/077e7c/" class="nav-link">MogoDb</a></li><li class="dropdown-item"><!----> <a href="/pages/68281b/" class="nav-link">ElasticSearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用框架" class="dropdown-title"><!----> <span class="title" style="display:;">常用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/commonFrameworks/mybatis/" class="nav-link">mybatis</a></li><li class="dropdown-item"><!----> <a href="/pages/8f6500/" class="nav-link">Spring Framework 5基础</a></li><li class="dropdown-item"><!----> <a href="/pages/7c08d4/" class="nav-link">SpringBoot 2.5.x系列</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源代码学习" class="dropdown-title"><!----> <span class="title" style="display:;">源代码学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/23a632/" class="nav-link">mybatis源码学习</a></li><li class="dropdown-item"><!----> <a href="/sourceCode/java/" class="nav-link">java源代码</a></li><li class="dropdown-item"><!----> <a href="/sourceCode/spring/" class="nav-link">Spring源码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试相关" class="dropdown-title"><!----> <span class="title" style="display:;">面试相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/2cef48/" class="nav-link">Java 基础</a></li><li class="dropdown-item"><!----> <a href="/pages/ad2692/" class="nav-link">Spring 框架</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用的技术工具" class="dropdown-title"><!----> <span class="title" style="display:;">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tool/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/linux/common/" class="nav-link">linux常用命令实践</a></li><li class="dropdown-item"><!----> <a href="/tool/maven/" class="nav-link">Mavan</a></li><li class="dropdown-item"><!----> <a href="/pages/b25802/" class="nav-link">开发工具详解</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它语言" class="dropdown-title"><!----> <span class="title" style="display:;">其它语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fc414d/" class="nav-link">Python基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="问题总结" class="dropdown-title"><!----> <span class="title" style="display:;">问题总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/question/redis/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/pages/4d0fa7/" class="nav-link">团队相关</a></li><li class="dropdown-item"><!----> <a href="/pages/75c3d7/" class="nav-link">fanx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><!----> <span class="title" style="display:;">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/caf303/" class="nav-link">数据结构基础</a></li><li class="dropdown-item"><!----> <a href="/pages/395e23/" class="nav-link">常见排序算法</a></li><li class="dropdown-item"><!----> <a href="/pages/fa3dd3/" class="nav-link">算法思想</a></li><li class="dropdown-item"><!----> <a href="/pages/79d342/" class="nav-link">一些领域算法</a></li><li class="dropdown-item"><!----> <a href="/pages/fdb54d/" class="nav-link">其它算法相关</a></li></ul></div></div> <a href="https://fanxgit.github.io/fanxNotes/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/779590/" class="nav-link">Java基础</a></li><li class="dropdown-item"><!----> <a href="/pages/dc7834/" class="nav-link">Java集合框架</a></li><li class="dropdown-item"><!----> <a href="/pages/f2d7db/" class="nav-link">Java多线程并发</a></li><li class="dropdown-item"><!----> <a href="/pages/dbec4d/" class="nav-link">JavaIo&amp;NIO&amp;AIO</a></li><li class="dropdown-item"><!----> <a href="/pages/b908ce/" class="nav-link">JDK相关特性</a></li><li class="dropdown-item"><!----> <a href="/pages/e59bea/" class="nav-link">JVM相关</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f8c059/" class="nav-link">数据库基础知识</a></li><li class="dropdown-item"><!----> <a href="/pages/d192fd/" class="nav-link">Mysql</a></li><li class="dropdown-item"><!----> <a href="/pages/8aa877/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/077e7c/" class="nav-link">MogoDb</a></li><li class="dropdown-item"><!----> <a href="/pages/68281b/" class="nav-link">ElasticSearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用框架" class="dropdown-title"><!----> <span class="title" style="display:;">常用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/commonFrameworks/mybatis/" class="nav-link">mybatis</a></li><li class="dropdown-item"><!----> <a href="/pages/8f6500/" class="nav-link">Spring Framework 5基础</a></li><li class="dropdown-item"><!----> <a href="/pages/7c08d4/" class="nav-link">SpringBoot 2.5.x系列</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源代码学习" class="dropdown-title"><!----> <span class="title" style="display:;">源代码学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/23a632/" class="nav-link">mybatis源码学习</a></li><li class="dropdown-item"><!----> <a href="/sourceCode/java/" class="nav-link">java源代码</a></li><li class="dropdown-item"><!----> <a href="/sourceCode/spring/" class="nav-link">Spring源码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试相关" class="dropdown-title"><!----> <span class="title" style="display:;">面试相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/2cef48/" class="nav-link">Java 基础</a></li><li class="dropdown-item"><!----> <a href="/pages/ad2692/" class="nav-link">Spring 框架</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用的技术工具" class="dropdown-title"><!----> <span class="title" style="display:;">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tool/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/linux/common/" class="nav-link">linux常用命令实践</a></li><li class="dropdown-item"><!----> <a href="/tool/maven/" class="nav-link">Mavan</a></li><li class="dropdown-item"><!----> <a href="/pages/b25802/" class="nav-link">开发工具详解</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它语言" class="dropdown-title"><!----> <span class="title" style="display:;">其它语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fc414d/" class="nav-link">Python基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="问题总结" class="dropdown-title"><!----> <span class="title" style="display:;">问题总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/question/redis/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/pages/4d0fa7/" class="nav-link">团队相关</a></li><li class="dropdown-item"><!----> <a href="/pages/75c3d7/" class="nav-link">fanx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><!----> <span class="title" style="display:;">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/caf303/" class="nav-link">数据结构基础</a></li><li class="dropdown-item"><!----> <a href="/pages/395e23/" class="nav-link">常见排序算法</a></li><li class="dropdown-item"><!----> <a href="/pages/fa3dd3/" class="nav-link">算法思想</a></li><li class="dropdown-item"><!----> <a href="/pages/79d342/" class="nav-link">一些领域算法</a></li><li class="dropdown-item"><!----> <a href="/pages/fdb54d/" class="nav-link">其它算法相关</a></li></ul></div></div> <a href="https://fanxgit.github.io/fanxNotes/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>常见排序算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法思想</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>一些领域算法</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/79d342/" class="sidebar-link">♥一些领域算法知识体系♥</a></li><li><a href="/pages/e67d0b/" class="sidebar-link">安全算法 - 摘要算法</a></li><li><a href="/pages/c842e4/" class="sidebar-link">安全算法 - 加密算法</a></li><li><a href="/pages/b0dfbe/" class="sidebar-link">安全算法 - 国密算法</a></li><li><a href="/pages/b2408d/" class="sidebar-link">字符串匹配 - Overview</a></li><li><a href="/pages/5c1b0a/" class="sidebar-link">字符串匹配 - 模式预处理：朴素算法（Naive)(暴力破解)</a></li><li><a href="/pages/38e466/" class="sidebar-link">字符串匹配 - 模式预处理：KMP 算法（Knuth-Morris-Pratt）</a></li><li><a href="/pages/08a264/" class="sidebar-link">字符串匹配 - 模式预处理：BM 算法 (Boyer-Moore)</a></li><li><a href="/pages/22afd6/" aria-current="page" class="active sidebar-link">字符串匹配 - 文本预处理：后缀树（Suffix Tree）</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/52b53d/" class="sidebar-link">大数据处理 - Overview</a></li><li><a href="/pages/6c41c1/" class="sidebar-link">大数据处理 - 分治-hash-排序</a></li><li><a href="/pages/47c222/" class="sidebar-link">大数据处理 - Bitmap &amp; Bloom Filter</a></li><li><a href="/pages/058afb/" class="sidebar-link">大数据处理 - 双层桶划分</a></li><li><a href="/pages/1583ff/" class="sidebar-link">大数据处理 - Trie树-数据库-倒排索引</a></li><li><a href="/pages/b0029f/" class="sidebar-link">大数据处理 - 外（磁盘文件）排序</a></li><li><a href="/pages/6b16f1/" class="sidebar-link">大数据处理 - Map &amp; Reduce</a></li><li><a href="/pages/f7e1f0/" class="sidebar-link">分布式算法 - Overview</a></li><li><a href="/pages/2dfc27/" class="sidebar-link">分布式算法 - 一致性Hash算法</a></li><li><a href="/pages/a117d6/" class="sidebar-link">分布式算法 - Paxos算法</a></li><li><a href="/pages/58f8b3/" class="sidebar-link">分布式算法 - Raft算法</a></li><li><a href="/pages/281bc3/" class="sidebar-link">分布式算法 - ZAB算法</a></li><li><a href="/pages/23f6f4/" class="sidebar-link">分布式算法 - Snowflake算法</a></li><li><a href="/pages/a0f76d/" class="sidebar-link">负载均衡算法 - 汇总</a></li><li><a href="/pages/8d294f/" class="sidebar-link">推荐算法 - 汇总</a></li><li><a href="/pages/45ca3e/" class="sidebar-link">数据挖掘 - 10大算法汇总</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其它算法相关</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=algorithm" title="分类" data-v-06225672>algorithm</a></li><li data-v-06225672><a href="/categories/?category=%E4%B8%80%E4%BA%9B%E9%A2%86%E5%9F%9F%E7%AE%97%E6%B3%95" title="分类" data-v-06225672>一些领域算法</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/FanXGit" target="_blank" title="作者" class="beLink" data-v-06225672>fanx</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-08-07</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">字符串匹配 - 文本预处理：后缀树（Suffix Tree）<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="字符串匹配-文本预处理-后缀树-suffix-tree"><a href="#字符串匹配-文本预处理-后缀树-suffix-tree" class="header-anchor">#</a> 字符串匹配 - 文本预处理：后缀树（Suffix Tree）</h1> <p>================================================================</p> <blockquote><p>上述字符串匹配算法(朴素的字符串匹配算法, KMP 算法, Boyer-Moore算法)均是通过对<strong>模式（Pattern）字符串进行预处理</strong>的方式来加快搜索速度。对 Pattern 进行预处理的最优复杂度为 O(m)，其中 m 为 Pattern 字符串的长度。那么，有没有对文本（Text）进行预处理的算法呢？本文即将介绍一种<strong>对 Text 进行预处理</strong>的字符串匹配算法：后缀树（Suffix Tree）。@pdai</p></blockquote> <ul><li><a href="https://pdai.tech/md/algorithm/alg-domain-char-match-st.html#%E4%BB%80%E4%B9%88%E6%98%AF%E5%90%8E%E7%BC%80%E6%A0%91" target="_blank" rel="noopener noreferrer">什么是后缀树<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://pdai.tech/md/algorithm/alg-domain-char-match-st.html#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0" target="_blank" rel="noopener noreferrer">参考文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h1 id="什么是后缀树"><a href="#什么是后缀树" class="header-anchor">#</a> 什么是后缀树</h1> <hr> <p>上述字符串匹配算法(朴素的字符串匹配算法, KMP 算法, Boyer-Moore算法)均是通过对<strong>模式（Pattern）字符串进行预处理</strong>的方式来加快搜索速度。对 Pattern 进行预处理的最优复杂度为 O(m)，其中 m 为 Pattern 字符串的长度。那么，有没有对文本（Text）进行预处理的算法呢？本文即将介绍一种<strong>对 Text 进行预处理</strong>的字符串匹配算法：后缀树（Suffix Tree）。</p> <p><strong>后缀树的性质</strong>：</p> <ul><li>存储所有 n(n-1)/2 个后缀需要 O(n) 的空间，n 为的文本（Text）的长度；</li> <li>构建后缀树需要 O(dn) 的时间，d 为字符集的长度（alphabet）；</li> <li>对模式（Pattern）的查询需要 O(dm) 时间，m 为 Pattern 的长度；</li></ul> <p><img src="/assets/img/alg-domain-char-st-1.54d63fdb.png" alt=""></p> <p>在《<a href="https://pdai.tech/md/algorithm/alg-basic-tree-trie.html" target="_blank" rel="noopener noreferrer">字典树(前缀树)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>》一文中，介绍了一种特殊的树状信息检索数据结构：字典树（Trie）。Trie 将关键词中的字符按顺序添加到树中的节点上，这样从根节点开始遍历，就可以确定指定的关键词是否存在于 Trie 中。</p> <p>下面是根据集合 {bear, bell, bid, bull, buy, sell, stock, stop} 所构建的 Trie 树。</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>我们观察上面这颗 Trie，对于关键词 &quot;bear&quot;，字符 &quot;a&quot; 和 &quot;r&quot; 所在的节点没有其他子节点，所以可以考虑将这两个节点合并，如下图所示。</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>这样，我们就得到了一棵压缩过的 Trie，称为<strong>压缩字典树</strong>（Compressed Trie）。</p> <p>而<strong>后缀树（Suffix Tree）则首先是一棵 Compressed Trie</strong>，其次，后缀树中存储的关键词为所有的后缀。这样，实际上我们也就得到了构建后缀树的抽象过程：</p> <ul><li>根据文本 Text 生成所有后缀的集合；</li> <li>将每个后缀作为一个单独的关键词，构建一棵 Compressed Trie。</li></ul> <p>比如，对于文本 &quot;banana\0&quot;，其中 &quot;\0&quot; 作为文本结束符号。下面是该文本所对应的所有后缀。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>banana\0
anana\0
nana\0
ana\0
na\0
a\0
\0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>将每个后缀作为一个关键词，构建一棵 Trie。</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>然后，将独立的节点合并，形成 Compressed Trie。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAl8AAAFFCAMAAADlxHhPAAAASFBMVEX///8AAAA/SM1wSMzz8/OFx/////Pb29v/4+aSkpLR//+np6dnqfY1NTVaWlrhqdWmasx1dXU/iu6/v7//x92m4//Eisw/aubVPx/YAAATtUlEQVR4nO2d4WKjKhBGobW11phsbrrd93/TK2qMJqgMMDAx3/mxabuKOhxxQCNKAQASUJSX+lxdykIBEJWyrs+NvnI81xdIBmJRVMaqprWq7NowY1pTwzAQA2NXU8+uikVZwTAQgyWTirptxapSARBAvdxOFZej1mcFgDfV+lWwNaxSAHjS6rV+BSwgGPClledYbC8DwYAPLnpBMOBJ2ejKZQDCCIaBCkClcW2XWsFqBQCJ0n3oodBHBQCJs3YfO630RQFAoKS0SSUaMECD1iRRGjsAqClViftEgAI1ozpqDFEAZ4qmoflywSArcOdCHtFqtALAkZqcr59xgQTOVGS/avQggTNn8tXugiFW4Ax9vLTEPUjgSkHvDRYYAQOu+DRGTaMAcMInWUcHErjiczuxwgAYcKT26Aye4Rcrbx3fipPPP28fk19/zBb/MmzHK//CIzqstHXP7pc6vf033eDB/PMv/jY9OoPoP3JzSuDX1/u4BePzd9eG/Rd/O/TOIMa/uEnh1+QCeerFao2bXTPjoMmdQdwf4iaFX7cLpGm+zI+frV9xr5DDO76Ia1Vx/UqUaD4TSfwaL5Cm3br6FTH04yvkqH4d43YfEyWaz0QSv8YLpNna6FecC+TNLU3+wka7go5pWKpE84no/fqatSd9p3L4/bf7+aP7PHguMZ7Yv1O/DuF7r+ctF3WEtfJr9RZJlWg+EZ1fVT8MNpxpv6bmb7J0Sxzeg5YYTuxOOvOXzq/AE1s/XhWJX9gwXwfRURVLkGg+GadhgPXWovx2Z9ytRfsZmqfblZS+xHBiz/0Kibu2p1xHUgNW6XMxKUqFw51oPh+jEz/DD50U3/1H17J3/3GY2OKxxHBijxIH+aWX03nSFzaK8en7aIpxJprPyejXVYZBkjt7Pm4L+CwxnNgR/NLrfUXKEFg9HVyNpBhXovm0jH6NkTi9XXOnBXs8ljAn9t/g/GvDLQPlpTjNnYsxFONINJ+am19/bpEwYzfLrZPHEmY7Jty/07DTTmsHuZRJ2RvXDKyydAaCFYueaD47c7/6Kv+9jlgs2kNdwvyfibJnWuLmVketHZ/SaccmyvVtKR9iJpp7YH59vCZPH2vZlccS1wukT7dK02r84ibY2juAQxSLlmjuhLlf3+Pnij0eS6jhAkkdFtIeVV1qh07k1iumvRWLkmjuiFn/8XD7w4o9HkuoyQXy37fjsLb2q2Sz/NarVVu9Ngv1VCw40dwXp+tdnKHm+z/0N3v6wNjtoS2hpie202057duCDHOlrQlWdHo5FOyzD0GJ5v7oVPjXtzXdBasfjH/7eB8G9oe7P7dPnyX6LXUn9PBYwZpe3m4Nq5p39y43YUXVmNTesXjyrvgnmrvkdL2vM0bh1EvyM5yBv8O9yeHzenKSlujoT+zNx6KCum/jipclw/qJr8rpsk6Fuu+SV6IJUhDQcI2rX3+xGlae20vndZJRwnYo+0VPNEEKAuV69MUY1s8uan4zM4yaxOyysobb7m0sSEw0QQKC3VJWWepjPztycz4On+XmOk57ubqYe6IJUhBDrkVTzMzI5r9MO0ZZb3NnlxdxTDRBAqK4peiahKwZZ48BO05yzR+0XilI+eI9yAbF5OLacN09aL1clvLHf6QNionE/ap4/6D1YmkqBE9RoJhASBnXl+VGua08FYpvKVBMFCS5lO1Ba2uJKpzAUV0olh2qWx0PD1pbylRxCB3ZhWIZ8ZKr5+5B64dSVSyCFIFi2QhwSz0+aH1fropIhHEOKJaWMLksD1rPS1aRiTHSAccSoYPD/bncf2SqxeBioVgadIxA2x60vpVOLs7hTSwxvIVi3OhIIbY9aD2W71ve6ptYVJyWEYqxoSPGdv6g9XwL/uWtvYllLF+FAsUY0JGjanvQOqB0hzex3I5CBQPFYqLThDNkAw5vYgnfyEJQFAggkVyBFe/wJpbZ8agYQLFAdLoIBm7E5U0skTb1WBYU8yGhXOFV7vImlrsjU5GAYnR04qAFb8jlTSz3x6eiAcUo6PThCt6U05tY7o9RxQSKuZDBrW6zoQU4vYnl8UhVVKDYOlnkijheu/UmFo4N2wqFYo/kargibdDtTSxMG7eUCsWmZJIrXg07vomFa/PWcqFYRza3FF/9CtgDKDaLQo44iAg/4068uGJZ3VJC9OJ4GPuh8BdULLdcUuzi35XXU0xnl0uUXsxNmHqt4X0BbvFXqN8OKUZeQzERcglrvCa7lOABpP0qJsQtJVKvRHu1X8XkHJnY8KbZsX0qJueQJIc20b49p2LaC5UY2WFNtnfOFVAMb8fOHzOpfpV1H6CRi/tEtJmiqFKwWQcmcM240PFc5w2cT1j4Q1lUV6vK8VRsasGGpRNsXbE+cP1b/k3gmtyBk+hX0c/ZMo1K0c/jItcwndKwJcUEBk6eX0sBKer2ZKxcZztOz626u5ajupSslfqomMjAifOrXj7dCjPDy1lJpavspNnPTDGZgZPmV7XemLeB2p6MNht9ZSfNfkbFhAZOmF9b8xSbqRxlC5Y++7kaJjJwovxqY3AstpcRKVhZ2TP8JNmPS98iT+Ak+eWil1TBsmY/JnDaZan0gRPkV9lszsPeYeIkbaAia/YjOXCC/Gpc66CNU61EkTdtlBw4OX6V7teQQh+VIDKnjaIDJ8evs3ZPgit9UWLInTaKDpwYv0rKqVUKasByZz+yAyfGL9qZRTlnmcmd/cgOnBS/iJlBKeY+Ue7sR3jgpPhFTQyOWsgQRe7sR3jghPhVNA3tsC9CBllzZz/SAyfErws5NWlkPC+dO/uRHjghftXkwJ9FXCCzZz8+gVMJEeJXRQ5TLaIHmT378QmcSogQv+gn1UXCEGv+7McncCohQvyiJ76lhHuQ+bMfn8CphMjwq6Cf1oWEEbDsaaNX4FRCZPjl0xg1jcpO9rTRK3AqITL88om6hA5k9rTRK3AqITL88hkXqgR0ILOnjV6BUwmR0n7Rz2oB7Vf+tNErcCohT5x/5X9EJ3/aiPzLCY+zWkL/MX/a6BU4lRAh41/0s1rC+JeAtNEncCohYsbvqWe1hPtDAtJGn8CphDzt/W0J3UcBaaNP4FRC3F358FjHmZpcU8ekYbIjIG2UHjgh7Rf5yTsZ3/DInzZKD5yU56OpqbLtwZg/sylnu6kc/ypWBKSNMQLHiBS/iE/eWZ/rO02mbPz883Yw//z7VowISBtjBI4RMd9PO5ICX+nzY8vx9T7OONuaZX7+WZklNAbh2U94mxshcIyI8Yv05F1hfYzq81ZZp14sM6/2h+IjPPsJb3MjBI4ROe8H0IRcpra/8GqsLNN8mR8/3994r5DB2U+ENpcWuMSj0gx+9bNZf3Sfh+sfTfDW237Kt5sb+7vcxsoy7dbVL9YcPzj7idDm0gKX+KEAjvbLzJH+dnjv507v//RrTJsJ90ChnduCNomwCjZW1ult4hfnBTI8+wlvc4utl0PNtq/SwuHXz9CAdZ51kfrtavlrtTXpplNw2n5lTLQKdq2s36lfB8VIcPYToc2tSYFLC5tfh4lP3Q/f/cfHUpnaVbDhZW42wYbK6i7GRquurgJ7kJ/rXbzQ7CdGm3shBS4pbH5d2ysTqUG0Fb96WUqXd9GMUbL4NVTW3K/QBH+9ixec/cRoc2mBS0kSv8y5OeRfVr/GSQIc3qU1iZJFsNO8iqL4td7FC85+orS5pXYIXI7p1NL4pfoz395+TWc52XoXYDE7CR8F6ysrrl8bXbzQ7CdWm7sZuCwPBKTyq227vu3Xx/kkOq1gy2diUTXzOnoQrK2lv5Hzr80uXmj2E6nN1VuB27Ff/Qlv8+txFrDLkmH9XBjlw+qzP5y6Ovqd1lVw/3Gri+eY/Sz13WK1uaTApSKJX5+L/UfrKIM1UGU75HV8nC3qfv2vd1M1cce/Nrt4TmnjYgMSr82lBC4RSfwaBsIe/NJ6IeomUP00UV2E+hlGjxf7zsxK6CuLMpbkcLths4vXjg3rrbRRLxoWsc0lBC4NmmF+ZLtffQ1OI7dWVH1shsnIjsNnuXIEk1+7yiKNhW/fbtju4mm9nTYuHm7UNtc9cEng8Os0eHT9HAb03z76OpxteaWY6xR35nTcOoTbb2NlmQ+ne3nbtxvsXby7XdjOfpYOmN7mruMauCelv+C8/Td8Xs/NQ1+Tw2nv4qkrs5Ju2YzrswgOtxusXbz7HXDIfvTScx/UNhesE9EudSdYn81cB9odEmWH2w3WLt7j5rezn6XnPqhtLlhDx9VrLlhfWYRnQR1uN6x28aYb385+tP22FrHNBSvEtqsv0ntdl9sNK128+4PZyn609bYWsc0FyzDoFfRMrcvthuUuHv1gLK03uc0FyzDYpXzq+YrL7YbFLp7XZlnOMDDAFFrvOnO63bDQxfPcqIZhHPCG1bdsp9sN9i6e/+FAsPhwx9SzeKfbDdYuXsjxQLDIJLgmeGzge/N2wzDUaeniBR4P/IpJkvPVZxtOtxtsXbzgA0ITFo1UCW3KGouwLRgWh3RxTLqh8C1BsAgk7Y2n2lSs7cCwQFKP9TzbhRiCBZE+fFI7EmtlwTA/ssSOf5MMj39AMA8yBY57q9HLRxPmQ76o8W6X5/kPCEYkZ8gk3ufcLhWCuZO5yefbOFvJMIxA9mBxbZ/xuCCYC8XwvYbckeK7jCk2YNgqZd09eT5wPNfZvpau2B7D5u+ZQjA7RdV/Y8Z8P2v4joNu6nyG8XyNhLv2YZidov+a8lSnov/qcirDtBfULShuIJiFJZOKum3FqjTfUo/tV+zyEu/+nqiX26nCfKk5yVuxY78KCH5JoVq/CraGEV7i7U18v+KWl3j398Pmi4mLJILBr12y9UreYRl+weDXHnHRK41g8GuHOLx6tMMIxjxQAb92SOPaLhVH7qnh4Nf+IMxPxz4zL/zaH5T5NblnFodfu4M0P3DJ3IDBr91Ba5LOvLMPwq+9QUypSt77RPBrb1AzqiPr7M/wa2cUTUPz5cI6yAq/dsaFPKLV8L5eLu468CszNTlfP3NeIOHXzqjIftWcPUj4tTPO5KO7cA6xwq+dQR8vLTnvQcKvfVHQe4MF5wgY/NoXPo1R0yg24Ne+8EnWOTuQ8Gtf+NxOrBg7kPBrX9QenUG0X1I2Jx+v/IvxER34tS88OoPoP4rZ3BNA7wxi/EvM5p4AejKF+0NiNvcE0G2p4JeUzT0BNflqd8TzOVI29wSQv7DB+w0P+LU3qCOsvN9Qg197g/iFDeZv2LoH+8NpHfgVlc8/bx+TX2/ztK5wJDVglT7v8/sdbr4G7ArD5tJzuk0GPM4z/e97dRXSFzaKhjcauD7K5uv9Ope5Mcv8/DOZf3rpAN1bpJr5BSfwSzaTC+SpF6s1bnbNfITyUpxG876gCX4JZ7xAmubL/PjZ+rV+hSy2Xo15o+J+yy/8Es7YgLXN1+jXRgNWa8cxh0pr5teUw6+8/JoeYauL+Txc/2iaqrGjeG3Afqd+HdZLvbgJVrk3dL7Ar8yYZunt8N4JNVwJf40+RqfutyHD75wzWnV+bWT43RsyNze9qpfHwIgN+JWZn6EB6zzr0qrf7vJn0viuQocL5NyvjSEKM8q6+WrVanUmAI+BERvwKzOdX4fep06o7ofvSTfxNL8sOvnVTSOx+grpfuKr5VD4DIxYd0RFXQd+Efnpm69eKyPUINrNr76mKX6NE5UsNmFF1WzMZeIzMGLdFaVirgO/iDz4ZapzyL/62mxr+i8l/xrFMZMMWQ3rJ74q1apgHgMj1p1RZOBXRB79Un3Cc2stTp1Xv1O/DitHN7HGalh5bi+d/SSja4KNF0izZ+MVmprjw6/M2PxqVfqeXI2+3k2z4TT+9XDRM4b1s4ua34ZZko+X2fL2onwG3uIEG35F5NGv3qyJX/0F0qUZsaVU9bFPtZrzcfgs79ewF+Yz8BYl2PArIg9+fd73H4cL5GYatJywX2dGNu2YdS3rnnkNvD0Wr8jAr4g8+DUMhE39Gi+Q5mOhG+c9teXian4Dbw+lKzLwKyJ2v+Y3jG49yKVhqJCJUxfX9Bl4W9ixaBPAwi8a/f3Ht/+Gz2sif5h71Ddgi7dpQuxSy4LRB97U0q5F9CtueYl3/xkJP6iF9akDbwkPFn6lIsohLRRBGngDOyTWCWMvhTDwBnZIxObYWpD7wBvYH3Ev9tay3AbewC6JnErainMZeAM7hKOjYilxe+AN7BCmbrCl0L4HeX1+FXq9AnyDLI/lbgzsgt3BOoS3u9FBQIN7gBiCvTIJbj9AsJclzc0tCPaaJLt1CsFekJQ35iHYq5H4sQ8I9lIktktBsFcivV0Kgr0MWexSEOw1yGWXgmAvQEa7FATbO3ntUhBs12S3S0Gw/SLBLgXBdooQuxQE2yVi7FIQbF9oeV8WhmA7QqBfEGxHJH1Zi0SZASvwC3CS2K806wAxwC/ACfwCnMAvwAn8ApzAL8AJ/AKcwC/ACfwCnMAvwAn8ApzAL8AJ/AKcwC/ACfwCnMAvwAn8ApzAL8AJ/AKcwC/ACfwCnMAvwAn8ApzAL8AJ/AKcwC/ACfwCnMAvwAn8ApzAL8CJe/V9eKzjvbGwdYAY0H4BToT6FaGxBBJA+wU4gV+AE/gFOIFfgBP4BTiBX4AT+AU4gV+AE/gFOIFfgBP4BTiBX4AT+AU4gV+AE/gFOEk65Sf8ejngF9gNSWUGLwf8AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUP8Ds//ELRrYb9IAAAAASUVORK5CYII=" alt=""></p> <p>则上面这棵树就是文本 &quot;banana\0&quot; 所对应的后缀树。</p> <p>现在我们先熟悉两个概念：<strong>显式后缀树（Explicit Suffix Tree）<strong>和</strong>隐式后缀树（Implicit Suffix Tree）</strong>。</p> <p>下面用字符串 &quot;xabxa&quot; 举例说明两者的区别，其包括后缀列表如下。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>xabxa
abxa
bxa
xa
a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>我们发现，后缀 &quot;xa&quot; 和 &quot;a&quot; 已经分别包含在后缀 &quot;xabxa&quot; 和 &quot;abxa&quot; 的前缀中，这样构造出来的后缀树称为隐式后缀树（Implicit Suffix Tree）。</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>而如果不希望这样的情形发生，可以在每个后缀的结尾加上一个特殊字符，比如 &quot;$&quot; 或 &quot;#&quot; 等，这样我们就可以使得后缀保持唯一性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>xabxa$
abxa$
bxa$
xa$
a$
$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="data:image/jpeg;base64,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" alt=""></p> <p>在 1995 年，Esko Ukkonen 发表了论文《<a href="https://www.cs.helsinki.fi/u/ukkonen/SuffixT1withFigs.pdf" target="_blank" rel="noopener noreferrer">On-line construction of suffix trees 在新窗口打开<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>》，描述了在线性时间内构建后缀树的方法。下面尝试描述 Ukkonen 算法的基本实现原理，从简单的字符串开始描述，然后扩展到更复杂的情形。</p> <p>Suffix Tree 与 Trie 的不同在于，边（Edge）不再只代表单个字符，而是通过一对整数 [from, to] 来表示。其中 from 和 to 所指向的是 Text 中的位置，这样每个边可以表示任意的长度，而且仅需两个指针，耗费 O(1) 的空间。</p> <p>首先，我们从一个最简单的字符串 Text = &quot;abc&quot; 开始实践构建后缀树，&quot;abc&quot; 中没有重复字符，使得构建过程更简单些。构建过程的步骤是：从左到右，对逐个字符进行操作。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>abc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第 1 个字符是 &quot;a&quot;，创建一条边从根节点（root）到叶节点，以 [0, #] 作为标签代表其在 Text 中的位置从 0 开始。使用 &quot;#&quot; 表示末尾，可以认为 &quot;#&quot; 在 &quot;a&quot; 的右侧，位置从 0 开始，则当前位置 &quot;#&quot; 在 1 位。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAAAdCAAAAACWZv2/AAABy0lEQVR4nO2VsUsCURzHv0US0WJJQ0UOhYYEDUJDNIb0B5jpJDTZKhGIQ4NDHIQIDdUtBW6Vt4Ukh9QiEZJIGGJyDpI5yNEtGXFQnd4dCpqeeTaE3+Hu9969d5/3+73f772BL/yBBvqUPqXHGuxgKEGBJEhCam4wzAZoYpBRlwKbNR71uEqk2CroczOweNT2RdC+HXAcSA1Nzqh03lBHlEc9YEjzGoAMPlmSxldlrnRISY8Ao8jPAa7Ze4/lQtsTX0zvwBsEhzDBwovxiEXZvM72ZSEPPJuEgKHkvvtY/lQIqVF4hk7x7UbvnAGXPvAUhwdDZhpKJVOoKcPa4vB2G87SKknCiqRtBWVt0ayYItU+4V2367mroPFG8/OCsnOymXLTTXobxWvqfWG87t35kcnN49uTFis6pOTJsbBk0WTTkSRdCQoxMbwQr/OF8F+Ln32FGLoXNw6d05G3CaYuW8l2MZMTchWbQ0rTppXKABsIVE02akWTehlTgdLwD5FilgKGxPK5ChQuVIvYaqVD3H0be1p9Z0JOFSDQHkVe/EvWPR1M4eohVJfJ88XWmdyF5LuS2mKFp5voCaR2I/NJTmtQesb+mtJT/SfKNy0YjgkV3G4TAAAAAElFTkSuQmCC" alt=""></p> <p>其代表的后缀意义如下。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAAAdBAMAAAAkzk0vAAAAKlBMVEX///+MjIyqqqpvb2/z8/MvLy/T09MWFhbGxsYCAgLh4eG6urpDQ0NVVVVkcZgUAAAApElEQVR4nO2RPQqDQBBGNyGEIARCuj1BIFWSJq1HSJvWYizshT2AhVj5A7KFB7C1EEsrKyvB0ru4YKPgwFiJ4KsG5jHMfMPYzta5v6nm6WeSp144Wf2kWEfL9ekCkYuYRyHDqVs/XvMqb7xvyShoIYDho+1MZ058G+qDDQAtqv6Tp5DBUF8rpfIaQ0hFMlY7jLG6YIEFZ6mwLGJYMy/AORdUc1V6aphW7hSp2y4AAAAASUVORK5CYII=" alt=""></p> <p>第 1 个字符 &quot;a&quot; 处理完毕，开始处理第 2 个字符 &quot;b&quot;。涉及的操作包括：</p> <ul><li>扩展已经存在的边 &quot;a&quot; 至 &quot;ab&quot;；</li> <li>插入一条新边以表示 &quot;b&quot;；</li></ul> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABACAAAAAAmduaWAAAEGklEQVR4nO2YT2zbVBzHf6uQop6IyS3aUK26nQT04nnlMITWNsECJETUCY8T2wUKRUJMIjDlCNNCgJ3Wpge09oCqZgOyIW0odHEnpB6IrFyiSttw5GrVLO2Q2b0s8qWbn/90SeQ6772kO/V7iN97/sWf/N57fu+bd+gpvAAdOqAcUPZZAwShmSLkc0s5ryrpqgRybkDtLwXOppQ76TPbS26tHn/AwWQ69BsWBQXgp9MAqct+7cFIeHQuNigoFBTlCABXRb8wL2ji95dzYcHF7wyoiiYqvkRE0QYBBqERB/j8aPmCWIgGh+lfQ4x5+SoqGmspYgrbBGhCzC7FDLgIr9yeDAy7e62jgazHhC2Ah3zELjVmKs3kTiDEksvowpx3PifIKd+sACxnwCqaUOfU4YAINS/GEyUegP/vQpYBvhSlyOVkPg8pqE0noBG9P9Rx1yxKsdGfh399rHwJ59c5SDd2FMG5Q/DuD9zn/OLGuVJnq1IsVSE59f7rLrB9XpCM/qKQ8nr+37+8Jvme88zrf982WDEzsfvsjsnX+zoml1ESHya5kJjeKPqNOyiJUyci4XH0FGu9vKJ1S6I3in7jumKwp6e6JUFPsdZ/L2lM4iROEpQUJwlexE2CgmLdWkVJvPtOHAiFTdm4WV4FXkwJQCGst9Jcc5L4403iJLBzUWSUxEeTVElgUcy1FfTWJSei0JN2KYq8yQjvtc4cb/3rKYl2iimtspyqsQXvkd7613MS7RRR+eU4wKO0VovjrX80FDlx5Ti6NkVpDG/9I5M7k8usA4FBqbDAf9uPkQiiqH7nDBmP+zMS7XL3/VjDq24ze0OQTzbzu5aC3CePVx+51RLkrD1jz6Yg+rbm13B8cjvlYzbdRNe5qvRjPG+FxLdOim4+uZMSKWji3M3lTxay83Vp9rVi9+9h+OQW+e++/kPJhMRnyCyqmWt8JhXwg5AnUkd33Jrs+eQW/9Sd0ib10kIAp41i+2Rbtk/GogR6S26+EpsWQ/stxCfjUmyrWqrA9HDAPHBaQnwyEQVxauJs/Au9vVWfgyVzL5+8t0L3F/VSwZg55/d7uE+mywWJm69nC6Piktdxi/5ItfjkPOCo645s3VpYZaRTuONMSbGl/3a1iu8jaSm2NpZX6JwYEcWW+ifyMuNUmzSRg3V8GSKRGjNiN67/U7FJrHBM4PGTovpnYVbLimIQoOj/Jak1xUVxI29w0f2iONLvKpsVzQCGHR8aGTvizXXrg6lPbe7GXOPYV5E+UHzWvVpdtfdqlhnmDh991RwHZmb2yah9i1f6RnFlqlv/bzbqKDNn8+Gr6NM5qtmHE0Vra/Hi89qVM0B6QoKlCHcYmGS24pz2wFt97rGWbFR0TmKdsLssm943ii95e8zdfA5OrUn1DIjyrdVrkB+7AAAAAElFTkSuQmCC" alt=""></p> <p>其代表的后缀意义如下。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAA/CAAAAABBD1AKAAADIUlEQVR4nO2XTWgTQRTHX6VgpPUjQiMFQSsUGuhCIIgezBYrtYfW1tIWEkRJwSIWSiAeelAQz1IhCr00NBIPjaTBbtWDlrY0C4UgOSWwXmRBSoQEWYUIEQI6+5E0ySabmen2lgeZ2d15+eXlv7PvvW37B0djbS1wC6yzY2TuAcZ4XeI4iSritKNotJy8AmB776SIuMN42Ys+Wa9y2I7NfObYveBDYgThtVO/GtqTR0EZChYSKSQ2lb6ZEXsTTv9mSr88GC8f2jJEUlhT/FYWzU6YFyTdKq+MM4vyuEAohX9g7JFy0A0naqjvIlk7mhd9cDEC7nHlIr4UXbn09fyP3iLw4eWK61xkN8uOj/UMfn3rqvTH326D4Hs48mqmm/m+YKmK9f5Yj/zDYAU6sF5XmTo12V9/lRZsTKUFp2Nrgu2BAZUKLIYR1X3H2cSNEKxSJ1zNPUnA4kYQkwoED4gU5uIwvYRHxQar1NiwBbANA0xBxQBL628oqNDk5hVWEZW9e9sK5NYYfBgqHORj0c+0Mx6+TOU8nbOwnNueoeSWIk7egpHzvzcFlFIR9ZOWCuEQpoILl/qeH0fzyssdF2cCtQwOze6of9kDPxsnrUAwhQ9WNd6za1IOCe5E6mmDtHVDwOdq+zjfpZ2ehheNfTsIuFrE3TntdB/8aQPvAMMkicATwhdl/vuRjTiYkNTI+1pqyEsEdrGPt9D0zQuxTOLqbJeHq+9dv6moa9o+luaitr6coDZ0cn6wued1G05Etb/QmbeQgFF13N4/yXhKX+LDIZh216QeUddU4IBrTQ27qrRJc1VNBSUYSqVonu4ZbFLz0ityq3OPIhM1L6b8UhRYH3Gmx6nSUjiI00mQgzVJyNj4fYW4wcVtA+5hE3aFzpIf1rA7FtLeTdFkZLR53BTdphw3eixZq9lgUPUG4/pF3dFL65+jYJ8adZoNLomCNooiCn/ZYh64QpQ/Dvtqv5ngEtsuyO95KK2jVtdqEhiZFH8iV3D2XBSN06vmgVFhqTgpmgiGwK8zp87CpPlg1TwHUuC/pOPYEsg3D8yPuMJa4LL9B56/S1kxldgSAAAAAElFTkSuQmCC" alt=""></p> <p>这里，我们观察到了两点：</p> <ul><li>&quot;ab&quot; 边的表示 [0, #] 与之前是相同的，当 &quot;#&quot; 位置由 1 挪至 2 时，[0, #] 所代表的意义自动地发生了改变。</li> <li>每条边的空间复杂度为 O(1)，即只消耗两个指针，而与边所代表的字符数量无关；</li></ul> <p>接着再处理第 3 个字符 &quot;c&quot;，重复同样的操作，&quot;#&quot; 位置向后挪至第 3 位：</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>其代表的后缀意义如下。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABoCAAAAAAroKqJAAAE0klEQVR4nO1aTWgbVxCelOoogW1MweCAWgJBDhtU7BycKrVBtLQs1kHgHuzYlxKCVKnCN2MsYwWhixGu3fXBGIpqlVKBCoJtocVgGlNBo1KRpXKLwTEosDfFjXxoYQnN210nsrR/7+3uOwQyh5X0dne+ne/Nm5k32kv/A1259BpAX9r34ZaPIkD14zPw/jhODyAooANTpwbQYJSP/zzo8KbLuqXvfvvr9zPlq1fW7zrAdlI+Tu6jQxZoUNS+jB4/WuK/hjnWFgC3dmJ2uvE5enbmF19n5A0y/TDRNHv8BAMC4/3hgn5X56D4GRRmod49SACQefenq3FE0g5w41Ju4O/BdC87saxPcxc+Re2v2Ltr6DNYf28GcgPxxftSNzstYVOrn2iSq/XkswbzDMThxzf5kW52lk+/nNW9iWCSE48m1C+DMHgq+9JLCxrhebapr5+Eoq2pp6rOWszzwXKjzf2rnpAyTOtAjx1SisKQSrDZT9+62kr5xNTP/qLKEp84zd7xGN7ldCWLc/vR9SGTC0gXWrdImUDroGSm35kFFuw4tUAMR8YO4xb67QNIXOC4Ys6OI4DqjeTCEYtxoT0AcTo0IKSt2LEPwAVqlb0RvGttAFSDyYWHOOzYA2gnZHZ82NeTJhw1qRAImQUobN5uEuknAjBMKi4BFK/vFuqYvmMDwCypuABgnlTMBM+LUNjcuIO1cG1ZgBc2bQNgJBUzsUw4OEnFgQXd7HB+lwF6k4pp5WsDADupmImxm4qp8qTQu3CNKl8bFugnFf3K10wMvKgaF1ZSmoVrUPmSW2CWVDSVLy6A1OAb5zcVL+8WdFNuH2gqX2yKisuyC8byHqOdimKZpvLFBuCS0am3n/yRH/1+aYspEgd9SwBxOHZX/jyJeMFRYIDqoymfbGoZojsKDeo62PEq+sEfrf1qO6wpkt6H6NyHSD+UodSxYPrJF+r58uqkI/2g9Cm8arNCvxnS7wyg76xnQAW4lj//+SdTcgYQbsoUzSCKIOrpUPRikuvzhGWVRjST3HHTOf/Tb3dHb62en3BLNAutOgPfjFMAAOnopP+a/Oxo37iCG4tJAC4I4ss9mnTDtZs06Ybr8YdjoYxLAEZlS8YtbzKsiwxoIsrHhhQpNB2xoem2ZpgoH5tagISf7dMY4ecJk4VZXcQ23wllep6WKB9bAYBvb2X1I7FriCgfWwKg/CEcB7iLA+tXbr4/QeJeltW1lFt1lKQt9weetABMhoR1QgvOjeDshg6cLZRsRMiuEZgtNSmX79u0VcljbmM96cOxSLhBDwBgqHTQYhJtegAoOj3Y2L1epAgAnvjh2DwpT2TtnKFS5ZjJEPFE3JiV/eneJ/j1MXFLDfkTO3+DpweAeNoUrkSCVXoAACOlg4HQtEgPALnsXqE2jLUq7Hffpe0lWFi0nG0n7X0xt8XcswpQTv6gUGY7XKUHIM+20B8yh3AGoDgUhMzCh1MA2aEqLcbYZ50DoPrpQaEWMIpQLv1hLW2vnS6kfPQAVIjbi0NUKFLEEz/K8ogoMcjTsUCW9noeRvehwtICQBBLW+hYYTsvDbj82oM6zZEYgilvxClYAPzyyYtuhfcfGgAyTY9RR0IWpdtC/eUZ19y0SzgvYkjdV7yiLzBdkFcf4DluAucFFXsHjQAAAABJRU5ErkJggg==" alt=""></p> <p>此时，我们观察到：</p> <ul><li>经过上面的步骤后，我们得到了一棵正确的后缀树；</li> <li>操作步骤的数量与 Text 中的字符的数量一样多；</li> <li>每个步骤的工作量是 O(1)，因为已存在的边都是依据 &quot;#&quot; 的挪动而自动更改的，仅需为最后一个字符添加一条新边，所以时间复杂度为 O(1)。则，对于一个长度为 n 的 Text，共需要 O(n) 的时间构建后缀树。</li></ul> <p>当然，我们进展的这么顺利，完全是因为所操作的字符串 Text = &quot;abc&quot; 太简单，没有任何重复的字符。那么现在我们来处理一个更复杂一些的字符串 Text = &quot;abcabxabcd&quot;。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>abcabxabcd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>同上面的例子类似的是，这个新的 Text 同样以 &quot;abc&quot; 开头，但其后接着 &quot;ab&quot;,&quot;x&quot;,&quot;abc&quot;,&quot;d&quot; 等，并且出现了重复的字符。</p> <p>前 3 个字符 &quot;abc&quot; 的操作步骤与上面介绍的相同，所以我们会得到下面这颗树：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABoCAAAAAAroKqJAAAE0klEQVR4nO1aTWgbVxCelOoogW1MweCAWgJBDhtU7BycKrVBtLQs1kHgHuzYlxKCVKnCN2MsYwWhixGu3fXBGIpqlVKBCoJtocVgGlNBo1KRpXKLwTEosDfFjXxoYQnN210nsrR/7+3uOwQyh5X0dne+ne/Nm5k32kv/A1259BpAX9r34ZaPIkD14zPw/jhODyAooANTpwbQYJSP/zzo8KbLuqXvfvvr9zPlq1fW7zrAdlI+Tu6jQxZoUNS+jB4/WuK/hjnWFgC3dmJ2uvE5enbmF19n5A0y/TDRNHv8BAMC4/3hgn5X56D4GRRmod49SACQefenq3FE0g5w41Ju4O/BdC87saxPcxc+Re2v2Ltr6DNYf28GcgPxxftSNzstYVOrn2iSq/XkswbzDMThxzf5kW52lk+/nNW9iWCSE48m1C+DMHgq+9JLCxrhebapr5+Eoq2pp6rOWszzwXKjzf2rnpAyTOtAjx1SisKQSrDZT9+62kr5xNTP/qLKEp84zd7xGN7ldCWLc/vR9SGTC0gXWrdImUDroGSm35kFFuw4tUAMR8YO4xb67QNIXOC4Ys6OI4DqjeTCEYtxoT0AcTo0IKSt2LEPwAVqlb0RvGttAFSDyYWHOOzYA2gnZHZ82NeTJhw1qRAImQUobN5uEuknAjBMKi4BFK/vFuqYvmMDwCypuABgnlTMBM+LUNjcuIO1cG1ZgBc2bQNgJBUzsUw4OEnFgQXd7HB+lwF6k4pp5WsDADupmImxm4qp8qTQu3CNKl8bFugnFf3K10wMvKgaF1ZSmoVrUPmSW2CWVDSVLy6A1OAb5zcVL+8WdFNuH2gqX2yKisuyC8byHqOdimKZpvLFBuCS0am3n/yRH/1+aYspEgd9SwBxOHZX/jyJeMFRYIDqoymfbGoZojsKDeo62PEq+sEfrf1qO6wpkt6H6NyHSD+UodSxYPrJF+r58uqkI/2g9Cm8arNCvxnS7wyg76xnQAW4lj//+SdTcgYQbsoUzSCKIOrpUPRikuvzhGWVRjST3HHTOf/Tb3dHb62en3BLNAutOgPfjFMAAOnopP+a/Oxo37iCG4tJAC4I4ss9mnTDtZs06Ybr8YdjoYxLAEZlS8YtbzKsiwxoIsrHhhQpNB2xoem2ZpgoH5tagISf7dMY4ecJk4VZXcQ23wllep6WKB9bAYBvb2X1I7FriCgfWwKg/CEcB7iLA+tXbr4/QeJeltW1lFt1lKQt9weetABMhoR1QgvOjeDshg6cLZRsRMiuEZgtNSmX79u0VcljbmM96cOxSLhBDwBgqHTQYhJtegAoOj3Y2L1epAgAnvjh2DwpT2TtnKFS5ZjJEPFE3JiV/eneJ/j1MXFLDfkTO3+DpweAeNoUrkSCVXoAACOlg4HQtEgPALnsXqE2jLUq7Hffpe0lWFi0nG0n7X0xt8XcswpQTv6gUGY7XKUHIM+20B8yh3AGoDgUhMzCh1MA2aEqLcbYZ50DoPrpQaEWMIpQLv1hLW2vnS6kfPQAVIjbi0NUKFLEEz/K8ogoMcjTsUCW9noeRvehwtICQBBLW+hYYTsvDbj82oM6zZEYgilvxClYAPzyyYtuhfcfGgAyTY9RR0IWpdtC/eUZ19y0SzgvYkjdV7yiLzBdkFcf4DluAucFFXsHjQAAAABJRU5ErkJggg==" alt=""></p> <p>当 &quot;#&quot; 继续向后挪动一位，即第 4 位时，隐含地意味着已有的边会自动的扩展为：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABwCAAAAAAiDOE7AAAFhUlEQVR4nO1aTWgbRxSetBUUSoStOgUFHQLZIDDCKi6mKCgJFehkYVFEBb0YXBlRX5qSRNVi6KEEFit2E3xqEd7aCArFxbQSysnELo6wKGlF18imwmtqTOgeWq/FhpLCEtpZ/Vh/q92Z2d2QQ77DrDya9ad5782b997Mmf/Ac8CZlyyYeAVYCfk5sKTOve4u1j5ZKLF8GDaOA7u1c8kojbgFCFhYN+JAqfxH6w9cifHuZ/qD8j9yh2L9Y11irwErsKw0kXcWRGrFjjkX+tL+YJJ3M9+AFZ/8+eD+0Fy9S2XCH5Ygybc2AolJYxUoLt7NeegfKvSlmDCx/bTW1T1QWJwPbIDR7RYJll6Ke/Fnyn8VXI9HNj2nXV0/hpmnvgwFqw/sbZ0YNjZ9fK3+YQi8IR4CZWWfdjUhpy6y6XII3Mu1k2CwCMtX/6q7jF8i9sAXgsw+bXU1ONjzC7cOYlBUHicgYxkajew5Zt6K0OzWEsgMuC4P2+tdpyPynnhsJ2lXedc8D1P8pBRhKPXvzPIw5aB/oLDah8QkFj7qrWbXfX2/N4NFot1c9lFIY4RxDyPfXQDpSZvmGMPaZ+/wietOnUEG56IY1n1Kd5ghvSiGxa3qkxhhEaYVw/KgDCVmkWhXNq1pWG0g1L6cocGtGTvqcDKW/E1+6raeYbWBRGJ8NGwvLGGQELDUV7oP6x3c9YKy0nuBqRe4ChOzyEonmws/sxGoICzCHmDoBSrkKLtOQoIhMRaukBu4CsFkgcKKLOIYbwfQJAaFVS2sEpOgaR8KKx0DBoAwl3IwHjswRKLPItHeKjeHv0Q6oKf9/E2R2LJQ5yJEw96dZJMEOQ/DYpFTLq7dsq7xpCwaNlaeKiVuGxaWNot8d3a00O3fU/p5mCr6aR86X6Zb6wh5GBaLdGNZxZ/o5mF9oar9/Fg228efaORheCxSNHxlp18I1DcPQ2QR8uXaS/mLm1n10EErD9NGUy+1FN2xHBImN0i2XB00LFkaB+nh48VwgnVkEeNFFMi2Dokx4sq7Zy/cC7CxRyaQFOmy8uipj7mvfKo8fo5zSNG1DmBljPoo8nurPtZgeZUZVx5P/IlfTWCplpTWUSsr1RTQ7WEGB4EFaLBQ+7XHHoiguiZNiW20JHZV6Who//3sE+XxnYMo3OrGmwmukqRCjANQufb6mDQGPhs+zqx1VLXMQ3NVwtWorEowdSFHHhDpskCew7NuG+DHxRxe1oDH0iSbOFw2cfXX0eOTnQ/eC6eAyVDbxdh4YM1ch6m6VxYnHPdNMekmVPdKXxH48sBE9IkupMiGevxNEMAAjQiWno8sqSiHIIDRYoHKASor5xx+AAO0Iljfztt+uqeXIIABOjF/ajaQ6fI3wWpuKPPBP66TXf+/6B5PM+ZPFn4bKXZ2EQQwQDd/ESZKjAk7jk4u5txmZoMCMAq9jM+WLByNsMAg9LNXXzkWDxLnR6gswDbHVd00akhMygLPObaZ+ctFq1mgdioD/mlyK0CtKVHrhYcuYrGhV658ZWbeQ7gfYNTHbMnH3nCQSD1Y1VHnKgf8wbLFLNDa1rNHXnwzwK9aK2XxGGa6RlIbl75awCm/A9IKPJyPiJN+kp4l4c2H/MRKYlhk/Rg5F4PzEadolPDQ2OkbKo+x80p78s/0Q3dU1x8YPRW1xSqFE/8YK1vKAuFb57xxT0rSGGLSmbiwCA2u/+GoaSfvkEecivksZoEG9/0dfvRj1XMmE28Q2aEheOPnp5WdISVbNZcahMyCGLgOwp05o/l3ruTM1yWKB9RPzlZ9zJKbXfU7Xbkt5QZRzR4suae0qzSiHzb8RHt9zOS57IKTv6XN/vUxUxCqFT+ia6cdFt6Fm1SajvqYJTPqqY9ZjJcsLybL/2OTM+34PefGAAAAAElFTkSuQmCC" alt=""></p> <p>即 [0, #], [1, #], [2, #] 都进行了自动的扩展。按照上面的逻辑，此时应该为剩余后缀 &quot;a&quot; 创建一条单独的边。但，在做这件事之前，我们先引入两个概念。</p> <ul><li><strong>活动点（active point）</strong>，是一个三元组，包括（active_node, active_edge, active_length）；</li> <li><strong>剩余后缀数（remainder）</strong>，是一个整数，代表着还需要插入多少个新的后缀；</li></ul> <p>如何使用这两个概念将在下面逐步地说明。不过，现在我们可以先确定两件事：</p> <ul><li>在 Text = &quot;abc&quot; 的例子中，活动点（active point）总是 (root, '\0x', 0)。也就是说，活动节点（active_node）总是根节点（root），活动边（active_edge）是空字符 '\0x' 所指定的边，活动长度（active_length）是 0。</li> <li>在每个步骤开始时，剩余后缀数（remainder）总是 1。意味着，每次我们要插入的新的后缀数目为 1，即最后一个字符。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 3, active_point = (root, '\0x', 1), remainder = 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>当处理第 4 字符 &quot;a&quot; 时，我们注意到，事实上已经存在一条边 &quot;abca&quot; 的前缀包含了后缀 &quot;a&quot;。在这种情况下：</p> <ul><li>我们不再向 root 插入一条全新的边，也就是 [3, #]。相反，既然后缀 &quot;a&quot; 已经被包含在树中的一条边上 &quot;abca&quot;，我们保留它们原来的样子。</li> <li>设置 active point 为 (root, 'a', 1)，也就是说，active_node 仍为 root，active_edge 为 'a'，active_length 为 1。这就意味着，活动点现在是从根节点开始，活动边是以 'a' 开头的某个边，而位置就是在这个边的第 1 位。这个活动边的首字符为 'a'，实际上，仅会有一个边是以一个特定字符开头的。</li> <li>remainder 的值需要 +1，也就是 2。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 4, active_point = (root, 'a', 1), remainder = 2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此时，我们还观察到：当我们要插入的后缀已经存在于树中时，这颗树实际上根本就没有改变，我们仅修改了 active point 和 remainder。那么，这颗树也就不再能准确地描述当前位置了，不过它却正确地包含了所有的后缀，即使是通过隐式的方式（Implicitly）。因此，处理修改变量，这一步没有其他工作，而修改变量的时间复杂度为 O(1)。</p> <p>继续处理下一个字符 &quot;b&quot;，&quot;#&quot; 继续向后挪动一位，即第 5 位时，树被自动的更新为：</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>由于剩余后缀数（remainder）的值为 2，所以在当前位置，我们需要插入两个最终后缀 &quot;ab&quot; 和 &quot;b&quot;。这是因为：</p> <ul><li>前一步的 &quot;a&quot; 实际上没有被真正的插入到树中，所以它被遗留了下来（remained），然而我们又向前迈了一步，所以它现在由 &quot;a&quot; 延长到 &quot;ab&quot;；</li> <li>还有就是我们需要插入新的最终后缀 &quot;b&quot;；</li></ul> <p>实际操作时，我们就是修改 active point，指向 &quot;a&quot; 后面的位置，并且要插入新的最终后缀 &quot;b&quot;。但是，同样的事情又发生了，&quot;b&quot; 事实上已经存在于树中一条边 &quot;bcab&quot; 的前缀上。那么，操作可以归纳为：</p> <ul><li>修改活动点为 (root, 'a', 2)，实际还是与之前相同的边，只是将指向的位置向后挪到 &quot;b&quot;，修改了 active_length，即 &quot;ab&quot;。</li> <li>增加剩余后缀数（remainder）为 3，因为我们又没有为 &quot;b&quot; 插入全新的边。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 5, active_point = (root, 'a', 2), remainder = 3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>再具体一点，我们本来准备插入两个最终后缀 &quot;ab&quot; 和 &quot;b&quot;，但因为 &quot;ab&quot; 已经存在于其他的边的前缀中，所以我们只修改了活动点。对于 &quot;b&quot;，我们甚至都没有考虑要插入，为什么呢？因为如果 &quot;ab&quot; 存在于树中，那么他的每个后缀都一定存在于树中。虽然仅仅是隐含性的，但却一定存在，因为我们一直以来就是按照这样的方式来构建这颗树的。</p> <p>继续处理下一个字符 &quot;x&quot;，&quot;#&quot; 继续向后挪动一位，即第 6 位时，树被自动的更新为：</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>由于剩余后缀数（Remainder）的值为 3，所以在当前位置，我们需要插入 3 个最终后缀 &quot;abx&quot;, &quot;bx&quot; 和 &quot;x&quot;。</p> <p>活动点告诉了我们之前 &quot;ab&quot; 结束的位置，所以仅需跳过这一位置，插入新的 &quot;x&quot; 后缀。&quot;x&quot; 在树中还不存在，因此我们分裂 &quot;abcabx&quot; 边，插入一个内部节点：</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>分裂和插入新的内部节点耗费 O(1) 时间。</p> <p>现在，我们已经处理了 &quot;abx&quot;，并且把 remainder 减为 2。然后继续插入下一个后缀 &quot;bx&quot;，但做这个操作之前需要先更新活动点，这里我们先做下部分总结。</p> <p>对于上面对边的分裂和插入新的边的操作，可以总结为 Rule 1，其应用于当 active_node 为 root 节点时。</p> <p>Rule 1</p> <p>当向根节点插入时遵循：</p> <ul><li>active_node 保持为 root；</li> <li>active_edge 被设置为即将被插入的新后缀的首字符；</li> <li>active_length 减 1；</li></ul> <p>因此，新的活动点为 (root, 'b', 1)，表明下一个插入一定会发生在边 &quot;bcabx&quot; 上，在 1 个字符之后，即 &quot;b&quot; 的后面。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 6, active_point = (root, 'b', 1), remainder = 2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们需要检查 &quot;x&quot; 是否在 &quot;b&quot; 后面出现，如果出现了，就是我们上面见到过的样子，可以什么都不做，只更新活动点。如果未出现，则需要分裂边并插入新的边。</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>同样，这次操作也花费了 O(1) 时间。然后将 remainder 更新为 1，依据 Rule 1 活动点更新为 (root, 'x', 0)。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 6, active_point = (root, 'x', 0), remainder = 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此时，我们将归纳出 Rule 2。</p> <p>Rule 2</p> <ul><li>如果我们分裂（Split）一条边并且插入（Insert）一个新的节点，并且如果该新节点不是当前步骤中创建的第一个节点，则将先前插入的节点与该新节点通过一个特殊的指针连接，称为后缀连接（Suffix Link）。后缀连接通过一条虚线来表示。</li></ul> <p><img src="data:image/png;base64,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" alt=""></p> <p>继续上面的操作，插入最终后缀 &quot;x&quot;。因为活动点中的 active_length 已经降到 0，所以插入操作将发生在 root 上。由于没有以 &quot;x&quot; 为前缀的边，所以插入一条新的边：</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>这样，这一步骤中的所有操作就完成了。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 6, active_point = (root, '\0x', 0), remainder = 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>继续处理下一个字符 &quot;a&quot;，&quot;#&quot; 继续向后挪动一位。发现后缀 &quot;a&quot; 已经存在于数中的边中，所以仅更新 active point 和 remainder。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 7, active_point = (root, 'a', 1), remainder = 2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>继续处理下一个字符 &quot;b&quot;，&quot;#&quot; 继续向后挪动一位。发现后缀 &quot;ab&quot; 和 &quot;b&quot; 都已经存在于树中，所以仅更新 active point 和 remainder。这里我们先称 &quot;ab&quot; 所在的边的节点为 node1。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 8, active_point = (root, 'a', 2), remainder = 3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>继续处理下一个字符 &quot;c&quot;，&quot;#&quot; 继续向后挪动一位。此时由于 remainder = 3，所以需要插入 &quot;abc&quot;,&quot;bc&quot;,&quot;c&quot; 三个后缀。&quot;c&quot; 实际上已经存在于 node1 后的边上。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 9, active_point = (node1, 'c', 1), remainder = 4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>继续处理下一个字符 &quot;d&quot;，&quot;#&quot; 继续向后挪动一位。此时由于 remainder = 4，所以需要插入 &quot;abcd&quot;,&quot;bcd&quot;,&quot;cd&quot;,&quot;d&quot; 四个后缀。</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>上图中的 active_node，当节点准备分裂时，被标记了红色。则归纳出了 Rule 3。</p> <p>Rule 3</p> <ul><li>当从 active_node 不为 root 的节点分裂边时，我们沿着后缀连接（Suffix Link）的方向寻找节点，如果存在一个节点，则设置该节点为 active_noe；如果不存在，则设置 active_node 为 root。active_edge 和 active_length 保持不变。</li></ul> <p>所以，现在活动点为 (node2, 'c', 1)，其中 node2 为下图中的红色节点：</p> <p><img src="data:image/png;base64,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" alt=""></p> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 10, active_point = (node2, 'c', 1), remainder = 3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>由于对 &quot;abcd&quot; 的插入已经完成，所以将 remainder 的值减至 3，并且开始处理下一个剩余后缀 &quot;bcd&quot;。此时需要将边 &quot;cabxabcd&quot; 分裂，然后插入新的边 &quot;d&quot;。根据 Rule 2，我们需要在之前插入的节点与当前插入的节点间创建一条新的后缀连接。</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>此时，我们观察到，后缀连接（Suffix Link）让我们能够重置活动点，使得对下一个后缀的插入操作仅需 O(1) 时间。从上图也确认了，&quot;ab&quot; 连接的是其后缀 &quot;b&quot;，而 &quot;abc&quot; 连接的是其后缀 &quot;bc&quot;。</p> <p>当前操作还没有完成，因为 remainder 是 2，根绝 Rule 3 我们需要重新设置活动点。因为上图中的红色 active_node 没有后缀连接（Suffix Link），所以活动点被设置为 root，也就是 (root, 'c', 1)。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 10, active_point = (root, 'c', 1), remainder = 2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>因此，下一个插入操作 &quot;cd&quot; 将从 Root 开始，寻找以 &quot;c&quot; 为前缀的边 &quot;cabxabcd&quot;，这也引起又一次分裂：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaUAAADjCAMAAAASevtZAAAAZlBMVEX///8AAACYmJiqqqrz8/UGBv/6+vsKCQpsbGzp6e8qKiqLi4s5OTnT09NKSkpZWVoUEBPb29t9fX3KysodHR3AwMDi4uJ8fP+7u/+0tLScnP8jI/8+Pv9eXv/U1P+hoaH+AACXAAA6mr0oAAASAUlEQVR4nO2d6YKrqBKARQ24oBK3xKz3vP9LXtAkajrGDUrN8P3o6cnptjpUgKKoxTA0Go1Go9FoNJoVY/uhszfUAyVn9fhe+//t2Ov9HUwRQqRv+HxvrrRhcv4LBKjvhRa262IjQwJn7JPHSBsh57/AHvW90IKhJyQc++Qx0kbI+VGSNMxpZhix5fh8mEzPSwzsm05sGKbpO1+15JUDVw6f3/1TzSdPkzZMzk+TsDjhi4pnBCkft8RwPCM2DZdik49I0q0l16Ri4Gjui6+48+daT54gbaic1TBlc+/HoeV/Mh+VS06O3DQQL/CPeecaZN9DRCITocjmP2RlXwU0njxW2ig5K2Hk5j6QOLX4V8faV+NmI8wK/gImWYeWbJPyoSv4x9q5D3h+88mjpI2UsxZGbu7DMJOCuXy03Axh8bwsMiJvb5t2GGL+MXhfYvinm5DQsgc/v/Xk4dJGy1mSOZv7ICzPdlOaGyG1UseOHNO3DTckNDDy0HNMmrR+OnMYor47SkLzyUOlTZGzJFM3dwXksYc8PzdUAyVHJlM2dwW4PkVpHBiqgZIjmdGbuwKwxTeJSL2FBSVHOiM3dxWITSK8q9/HoeSMJXc8kn797Izb3FX8if/5zShh5N+/f2y9bg9ciBWoUD5hoeRMwU7Z/wT/kOSV2C1Xjdn3Mfs4RRRgBYKSM407+l8Fk+zp9cTncuZ9jDj4pwArEJScyTjsoaV/xJQKK338c+5jxEYOYWtByZlB9NISksvM+xh8F0cW9R9vKDnziF9aSuU+OOWKcu4T72P2wh4G2Mih5MwlQ/8qLRHJ98ROaS5NuY+pdgn1/jMoOTIISakmgoil4vGj72P2QLvEfv27UQM7RIwxkqYeio3FCSK+TgLE6EDJkUcWO9HOzlCEooVX6CJEnglwZoGSI5njzjVi4pNowT/d5efKSLmzCU6OfG67m4EpzZg3ZBXwZUQ6vBE4hMUAOzmUHBW4uyN/A8R3KRlwux9Iv6tIIm5tAcxjKDlqwEJLhokyHCOnd3OSfaNUUEQtgC0RSo4ydifxNWK5cSf0y4LQDH2Qg+3zbQLgWhRKjkrOB/EVU882kjTt1EA7+lACdswQhEUMJUctl1JLxp5xD4QborhzXWhFH84ldwhxAHxoUHJUc7lW/y2QsB5McQ/7kXb04Txsn4GMHZQc9VwfWuKnJrHcBR75OJ3a0YezwGYKYhJDyYHgenl+F3rCUsU+8T45uZqhD3PgY0cgTGIoOTAczs/vclbNkjxEkbJlovAUPnwBOUCcdq9vs+d9UMGXPSUfw32IQgibuFeOnHwROI67ehsy0cP/gE0V264df15Ml5ATgEZPz0a4W1845HlgKo+CUj2T2GcMIsVkmJz9trQk3K01IXsdALHpcS+/NBspo72r6CObQ7kcSfkikFSOvCe25zXeYhYRIico13YQ7d2QqmwO9XLg80XmUznynuQpbWqlzFkM/bk7vpUOWezS2YbFMDnA+SJSqBx5LwIWtj/OrhkxlEbW9LUvoMgZMiGrbI7JYgbLgcwXkcWlrSUj+RtThJOYIuRFZjBhDLuOyX+psjmMiQyXA5cvIo+Xi+iJ9TGMzrYcShChsTXQwZwXpU4DSuKBA1Jlc4xlvBygfBGp1C6iJ2ZXtCNOzMhDXFWRb+2/D4krQpA9frc4ZeBHACVn6UoCtYvohfkt9MvNTCdM+dikNIrv2f5ticKeIz6lITOTgjKP+KpWlrhMIVcvx6blG1q4KkfDRfTC7I0dtpN77ISeqCtCPBo6sW9aRZbs80DoLy6QGQRBwlJ1H3C+U4qKGcrl7B9vaNkKN00X0Qt/6B+UJwVXV0S9lLVj+hM+egElSBkMSE6T5apFtVxEDTWN9wLY7j5I7qKykhehQoyeRy1leGVSh3o5vnhDaVRqabnKa20X0Yv7xHhXt8zExynlH3JH5RrB3d6WDSDHRYxvTCJrjixYxdBuuYhqMhJOOrtUv5QQRlMU+6myy1LbhpFjVHcDth8tGuTSdhHVZIzOeOuu74iyK8qtIig5S/PmIqoJ0nTjYWw/xOXa9S/cGaAktUkznr/OhxfYWUNqk8b46HyoMZGMnBkMlHuHt1hFaBifnA81xSwb4oEdIZB6jVByFuC4+zpbgi/R48PxgaxY/1cLs3cca1+4VNsQy9N1rH2BI21DLE/XsbbGR9HPBPNulc5jbY1FQikuGBcoKtj9oejjB93H2ppEig1hOGUEinqg5ADy5Vhbw6+uJfid7cgD8bhByQHk67G2Rs7mBJVQ9COJSzXfj7U1xbCiEBol9Bxra/be7y33m6HvWFtj65PTYvQeaxuYKJQS3R/BrJ1QciDoP9bWyNmcco+BxJZCyYFgwLG28cYpk+DWsx0YIwxKDgBDjrU1/GrQ0f4ieA5DjrUNMjmOCM0oTsOOtTU5JaahAQUPPjDVvxIjSe5XIEeOu32H0fADU03gMRnTKaQw3msoOQoZc2CqfymS4dfLPZgIeSg5KhlzYKqxWDrfYWQDWcr29i3yy5gDUw2/zdA2ORzXUQemBkXaccT1t1XnZxMcxpriL9zoc+2sjdX52QRDb5g+UaSfclrH1lNwY5ilE0qOCj7nAw7kYwmtsdWSE+aBmMpQclTgTjHFa/Z/6x6OrpacA8WS5RuOWZtmitdY6VslLWnVkjU152mmeI3tk/Te2J4kVUvWNJlsite4DvLqQ66UasmaNtNN8Qa5g+jTjJhcLRlq19ji7jTHFG+QhHM7SmAKs7tDyZHKLFO8SUFnlnstGEzpCyg5Mplpijfh84nOccLmQIZhvkEDdK4p3iSIkKfz0lRwmW/kNRB6umszXDrXkQEqffB1T88n6ZxkmOItxHya0XTUBQp/cbcUZiPNyGsOQDyjD8MdKEn0vqVkVIlGXoM5fRiyEGZjkynn093n+2uzGqHINPIaYIvOM8w3xae7zz+vzbkgvcz1t3aScUPid/pVfeXT3eef1+YUnJdt5DURLX3j38sab9HsFJukYS48ms3XHq1WZjZCOUg38prkDpu6QUEdu2a2QWl1ik2YqKzYeq1qtdLfCCX7WlV/fBTyyEHgG9SUhc/2YMpDz5bT6hTr0PfXqoKQfY1QbPq9HrYaI68FX/jYeMvcB6riPVNOu1NsnFpvr1WtVroboeSZ6Hbgl6WWv8wmRUZeC36CQuHYEnYJkOUxS067U6yZFMxtv1a1WuluhCJKYTMvLbX0pXqcXE9eF/juzXJJrJZmp1jLs92U5q3XqlYrnY1Q+E13Xcr+y+dYrfnQoAhR6uu4lRc4MKNU6IcQPyDkezuN0w7Mib13CIp05QiOazncXmChn7kIhbkYmuiriTUliWky2OITyhl1+b4HKskKJcdIfD6FkOfcK2PBHHSFgCHMh+ZoxCmiI3aoGMjWg5DjFrFoORbG2egdWp2PqAN8p2UPiYH4QO5XxXKCstNYOq19n1ofURf72Cu7l/w3sLM4ZKJrXzHdXSYp2mssgVCU87N1wJ/k99JOiPxs3jHkCGk+tMiclHuPfnZG4ay0E+jTTpj3MGDzof1GuKL4jPq5iJbKThCmtqyTPLj50CbwKTd7eju35x7M6jhfTnlaFaZ2IPPDt4T50Cb3+xuC2xECORDPkvOwE8K4kO5kAfQ+fHl/lnCXRPcvVtDcSL/HhVwvE+VUdkIa+YmS4bypv7wYRuCHhK8UliJnX3Uhp+LJlZ1AqGMpvJle0Hz4+37L1u1KNKWmQ5t8O6EDmMuL4e/77njl7tvxwSwmdvGpLuSG/3y/nMpOkGNq9wJ2eTEc7jTu8qcUaOL2Xl3IDf7x73IqO4FNcclNREWAqwTsIg7Jn4Fw+Y1MOmlkqgu5wT/dLSevJvtUl9zU4ViL+fAX/HRS+k/bNqyaMT86oaoj+iiH2wlhWrrk4D/YK9uY3nErV0saCnelV14+m4SFntIi55aHSFuOuLojwiWXLHNyWeHG9IeHqhgpwwSI6NAdI4WzKUQhn8VPOcnDJWctGAS60o3pL24Wo4qq231oKkPMWUIfcthCi1wLvKITUw+ZUFHqoUSMHiVIGVVYz0MOTdbgD175xtTA9q3ANgJk8sFLVOab88M1icyHnHSkB3ZWGkwnW9iYWoTMTCw+ldRl9MWhZT/lsBBF45Y7JXUCl7sJnIgrDHIv85Hi6g0POYaVMnPMordXoaUNbUxP8kycKS2iOvGyklNWAxzq8piZBtPNdjamNwpJXUD7aZZb+kp/GsxUVnHHNIkkTaEiJxL6uVjtG31pMNNx1+sk6v3TQzLMSS4hH9nySH/LoO40mNlsdskrm28MchXJyEfGfkqcnnuK7jSY2WzOFm9yJ0P64cnJRy6rJHxdYzvTYOZz25ot3iLr6IenJB8Zc+9RaC2zj5+Xjfeayb6jH96MfORviFysRbLvN73kdffDm5qP3MfeYYj64IranPvhHYt9Kjc/Ph95KLiIuKJi2LhcvO0lz6ha2bwP2YR85BHggl+tk9AH7Ja48SVP4BPaNiIm5COPJb+X4Z4m0N3Gtq28isAj8QLGVxnuKSK+AMJVzts92L7APvEWyYnCQRmATKhjqi1Ucdj9Qj2GPBzkbFMCTsxI3B+nYXxXtQLa27u++EjhkUW7Le0Lv9IVjWKz2A/U1mClXrdvP1Rv2GRs8cp8eWHGERXREykNHa6u5GPvXLM6c/kMDW1bddyuY/wNbKYkXkVclB1YvhNRr4yjYR6NuMKsIkv2j+rzKRLeJqv814F/8OVTvtnQtJ914cZk+fnUxN5nlhk7UUi9R3gSIiyttEdoFb027Ekf/Q/q0n7U4saMrWM+/QW7+yQrLNOPRR0ixEZp6aMxnm42iZxfMpBo5bUKRPJ3Yoxa8fjF+t/JNDbtZ02ISwa66p4OSWUzjLAejI8708i0n9UNg0OY82Mlfo9/z0zj0n5WiMtvV8PfKtJy3Upg/xhEfSr6SxUU7V/w5n0gichi1+DywUcAP5HyvhAf31kR8RuGX1n5Duo9EMr7QnRQVVD8jZXvovyiSXlfiG6yiJDw/gPOf6xSTTB9Ib5h38OfUJRCNUnrCzHvryi4LbF5o8++qDMhpPSFmI9rijJi920r6rBTFFE0ty+ERLiixIyCqE6jitPuomLVm90XQvKfY0XcgRYDRmpJ5nZWsurN7AtRs7fkHH2qoqSRtdG1Dx/UTKe53MopJnrhSLv1EkVJEd3olLpddtfVfcRuu93lcAzKazOJ1fRtyymDH7fnPcfG6bw7rOpgYd9Ou5LyVjqU+/Ay+DF9VSXdzkWAfdjtDkvPp9vxeDocrpfz7sWFVCW3pLM3uT2RijmVoVCYf7L2P7UIPV0XiC2yS91cX7o5X66Hw+l4c/n31xsWcaREjRH9qEoqJPhY6v6nEny67M4HEEPCvbVmzfnCVXM6Hm/NYbqWc9v2I0fhSccu4rILXCp7/1PJ7coXmZMiRQnVnIRqzg3VnNqqWQCCXrWoJO9/6sBHrqjz4Shr6OyHai5vqlmPreKI+OE7UrT/KQMfD+fSDP5mTdwp8zqjtN9Vc16dav68Z4X7nzrc05WP8JkP7vvQnspp5qPQd1hru8UfVFOaAZu43la8/yn8w48HoarS6qonAn/hcHOJEwSBRe74zXrelmp+h9vxpYOz2FWq71hVm3H3phtDsyj2Y9JcHy6BSkuhnjbrRBw2j48Vj5317FknL+sh5tbD+WcyoX6TyhLH191BL3jrh9/1jlj11NQM1vRyPJ9HrHqB6iAHzWf4Xe91sFNhr7W0EPi4GzadFIZIavpxL0OMCMUhkpo+BkW4qA+R1PRw659OICGSmu8c+nYnqBBJzTfc6/eAMYU1gzUjOK4tYEzzCXzanU96TVs9Nt+e9HxaP+4aAjA1vQg9XbdfHPbnsU/n3eWkF77VI+L6rvqOcPXYcBHNmjncDmetqC1QKUovfWunDD2/6Bm1foSidteTPkatnRs3JmRmc2gU4Z5E2o2eUqsHHw8XraktYGtNbYSnpg5H7UdaN/j4yGU7LZ1bq+nBPYlJtbtoVa0dfDtdharEAvg6/NoPf4XW3ZrgqjqUSYcXoSv8iElKPMQ2UobhP4R9fOiqrApxObIxTVY0oAhdPXJ2hZYiQ7NSqrRqprW0ag6iLIirV7wtoK0HjUaj0WgA+D+m4hJBpPIMaQAAAABJRU5ErkJggg==" alt=""></p> <p>由于此处又创建了一个新的内部节点，依据 Rule 2，我们需要建立一条与前一个被创建内节点的后缀连接。</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>然后，remainder 减为 1，active_node 为 root，根据 Rule 1 则活动点为 (root, 'd', 0)。也就是说，仅需在根节点上插入一条 &quot;d&quot; 新边。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># = 10, active_point = (root, 'd', 0), remainder = 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="data:image/png;base64,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" alt=""></p> <p>整个步骤完成。</p> <p><strong>总体上看，我们有一系列的观察结果</strong>：</p> <ul><li>在每一步中将 &quot;#&quot; 向右移动 1 位时，所有叶节点自动更新的时间为 O(1)；</li> <li>但实际上并没有处理这两种情况：
<ul><li>从前一步中遗留的后缀；</li> <li>当前步骤中的最终字符；</li></ul></li> <li>remainder 告诉了我们还余下多少后缀需要插入。这些插入操作将逐个的与当前位置 &quot;#&quot; 之前的后缀进行对应，我们需要一个接着一个的处理。更重要的是，每次插入需要 O(1) 时间，活动点准确地告诉了我们改如何进行，并且也仅需在活动点中增加一个单独的字符。为什么？因为其他字符都隐式地被包含了，要不也就不需要 active point 了。</li> <li>每次插入之后，remainder 都需要减少，如果存在后缀连接（Suffix Link）的话就续接至下一个节点，如果不存在则返回值 root 节点（Rule 3）。如果已经是在 root 节点了，则依据 Rule 1 来修改活动点。无论哪种情况，仅需 O(1) 时间。</li> <li>如果这些插入操作中，如果发现要被插入的字符已经存在于树中，则什么也不做，即使 remainder &gt; 0。原因是要被插入的字符实际上已经隐式地被包含在了当前的树中。而 remainder &gt; 0 则确保了在后续的操作中会进行处理。</li> <li>那么如果在算法结束时 remainder &gt; 0 该怎么办？这种情况说明了文本的尾部字符串在之前某处已经出现过。此时我们需要在尾部添加一个额外的从未出现过的字符，通常使用 &quot;$&quot; 符号。为什么要这么做呢？如果后续我们用已经完成的后缀树来查找后缀，匹配结果一定要出现在叶子节点，否则就会出现很多假匹配，因为很多字符串已经被隐式地包含在了树中，但实际并不是真正的后缀。同时，最后也强制 remainder = 0，以此来保证所有的后缀都形成了叶子节点。尽管如此，如果想用后缀树搜索常规的子字符串，而不仅是搜索后缀，这么做就不是必要的了。</li> <li>那么整个算法的复杂度是多少呢？如果 Text 的长度为 n，则有 n 步需要执行，算上 &quot;$&quot; 则有 n+1 步。在每一步中，我们要么什么也不做，要么执行 remainder 插入操作并消耗 O(1) 时间。因为 remainder 指示了在前一步中我们有多少无操作次数，在当前步骤中每次插入都会递减，所以总体的数量还是 n。因此<strong>总体的复杂度为 O(n)</strong>。</li> <li>然而，还有一小件事我还没有进行适当的解释。那就是，当我们续接后缀连接时，更新 active point，会发现 active_length 可能与 active_node 协作的并不好。例如下面这种情况：</li></ul> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASMAAABtCAMAAADd2/e3AAAATlBMVEX///8AAACZmZnZ2dnr6+v4+PgWFRYnKCd2dnaIiIjBwcE2OjYKCQpjY2NNTk3Nzc2xsbGnp6efn5/4AAAAAPgA/QCBAAAAAIMAmwAA1wC6zHGYAAAEw0lEQVR4nO2d23ajOgyGET6fgb3Tdt7/Rcc2MA2TBjKEHDD6LtqSlbLKH0u2JUutKgRBEARBkJJpDUnfqJh/m25JdVgY9A+vZ99kAEBVhwVuGCAKEscdSdA6rkaTuyC4hMgatdVRgaZqeEWvjBIJYGFAV0clikPgmskRl8Qx2kahTHVYrmtElADOATyLWnnFqsNyRaMgBQhJorHV1dFpQVIJbTeZ2kkUiMusGqMVckEv0HEd9CJUoUCzUGXAOhToKr1ATXGzV7SMjW5UlylQIsAGN2Gdt9aXKVCE3K1REgh8V+oMX9fKRY065eXKO7C2aIGiRCrbWuNrtWq7yRrHixYoIkK2Nbdqr5AFMqr0RbTVvUYu/vyP4S+dBTpAzMzH/XgA1lrNun+xNS05iCMIFKFeuNqESnJxe4QwCyTLEYgqJ8O9N2GtlKOEY7yjBHpPqi03Yn02og9qsBwmM2wS7yiAkJ+FCXM6nb5g7UiSYOK8Lu3/ERuNEvgb7DUI0XXP+GGtvM5xduHgV9ToJHy9jpQSA28/k0af9k3iHVK6IYEwrljWXg8kiU6Gwzr63xs0gtI2YzoNI+nhK2nE1zqkJLhvRa/RRuGB94EaqZKl8K/TL8PXLoVrU9MUrv5Mw4iXthwKLqf9lI9fxL1uRMV7WWWKEonIwZFE8yA63O9HqNa0okKUszVr4DGZY8pNMW6bDNl16ze+cbC+GJH0oNHmpqELEqnLGj3gQFTgpYiktEzT2SOeJnDzw+gkyu/shJqLi27/qONQRIjLJYAhbGfrAtmk04dbO+wRKi7XSfbAh0F/hBrbTF5gNcSPJa/ruwrpkfBXoglIpU2c9Q58BOuC2vqJ544a5fOQeM7oDM35ub1FjZiTageWxvzdkeuboR7cH8tKZ9jZLs46xgnnmXHCzo6plOSzabBc7OBM6JOD8dSB+R64bZPCA02FTNEG3KgS7yjVc3ltKoU1Rzzm3wkw/dhphRVyRiJmrIsRv0MW1TQmxs1n/SBtkg/obENIkPaYy4OUueVO6Wv+uk6RLGlMlIhoeJHHIuZ5c/6Vv0D5GB0WXtY6kLORQoluuiGbJaJE4VUaEf4WcWbSSi/6CCgf6CN9+ZuQydaIe5WtvdOqhJLQtGOat9WBsrjCBNEc2mffgMr2Fed+fsi5H0EOgRYYIl2gpIzgo2AYPEYQ5OWgq15EcczRLNDixnARhkXPCIK8HJzOlmBO4MJoAWUxU7zE3o4cIghSINjObBFqDtxV8UYcpj8WoWhqyNacdU/bX7HPs/junra/Yp8HQH6S4Lt7Ghb7pHI69/dLZ93TsNgn4S/S+dPuaVjs81MWbdo9DYt9fmLaPW0/xT7PZNI9bT/FPk/lvHvanop9tmToe6Zv9jDLxT6b9GN7CyZ9zzp7c1vUmWIfmkfXnf3Y3okOhEp9z/6LWH5759iZYh+TuhAzYQIhEt5zJDFNh8PuoyXMXef/c2PsR9Log9dbwHNTFmhSlYZY26/3sQQRhv464x507lr1dRa9RrAJQ++akKp9jKv2j4qPZGrRa7RN3zMRZXI11Gkc8RIcks7Ncds0kD426hMic1N0z+vQmJLOdPV9z7a8I92kH9tbkfuebcsm/dgQBNkpvwG0uixL5eXZUQAAAABJRU5ErkJggg==" alt=""></p> <p>假设 active point 是红色节点 (red, 'd', 3)，因此它指向 &quot;def&quot; 边中 &quot;f&quot; 之后的位置。现在假设我们做了必要的更新，而且依据 Rule 3 续接了后缀连接并修改了活动点，新的 active point 是 (green, 'd', 3)。然而从绿色节点出发的 &quot;d&quot; 边是 &quot;de&quot;，这条边只有 2 个字符。为了找到合适的活动点，看起来我们需要添加一个到蓝色节点的边，然后重置活动点为 (blue, 'f', 1)。</p> <p>在最坏的情况下，active_length 可以与 remainder 一样大，甚至可以与 n 一样大。而恰巧这种情况可能刚好在找活动点时发生，那么我们不仅需要跳过一个内部节点，可能是多个节点，最坏的情况是 n 个。由于每步里 remainder 是 O(n)，续接了后缀连接之后的对活动点的后续调整也是 O(n)，那么是否意味着整个算法潜在需要 O(n2) 时间呢？</p> <p>我认为不是。理由是如果我们确实需要调整活动点（例如，上图中从绿色节点调整到蓝色节点），那么这就引入了一个拥有自己的后缀连接的新节点，而且 active_length 将减少。当我们沿着后缀连接向下走，就要插入剩余的后缀，且只是减少 active_length，使用这种方法可调整的活动点的数量不可能超过任何给定时刻的 active_length。由于 active_length 从来不会超过 remainder，而 remainder 不仅在每个单一步骤里是 O(n)，而且对整个处理过程进行的 remainder 递增的总数也是 O(n)，因此调整活动点的数目也就限制在了 O(n)。</p> <h1 id="参考文章"><a href="#参考文章" class="header-anchor">#</a> 参考文章</h1> <hr> <ul><li>https://www.cs.helsinki.fi/u/ukkonen/SuffixT1withFigs.pdf</li> <li>https://www.cnblogs.com/gaochundong/p/suffix_tree.html</li> <li>https://blog.csdn.net/v_july_v/article/details/6897097)</li></ul></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://fanxgit.github.io/fanxNotes/edit/master/docs/algorithm/04.一些领域算法/09.字符串匹配 - 文本预处理：后缀树（Suffix Tree）.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">8/17/2023, 5:04:28 PM</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/08a264/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">字符串匹配 - 模式预处理：BM 算法 (Boyer-Moore)</div></a> <a href="/pages/52b53d/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">大数据处理 - Overview</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/08a264/" class="prev">字符串匹配 - 模式预处理：BM 算法 (Boyer-Moore)</a></span> <span class="next"><a href="/pages/52b53d/">大数据处理 - Overview</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/797621/"><div>
            VuePress+GithubPages教程
            <!----></div></a> <span class="date">11-19</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/016620/"><div>
            java打jar包整理
            <!----></div></a> <span class="date">11-19</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/b23a10/"><div>
            多线程问题总结
            <!----></div></a> <span class="date">11-14</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.38fd400a.js" defer></script><script src="/assets/js/3.e11db813.js" defer></script><script src="/assets/js/14.bc6d3062.js" defer></script>
  </body>
</html>
