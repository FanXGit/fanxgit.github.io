<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>xml映射文件 | Fanx 知识库</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/logo.svg">[object Object]
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.6ece31e0.css" as="style"><link rel="preload" href="/assets/js/app.38fd400a.js" as="script"><link rel="preload" href="/assets/js/3.e11db813.js" as="script"><link rel="preload" href="/assets/js/323.17573ee3.js" as="script"><link rel="prefetch" href="/assets/js/10.939e2dd4.js"><link rel="prefetch" href="/assets/js/100.4a08f581.js"><link rel="prefetch" href="/assets/js/101.45cd45c9.js"><link rel="prefetch" href="/assets/js/102.ac1359d1.js"><link rel="prefetch" href="/assets/js/103.22344102.js"><link rel="prefetch" href="/assets/js/104.5071cdfd.js"><link rel="prefetch" href="/assets/js/105.7767c121.js"><link rel="prefetch" href="/assets/js/106.809b79f1.js"><link rel="prefetch" href="/assets/js/107.62fd626a.js"><link rel="prefetch" href="/assets/js/108.0583fdc1.js"><link rel="prefetch" href="/assets/js/109.fa127771.js"><link rel="prefetch" href="/assets/js/11.6463adc8.js"><link rel="prefetch" href="/assets/js/110.5cf9f09c.js"><link rel="prefetch" href="/assets/js/111.9d963667.js"><link rel="prefetch" href="/assets/js/112.bc2b8a6e.js"><link rel="prefetch" href="/assets/js/113.2ae29573.js"><link rel="prefetch" href="/assets/js/114.0b2cedfa.js"><link rel="prefetch" href="/assets/js/115.652e433e.js"><link rel="prefetch" href="/assets/js/116.bcc5d64a.js"><link rel="prefetch" href="/assets/js/117.30b02d0d.js"><link rel="prefetch" href="/assets/js/118.87f4f927.js"><link rel="prefetch" href="/assets/js/119.05839492.js"><link rel="prefetch" href="/assets/js/12.a17960e5.js"><link rel="prefetch" href="/assets/js/120.3d772c9c.js"><link rel="prefetch" href="/assets/js/121.bd8fcebf.js"><link rel="prefetch" href="/assets/js/122.e58d2205.js"><link rel="prefetch" href="/assets/js/123.f2c2826d.js"><link rel="prefetch" href="/assets/js/124.12d9ff87.js"><link rel="prefetch" href="/assets/js/125.c7e4bf1c.js"><link rel="prefetch" href="/assets/js/126.71c358fb.js"><link rel="prefetch" href="/assets/js/127.fb1922e5.js"><link rel="prefetch" href="/assets/js/128.25cbf771.js"><link rel="prefetch" href="/assets/js/129.50047ea3.js"><link rel="prefetch" href="/assets/js/13.727ebfda.js"><link rel="prefetch" href="/assets/js/130.a77cfa28.js"><link rel="prefetch" href="/assets/js/131.1618c1f5.js"><link rel="prefetch" href="/assets/js/132.4073573b.js"><link rel="prefetch" href="/assets/js/133.f6e4882f.js"><link rel="prefetch" href="/assets/js/134.1de81973.js"><link rel="prefetch" href="/assets/js/135.43148a0c.js"><link rel="prefetch" href="/assets/js/136.12b3ef34.js"><link rel="prefetch" href="/assets/js/137.accefc34.js"><link rel="prefetch" href="/assets/js/138.8d3115ff.js"><link rel="prefetch" href="/assets/js/139.6e492e2b.js"><link rel="prefetch" href="/assets/js/14.bc6d3062.js"><link rel="prefetch" href="/assets/js/140.3d98f006.js"><link rel="prefetch" href="/assets/js/141.542d08af.js"><link rel="prefetch" href="/assets/js/142.c91a19a2.js"><link rel="prefetch" href="/assets/js/143.0c681ed2.js"><link rel="prefetch" href="/assets/js/144.62e9c646.js"><link rel="prefetch" href="/assets/js/145.ebc34777.js"><link rel="prefetch" href="/assets/js/146.d94a04a7.js"><link rel="prefetch" href="/assets/js/147.b45158de.js"><link rel="prefetch" href="/assets/js/148.5dfa6740.js"><link rel="prefetch" href="/assets/js/149.cb6f2cb0.js"><link rel="prefetch" href="/assets/js/15.a9468bf1.js"><link rel="prefetch" href="/assets/js/150.9f58dbc6.js"><link rel="prefetch" href="/assets/js/151.0a1c07e3.js"><link rel="prefetch" href="/assets/js/152.eafe4843.js"><link rel="prefetch" href="/assets/js/153.fb94cab5.js"><link rel="prefetch" href="/assets/js/154.07f7a11d.js"><link rel="prefetch" href="/assets/js/155.7f6da40b.js"><link rel="prefetch" href="/assets/js/156.2f007ca1.js"><link rel="prefetch" href="/assets/js/157.a35b5249.js"><link rel="prefetch" href="/assets/js/158.540f7a5a.js"><link rel="prefetch" href="/assets/js/159.f62e0315.js"><link rel="prefetch" href="/assets/js/16.ace3b806.js"><link rel="prefetch" href="/assets/js/160.e043c758.js"><link rel="prefetch" href="/assets/js/161.d90141bf.js"><link rel="prefetch" href="/assets/js/162.ddcdbfb9.js"><link rel="prefetch" href="/assets/js/163.f1ba395e.js"><link rel="prefetch" href="/assets/js/164.9f398973.js"><link rel="prefetch" href="/assets/js/165.0db3da51.js"><link rel="prefetch" href="/assets/js/166.b5305797.js"><link rel="prefetch" href="/assets/js/167.e7b2f76b.js"><link rel="prefetch" href="/assets/js/168.a2ecf883.js"><link rel="prefetch" href="/assets/js/169.88bd4d26.js"><link rel="prefetch" href="/assets/js/17.60481837.js"><link rel="prefetch" href="/assets/js/170.fb1699e2.js"><link rel="prefetch" href="/assets/js/171.47268bef.js"><link rel="prefetch" href="/assets/js/172.79002327.js"><link rel="prefetch" href="/assets/js/173.3b1813fb.js"><link rel="prefetch" href="/assets/js/174.362811a9.js"><link rel="prefetch" href="/assets/js/175.bb48bcd7.js"><link rel="prefetch" href="/assets/js/176.97bbf32c.js"><link rel="prefetch" href="/assets/js/177.0717ff7a.js"><link rel="prefetch" href="/assets/js/178.75bff3b7.js"><link rel="prefetch" href="/assets/js/179.3e7db0a2.js"><link rel="prefetch" href="/assets/js/18.dd3c5709.js"><link rel="prefetch" href="/assets/js/180.c81da8dd.js"><link rel="prefetch" href="/assets/js/181.142d6d1c.js"><link rel="prefetch" href="/assets/js/182.fb312040.js"><link rel="prefetch" href="/assets/js/183.3684267e.js"><link rel="prefetch" href="/assets/js/184.ec2a13bc.js"><link rel="prefetch" href="/assets/js/185.a7acace4.js"><link rel="prefetch" href="/assets/js/186.7df28551.js"><link rel="prefetch" href="/assets/js/187.347e9348.js"><link rel="prefetch" href="/assets/js/188.07356026.js"><link rel="prefetch" href="/assets/js/189.0816176d.js"><link rel="prefetch" href="/assets/js/19.cc2d4ad1.js"><link rel="prefetch" href="/assets/js/190.fd5dd8cc.js"><link rel="prefetch" href="/assets/js/191.a938967e.js"><link rel="prefetch" href="/assets/js/192.859b71a1.js"><link rel="prefetch" href="/assets/js/193.adcf2ec3.js"><link rel="prefetch" href="/assets/js/194.69d1169c.js"><link rel="prefetch" href="/assets/js/195.ad7cbcc4.js"><link rel="prefetch" href="/assets/js/196.b65138da.js"><link rel="prefetch" href="/assets/js/197.b4fca73b.js"><link rel="prefetch" href="/assets/js/198.2494a23f.js"><link rel="prefetch" href="/assets/js/199.404b9ce1.js"><link rel="prefetch" href="/assets/js/2.938bab56.js"><link rel="prefetch" href="/assets/js/20.361e2bf6.js"><link rel="prefetch" href="/assets/js/200.42b54eae.js"><link rel="prefetch" href="/assets/js/201.ab495eb8.js"><link rel="prefetch" href="/assets/js/202.2cbc5c9a.js"><link rel="prefetch" href="/assets/js/203.abf3fde5.js"><link rel="prefetch" href="/assets/js/204.4fdd4cfb.js"><link rel="prefetch" href="/assets/js/205.411987d7.js"><link rel="prefetch" href="/assets/js/206.dbcab3ae.js"><link rel="prefetch" href="/assets/js/207.f1429354.js"><link rel="prefetch" href="/assets/js/208.f763286c.js"><link rel="prefetch" href="/assets/js/209.c1edbca5.js"><link rel="prefetch" href="/assets/js/21.ae1e88a3.js"><link rel="prefetch" href="/assets/js/210.b2a1501d.js"><link rel="prefetch" href="/assets/js/211.fe1fd5f7.js"><link rel="prefetch" href="/assets/js/212.0fd39a8f.js"><link rel="prefetch" href="/assets/js/213.bb3fc163.js"><link rel="prefetch" href="/assets/js/214.c42e1ef3.js"><link rel="prefetch" href="/assets/js/215.4f0fa915.js"><link rel="prefetch" href="/assets/js/216.07c485c9.js"><link rel="prefetch" href="/assets/js/217.ada25e7a.js"><link rel="prefetch" href="/assets/js/218.2f761d3c.js"><link rel="prefetch" href="/assets/js/219.32d1a663.js"><link rel="prefetch" href="/assets/js/22.0b09d67f.js"><link rel="prefetch" href="/assets/js/220.36c56cf4.js"><link rel="prefetch" href="/assets/js/221.3e0431e2.js"><link rel="prefetch" href="/assets/js/222.90aa0ff7.js"><link rel="prefetch" href="/assets/js/223.5966d7df.js"><link rel="prefetch" href="/assets/js/224.7e2329e1.js"><link rel="prefetch" href="/assets/js/225.2ed3675d.js"><link rel="prefetch" href="/assets/js/226.fa3cef02.js"><link rel="prefetch" href="/assets/js/227.07bf7bca.js"><link rel="prefetch" href="/assets/js/228.9ac2589a.js"><link rel="prefetch" href="/assets/js/229.b980e141.js"><link rel="prefetch" href="/assets/js/23.31ed5c2f.js"><link rel="prefetch" href="/assets/js/230.2c32e874.js"><link rel="prefetch" href="/assets/js/231.723e20cb.js"><link rel="prefetch" href="/assets/js/232.1f94511c.js"><link rel="prefetch" href="/assets/js/233.2d477f71.js"><link rel="prefetch" href="/assets/js/234.10141c75.js"><link rel="prefetch" href="/assets/js/235.a328b127.js"><link rel="prefetch" href="/assets/js/236.42419c3b.js"><link rel="prefetch" href="/assets/js/237.648ca44e.js"><link rel="prefetch" href="/assets/js/238.4b363b75.js"><link rel="prefetch" href="/assets/js/239.fe711a73.js"><link rel="prefetch" href="/assets/js/24.fe75e3fa.js"><link rel="prefetch" href="/assets/js/240.6baa12bf.js"><link rel="prefetch" href="/assets/js/241.6f375dc4.js"><link rel="prefetch" href="/assets/js/242.aee8e39d.js"><link rel="prefetch" href="/assets/js/243.bfc7f6e1.js"><link rel="prefetch" href="/assets/js/244.c73a14a7.js"><link rel="prefetch" href="/assets/js/245.a2352aa1.js"><link rel="prefetch" href="/assets/js/246.b12c3ae6.js"><link rel="prefetch" href="/assets/js/247.2f768275.js"><link rel="prefetch" href="/assets/js/248.3f79dfb1.js"><link rel="prefetch" href="/assets/js/249.7fd0cb75.js"><link rel="prefetch" href="/assets/js/25.f2e379df.js"><link rel="prefetch" href="/assets/js/250.df3f1d0a.js"><link rel="prefetch" href="/assets/js/251.a3865750.js"><link rel="prefetch" href="/assets/js/252.d62542df.js"><link rel="prefetch" href="/assets/js/253.59b2f200.js"><link rel="prefetch" href="/assets/js/254.522d17b5.js"><link rel="prefetch" href="/assets/js/255.0f95a196.js"><link rel="prefetch" href="/assets/js/256.31b37cbe.js"><link rel="prefetch" href="/assets/js/257.ff22ad12.js"><link rel="prefetch" href="/assets/js/258.15205e0b.js"><link rel="prefetch" href="/assets/js/259.f3b7c5aa.js"><link rel="prefetch" href="/assets/js/26.45264b04.js"><link rel="prefetch" href="/assets/js/260.fec3c7aa.js"><link rel="prefetch" href="/assets/js/261.d965ee56.js"><link rel="prefetch" href="/assets/js/262.76a7105b.js"><link rel="prefetch" href="/assets/js/263.e684cc46.js"><link rel="prefetch" href="/assets/js/264.59297da0.js"><link rel="prefetch" href="/assets/js/265.66182ed2.js"><link rel="prefetch" href="/assets/js/266.eec50d90.js"><link rel="prefetch" href="/assets/js/267.c85bce12.js"><link rel="prefetch" href="/assets/js/268.ef544f0c.js"><link rel="prefetch" href="/assets/js/269.8cfb5c6a.js"><link rel="prefetch" href="/assets/js/27.4e065810.js"><link rel="prefetch" href="/assets/js/270.b66cab3c.js"><link rel="prefetch" href="/assets/js/271.c1b7d136.js"><link rel="prefetch" href="/assets/js/272.0d7950c3.js"><link rel="prefetch" href="/assets/js/273.06349cca.js"><link rel="prefetch" href="/assets/js/274.9b442c09.js"><link rel="prefetch" href="/assets/js/275.11082d81.js"><link rel="prefetch" href="/assets/js/276.ce0abe31.js"><link rel="prefetch" href="/assets/js/277.4b7fcc53.js"><link rel="prefetch" href="/assets/js/278.129d0397.js"><link rel="prefetch" href="/assets/js/279.5c021f7c.js"><link rel="prefetch" href="/assets/js/28.126ecd33.js"><link rel="prefetch" href="/assets/js/280.d183c9e3.js"><link rel="prefetch" href="/assets/js/281.0df67750.js"><link rel="prefetch" href="/assets/js/282.8fdd2372.js"><link rel="prefetch" href="/assets/js/283.dae956df.js"><link rel="prefetch" href="/assets/js/284.c5dc7189.js"><link rel="prefetch" href="/assets/js/285.7f5a7367.js"><link rel="prefetch" href="/assets/js/286.d9bfcef5.js"><link rel="prefetch" href="/assets/js/287.4fa6a5c5.js"><link rel="prefetch" href="/assets/js/288.57904d2d.js"><link rel="prefetch" href="/assets/js/289.b96d7c2f.js"><link rel="prefetch" href="/assets/js/29.8f5db82a.js"><link rel="prefetch" href="/assets/js/290.8dda9646.js"><link rel="prefetch" href="/assets/js/291.ab433493.js"><link rel="prefetch" href="/assets/js/292.e2d59796.js"><link rel="prefetch" href="/assets/js/293.30f9fcc4.js"><link rel="prefetch" href="/assets/js/294.158492dc.js"><link rel="prefetch" href="/assets/js/295.33e3a53d.js"><link rel="prefetch" href="/assets/js/296.49d7a2de.js"><link rel="prefetch" href="/assets/js/297.1b7572ac.js"><link rel="prefetch" href="/assets/js/298.00e4586a.js"><link rel="prefetch" href="/assets/js/299.d8fb6ff9.js"><link rel="prefetch" href="/assets/js/30.ef97cb8e.js"><link rel="prefetch" href="/assets/js/300.90e9dadf.js"><link rel="prefetch" href="/assets/js/301.d5592ea1.js"><link rel="prefetch" href="/assets/js/302.b08dc1ea.js"><link rel="prefetch" href="/assets/js/303.bef541c8.js"><link rel="prefetch" href="/assets/js/304.be3f7081.js"><link rel="prefetch" href="/assets/js/305.13718421.js"><link rel="prefetch" href="/assets/js/306.41685aa2.js"><link rel="prefetch" href="/assets/js/307.6d569102.js"><link rel="prefetch" href="/assets/js/308.aaabab89.js"><link rel="prefetch" href="/assets/js/309.910ecc42.js"><link rel="prefetch" href="/assets/js/31.795b3334.js"><link rel="prefetch" href="/assets/js/310.104b7753.js"><link rel="prefetch" href="/assets/js/311.45f4a7da.js"><link rel="prefetch" href="/assets/js/312.180c7e45.js"><link rel="prefetch" href="/assets/js/313.87d3a801.js"><link rel="prefetch" href="/assets/js/314.7739b1ef.js"><link rel="prefetch" href="/assets/js/315.54a1fac0.js"><link rel="prefetch" href="/assets/js/316.a978a787.js"><link rel="prefetch" href="/assets/js/317.84f65f2c.js"><link rel="prefetch" href="/assets/js/318.7f8caff8.js"><link rel="prefetch" href="/assets/js/319.0b5276f3.js"><link rel="prefetch" href="/assets/js/32.e65c7229.js"><link rel="prefetch" href="/assets/js/320.ba90589a.js"><link rel="prefetch" href="/assets/js/321.b6810c5a.js"><link rel="prefetch" href="/assets/js/322.2eaa727d.js"><link rel="prefetch" href="/assets/js/324.806fd6ca.js"><link rel="prefetch" href="/assets/js/325.4cd65079.js"><link rel="prefetch" href="/assets/js/326.fe0e2e22.js"><link rel="prefetch" href="/assets/js/327.a64d0209.js"><link rel="prefetch" href="/assets/js/328.aca1c89a.js"><link rel="prefetch" href="/assets/js/329.53ccf1dd.js"><link rel="prefetch" href="/assets/js/33.9a57aab8.js"><link rel="prefetch" href="/assets/js/330.92822a09.js"><link rel="prefetch" href="/assets/js/331.6b82baff.js"><link rel="prefetch" href="/assets/js/332.fc20f585.js"><link rel="prefetch" href="/assets/js/333.005ba8e3.js"><link rel="prefetch" href="/assets/js/334.9d3309b8.js"><link rel="prefetch" href="/assets/js/335.0e938f19.js"><link rel="prefetch" href="/assets/js/336.01fe9903.js"><link rel="prefetch" href="/assets/js/337.e207d67c.js"><link rel="prefetch" href="/assets/js/338.bfcf6bc8.js"><link rel="prefetch" href="/assets/js/339.a502aa64.js"><link rel="prefetch" href="/assets/js/34.3835d35c.js"><link rel="prefetch" href="/assets/js/340.3888b147.js"><link rel="prefetch" href="/assets/js/341.20297f95.js"><link rel="prefetch" href="/assets/js/342.9cd149e9.js"><link rel="prefetch" href="/assets/js/343.faac8369.js"><link rel="prefetch" href="/assets/js/344.da8cd079.js"><link rel="prefetch" href="/assets/js/345.78303b88.js"><link rel="prefetch" href="/assets/js/346.d8eaca82.js"><link rel="prefetch" href="/assets/js/347.edd389a1.js"><link rel="prefetch" href="/assets/js/348.21ee9617.js"><link rel="prefetch" href="/assets/js/349.0251471a.js"><link rel="prefetch" href="/assets/js/35.76dc7096.js"><link rel="prefetch" href="/assets/js/350.710b7d30.js"><link rel="prefetch" href="/assets/js/351.535f8d60.js"><link rel="prefetch" href="/assets/js/352.c66fe42e.js"><link rel="prefetch" href="/assets/js/353.ebbcd333.js"><link rel="prefetch" href="/assets/js/354.7cbba2f1.js"><link rel="prefetch" href="/assets/js/355.0106db16.js"><link rel="prefetch" href="/assets/js/356.7debf350.js"><link rel="prefetch" href="/assets/js/357.a43eb887.js"><link rel="prefetch" href="/assets/js/358.28e5d2ed.js"><link rel="prefetch" href="/assets/js/359.956fc3b8.js"><link rel="prefetch" href="/assets/js/36.fc54452c.js"><link rel="prefetch" href="/assets/js/360.13fb600a.js"><link rel="prefetch" href="/assets/js/361.d100f85b.js"><link rel="prefetch" href="/assets/js/362.35277df2.js"><link rel="prefetch" href="/assets/js/363.d993a7fc.js"><link rel="prefetch" href="/assets/js/364.0168c2b0.js"><link rel="prefetch" href="/assets/js/365.bc8af0bb.js"><link rel="prefetch" href="/assets/js/366.2645dc0d.js"><link rel="prefetch" href="/assets/js/367.87368acb.js"><link rel="prefetch" href="/assets/js/368.0b7d41fc.js"><link rel="prefetch" href="/assets/js/369.4bf3f46e.js"><link rel="prefetch" href="/assets/js/37.5a47cee9.js"><link rel="prefetch" href="/assets/js/370.ea5f965e.js"><link rel="prefetch" href="/assets/js/371.1af764ef.js"><link rel="prefetch" href="/assets/js/372.bf6c68e2.js"><link rel="prefetch" href="/assets/js/373.1a605cc8.js"><link rel="prefetch" href="/assets/js/374.34a41a4a.js"><link rel="prefetch" href="/assets/js/375.1d2d3776.js"><link rel="prefetch" href="/assets/js/376.4b7b0b10.js"><link rel="prefetch" href="/assets/js/377.b3d9748a.js"><link rel="prefetch" href="/assets/js/378.7f00fa88.js"><link rel="prefetch" href="/assets/js/379.adcd298a.js"><link rel="prefetch" href="/assets/js/38.6614c565.js"><link rel="prefetch" href="/assets/js/380.6d08bb56.js"><link rel="prefetch" href="/assets/js/381.164bb4e3.js"><link rel="prefetch" href="/assets/js/382.f71f0ca4.js"><link rel="prefetch" href="/assets/js/383.01ba70ad.js"><link rel="prefetch" href="/assets/js/384.22b98cde.js"><link rel="prefetch" href="/assets/js/385.5f1298a9.js"><link rel="prefetch" href="/assets/js/386.01a912bc.js"><link rel="prefetch" href="/assets/js/387.3db4713f.js"><link rel="prefetch" href="/assets/js/388.4cde7d0f.js"><link rel="prefetch" href="/assets/js/389.d96bafad.js"><link rel="prefetch" href="/assets/js/39.1a09ed15.js"><link rel="prefetch" href="/assets/js/390.343bbc06.js"><link rel="prefetch" href="/assets/js/391.68b3e72a.js"><link rel="prefetch" href="/assets/js/392.f4f15e43.js"><link rel="prefetch" href="/assets/js/393.82475934.js"><link rel="prefetch" href="/assets/js/394.3101ea10.js"><link rel="prefetch" href="/assets/js/395.34083342.js"><link rel="prefetch" href="/assets/js/396.780d6efe.js"><link rel="prefetch" href="/assets/js/397.cb686f39.js"><link rel="prefetch" href="/assets/js/398.c4ad669f.js"><link rel="prefetch" href="/assets/js/399.ee8d28ad.js"><link rel="prefetch" href="/assets/js/4.c1dcb1a7.js"><link rel="prefetch" href="/assets/js/40.4216f4f9.js"><link rel="prefetch" href="/assets/js/400.23d48a38.js"><link rel="prefetch" href="/assets/js/401.319d7a68.js"><link rel="prefetch" href="/assets/js/402.25b27bd0.js"><link rel="prefetch" href="/assets/js/403.9a898a40.js"><link rel="prefetch" href="/assets/js/404.e3b49b79.js"><link rel="prefetch" href="/assets/js/405.7695b9f1.js"><link rel="prefetch" href="/assets/js/406.edb801f7.js"><link rel="prefetch" href="/assets/js/407.03c3f725.js"><link rel="prefetch" href="/assets/js/408.4345ef1f.js"><link rel="prefetch" href="/assets/js/409.77c34447.js"><link rel="prefetch" href="/assets/js/41.f035663a.js"><link rel="prefetch" href="/assets/js/410.7f6c0744.js"><link rel="prefetch" href="/assets/js/411.cb19323e.js"><link rel="prefetch" href="/assets/js/412.4b16959d.js"><link rel="prefetch" href="/assets/js/413.ff4f1ca2.js"><link rel="prefetch" href="/assets/js/414.b1ca1298.js"><link rel="prefetch" href="/assets/js/415.c2111593.js"><link rel="prefetch" href="/assets/js/416.a6d18039.js"><link rel="prefetch" href="/assets/js/417.dc36c66d.js"><link rel="prefetch" href="/assets/js/418.e7eba879.js"><link rel="prefetch" href="/assets/js/419.57673b9e.js"><link rel="prefetch" href="/assets/js/42.9c8cf569.js"><link rel="prefetch" href="/assets/js/420.ccd41fe0.js"><link rel="prefetch" href="/assets/js/421.ea69f0b0.js"><link rel="prefetch" href="/assets/js/422.093448e2.js"><link rel="prefetch" href="/assets/js/423.ae003f31.js"><link rel="prefetch" href="/assets/js/424.f670cd2b.js"><link rel="prefetch" href="/assets/js/425.6e814335.js"><link rel="prefetch" href="/assets/js/426.faf45206.js"><link rel="prefetch" href="/assets/js/427.cf6be942.js"><link rel="prefetch" href="/assets/js/428.9ff6199c.js"><link rel="prefetch" href="/assets/js/429.b6ef4678.js"><link rel="prefetch" href="/assets/js/43.717fe06b.js"><link rel="prefetch" href="/assets/js/430.e9575d07.js"><link rel="prefetch" href="/assets/js/431.8bf26a3e.js"><link rel="prefetch" href="/assets/js/432.5eaa2162.js"><link rel="prefetch" href="/assets/js/433.6dab12a1.js"><link rel="prefetch" href="/assets/js/434.fca918e8.js"><link rel="prefetch" href="/assets/js/435.4c8f9ad9.js"><link rel="prefetch" href="/assets/js/436.0f0de1a8.js"><link rel="prefetch" href="/assets/js/437.2221ab9f.js"><link rel="prefetch" href="/assets/js/438.37f28cfb.js"><link rel="prefetch" href="/assets/js/439.1e3f3611.js"><link rel="prefetch" href="/assets/js/44.705dc411.js"><link rel="prefetch" href="/assets/js/440.28ab35e8.js"><link rel="prefetch" href="/assets/js/441.8d006af8.js"><link rel="prefetch" href="/assets/js/442.2618a6e3.js"><link rel="prefetch" href="/assets/js/443.a7723674.js"><link rel="prefetch" href="/assets/js/444.18f23e7c.js"><link rel="prefetch" href="/assets/js/445.f4807c5a.js"><link rel="prefetch" href="/assets/js/446.77a5afc2.js"><link rel="prefetch" href="/assets/js/447.7f653483.js"><link rel="prefetch" href="/assets/js/448.1143c566.js"><link rel="prefetch" href="/assets/js/449.b788a288.js"><link rel="prefetch" href="/assets/js/45.6a225373.js"><link rel="prefetch" href="/assets/js/450.b6463ba3.js"><link rel="prefetch" href="/assets/js/451.fd4d46b9.js"><link rel="prefetch" href="/assets/js/452.e8de4fc2.js"><link rel="prefetch" href="/assets/js/453.4125e5e6.js"><link rel="prefetch" href="/assets/js/454.30af5d0a.js"><link rel="prefetch" href="/assets/js/455.9c919e58.js"><link rel="prefetch" href="/assets/js/456.22dbfa8f.js"><link rel="prefetch" href="/assets/js/457.e9c5248a.js"><link rel="prefetch" href="/assets/js/458.c0a9cf1d.js"><link rel="prefetch" href="/assets/js/459.b5e96042.js"><link rel="prefetch" href="/assets/js/46.515d085a.js"><link rel="prefetch" href="/assets/js/460.b4097efb.js"><link rel="prefetch" href="/assets/js/461.5d545741.js"><link rel="prefetch" href="/assets/js/462.402d4cdd.js"><link rel="prefetch" href="/assets/js/463.e6d6ea07.js"><link rel="prefetch" href="/assets/js/464.df817445.js"><link rel="prefetch" href="/assets/js/465.18a6bc2b.js"><link rel="prefetch" href="/assets/js/466.da313c0c.js"><link rel="prefetch" href="/assets/js/467.41294182.js"><link rel="prefetch" href="/assets/js/468.41c59467.js"><link rel="prefetch" href="/assets/js/469.d55da13c.js"><link rel="prefetch" href="/assets/js/47.a41193df.js"><link rel="prefetch" href="/assets/js/470.7457a92e.js"><link rel="prefetch" href="/assets/js/471.ed739bdf.js"><link rel="prefetch" href="/assets/js/472.83882459.js"><link rel="prefetch" href="/assets/js/473.fe2df51c.js"><link rel="prefetch" href="/assets/js/474.d40797b8.js"><link rel="prefetch" href="/assets/js/475.a00992a2.js"><link rel="prefetch" href="/assets/js/476.c7687189.js"><link rel="prefetch" href="/assets/js/477.fd4fd227.js"><link rel="prefetch" href="/assets/js/478.1ae08c3b.js"><link rel="prefetch" href="/assets/js/479.04a246c6.js"><link rel="prefetch" href="/assets/js/48.fe693306.js"><link rel="prefetch" href="/assets/js/480.36acb4ff.js"><link rel="prefetch" href="/assets/js/481.05d3129e.js"><link rel="prefetch" href="/assets/js/482.1741a02c.js"><link rel="prefetch" href="/assets/js/483.44cf2d25.js"><link rel="prefetch" href="/assets/js/484.9c14e5c6.js"><link rel="prefetch" href="/assets/js/485.ea0c1de1.js"><link rel="prefetch" href="/assets/js/486.8c683697.js"><link rel="prefetch" href="/assets/js/487.8b1eb604.js"><link rel="prefetch" href="/assets/js/488.ae16fca6.js"><link rel="prefetch" href="/assets/js/489.7f674a0d.js"><link rel="prefetch" href="/assets/js/49.a7d05a3d.js"><link rel="prefetch" href="/assets/js/490.52983854.js"><link rel="prefetch" href="/assets/js/491.968e7af4.js"><link rel="prefetch" href="/assets/js/492.e7f58bac.js"><link rel="prefetch" href="/assets/js/493.55afbb68.js"><link rel="prefetch" href="/assets/js/494.ac17d05b.js"><link rel="prefetch" href="/assets/js/495.d1ca2a12.js"><link rel="prefetch" href="/assets/js/496.d6841a0e.js"><link rel="prefetch" href="/assets/js/497.99431b4b.js"><link rel="prefetch" href="/assets/js/498.cacac1d8.js"><link rel="prefetch" href="/assets/js/499.c6b7fab0.js"><link rel="prefetch" href="/assets/js/5.f74a04c4.js"><link rel="prefetch" href="/assets/js/50.f59b29ea.js"><link rel="prefetch" href="/assets/js/500.abba24c7.js"><link rel="prefetch" href="/assets/js/501.e9496674.js"><link rel="prefetch" href="/assets/js/502.3ece0e86.js"><link rel="prefetch" href="/assets/js/503.974421d1.js"><link rel="prefetch" href="/assets/js/504.6e8d8539.js"><link rel="prefetch" href="/assets/js/505.b8161483.js"><link rel="prefetch" href="/assets/js/506.a6a6f2de.js"><link rel="prefetch" href="/assets/js/507.9c6955ee.js"><link rel="prefetch" href="/assets/js/508.223e145d.js"><link rel="prefetch" href="/assets/js/509.553e6f2c.js"><link rel="prefetch" href="/assets/js/51.428c5495.js"><link rel="prefetch" href="/assets/js/510.46e2eab7.js"><link rel="prefetch" href="/assets/js/511.24962b3f.js"><link rel="prefetch" href="/assets/js/512.a29fe236.js"><link rel="prefetch" href="/assets/js/513.8729b339.js"><link rel="prefetch" href="/assets/js/514.41199019.js"><link rel="prefetch" href="/assets/js/515.b1a71e99.js"><link rel="prefetch" href="/assets/js/516.001e3634.js"><link rel="prefetch" href="/assets/js/517.4de05581.js"><link rel="prefetch" href="/assets/js/518.57697c31.js"><link rel="prefetch" href="/assets/js/519.e962365e.js"><link rel="prefetch" href="/assets/js/52.c97c3911.js"><link rel="prefetch" href="/assets/js/520.e7775961.js"><link rel="prefetch" href="/assets/js/521.05b0ce57.js"><link rel="prefetch" href="/assets/js/522.49f7412e.js"><link rel="prefetch" href="/assets/js/523.b3d821b2.js"><link rel="prefetch" href="/assets/js/524.ab2395b7.js"><link rel="prefetch" href="/assets/js/525.25559bb4.js"><link rel="prefetch" href="/assets/js/526.23111d2a.js"><link rel="prefetch" href="/assets/js/527.c61f6e86.js"><link rel="prefetch" href="/assets/js/528.032fa7b6.js"><link rel="prefetch" href="/assets/js/529.3953f346.js"><link rel="prefetch" href="/assets/js/53.77f22b1a.js"><link rel="prefetch" href="/assets/js/530.b882066e.js"><link rel="prefetch" href="/assets/js/531.62dddf23.js"><link rel="prefetch" href="/assets/js/532.1826fe1a.js"><link rel="prefetch" href="/assets/js/533.a2e014bb.js"><link rel="prefetch" href="/assets/js/534.d5d89c00.js"><link rel="prefetch" href="/assets/js/535.4e5d7739.js"><link rel="prefetch" href="/assets/js/536.f2c700db.js"><link rel="prefetch" href="/assets/js/537.80aa278c.js"><link rel="prefetch" href="/assets/js/538.95e2f471.js"><link rel="prefetch" href="/assets/js/539.4e4ecfe8.js"><link rel="prefetch" href="/assets/js/54.d85b2f2e.js"><link rel="prefetch" href="/assets/js/540.00bd44e5.js"><link rel="prefetch" href="/assets/js/541.d740df14.js"><link rel="prefetch" href="/assets/js/542.5aadeaee.js"><link rel="prefetch" href="/assets/js/543.d42c9d9a.js"><link rel="prefetch" href="/assets/js/544.29704685.js"><link rel="prefetch" href="/assets/js/545.7fdb1a83.js"><link rel="prefetch" href="/assets/js/546.6b5655ea.js"><link rel="prefetch" href="/assets/js/547.c98e27c4.js"><link rel="prefetch" href="/assets/js/548.8edec06f.js"><link rel="prefetch" href="/assets/js/549.33b8eae3.js"><link rel="prefetch" href="/assets/js/55.80a4fa71.js"><link rel="prefetch" href="/assets/js/550.cb706b0e.js"><link rel="prefetch" href="/assets/js/551.79598cc6.js"><link rel="prefetch" href="/assets/js/552.69aa5f8b.js"><link rel="prefetch" href="/assets/js/553.7ccb8831.js"><link rel="prefetch" href="/assets/js/554.954013b2.js"><link rel="prefetch" href="/assets/js/555.960d7f8b.js"><link rel="prefetch" href="/assets/js/556.5c054c14.js"><link rel="prefetch" href="/assets/js/557.890045ea.js"><link rel="prefetch" href="/assets/js/558.f72f6668.js"><link rel="prefetch" href="/assets/js/559.452d8ff3.js"><link rel="prefetch" href="/assets/js/56.009b0340.js"><link rel="prefetch" href="/assets/js/560.1656e33f.js"><link rel="prefetch" href="/assets/js/561.bb4650eb.js"><link rel="prefetch" href="/assets/js/562.7322fd81.js"><link rel="prefetch" href="/assets/js/563.a34a68ea.js"><link rel="prefetch" href="/assets/js/564.6da92e18.js"><link rel="prefetch" href="/assets/js/565.01d288e5.js"><link rel="prefetch" href="/assets/js/566.6a3459a1.js"><link rel="prefetch" href="/assets/js/567.e3eb8e54.js"><link rel="prefetch" href="/assets/js/568.f95e0fba.js"><link rel="prefetch" href="/assets/js/569.a42d134c.js"><link rel="prefetch" href="/assets/js/57.25e8dd1c.js"><link rel="prefetch" href="/assets/js/570.87887d15.js"><link rel="prefetch" href="/assets/js/571.ce4b478b.js"><link rel="prefetch" href="/assets/js/572.634418a6.js"><link rel="prefetch" href="/assets/js/573.cd4cf02b.js"><link rel="prefetch" href="/assets/js/574.8bf073fa.js"><link rel="prefetch" href="/assets/js/575.c194dddb.js"><link rel="prefetch" href="/assets/js/576.7750193f.js"><link rel="prefetch" href="/assets/js/577.5daa388a.js"><link rel="prefetch" href="/assets/js/578.54bb0029.js"><link rel="prefetch" href="/assets/js/579.92f58c76.js"><link rel="prefetch" href="/assets/js/58.9c1eb9e5.js"><link rel="prefetch" href="/assets/js/580.0e543efb.js"><link rel="prefetch" href="/assets/js/581.4e0b0b47.js"><link rel="prefetch" href="/assets/js/582.8c172f83.js"><link rel="prefetch" href="/assets/js/583.c91c43e0.js"><link rel="prefetch" href="/assets/js/584.ca68d52b.js"><link rel="prefetch" href="/assets/js/585.663b17d3.js"><link rel="prefetch" href="/assets/js/586.9494847d.js"><link rel="prefetch" href="/assets/js/587.f3805773.js"><link rel="prefetch" href="/assets/js/588.8ae14be1.js"><link rel="prefetch" href="/assets/js/589.b4af88be.js"><link rel="prefetch" href="/assets/js/59.2a730e41.js"><link rel="prefetch" href="/assets/js/590.fb77fea8.js"><link rel="prefetch" href="/assets/js/591.a3aaa57c.js"><link rel="prefetch" href="/assets/js/592.54ec5f32.js"><link rel="prefetch" href="/assets/js/593.96eab5cb.js"><link rel="prefetch" href="/assets/js/594.e356725c.js"><link rel="prefetch" href="/assets/js/595.0a2c4ad4.js"><link rel="prefetch" href="/assets/js/596.2c075cd8.js"><link rel="prefetch" href="/assets/js/597.e904811b.js"><link rel="prefetch" href="/assets/js/598.f6ca8b71.js"><link rel="prefetch" href="/assets/js/599.ae3d12c4.js"><link rel="prefetch" href="/assets/js/6.451e012f.js"><link rel="prefetch" href="/assets/js/60.e6b60343.js"><link rel="prefetch" href="/assets/js/600.e71a0062.js"><link rel="prefetch" href="/assets/js/601.2571a19d.js"><link rel="prefetch" href="/assets/js/602.0f4fa961.js"><link rel="prefetch" href="/assets/js/603.d8387c37.js"><link rel="prefetch" href="/assets/js/604.69433906.js"><link rel="prefetch" href="/assets/js/605.1bc7d87a.js"><link rel="prefetch" href="/assets/js/606.ec419517.js"><link rel="prefetch" href="/assets/js/607.b473fb0b.js"><link rel="prefetch" href="/assets/js/608.a361b48c.js"><link rel="prefetch" href="/assets/js/609.9186f226.js"><link rel="prefetch" href="/assets/js/61.d50a156d.js"><link rel="prefetch" href="/assets/js/610.ff3cf241.js"><link rel="prefetch" href="/assets/js/611.c3c7e648.js"><link rel="prefetch" href="/assets/js/612.2a520ebd.js"><link rel="prefetch" href="/assets/js/613.42936ffc.js"><link rel="prefetch" href="/assets/js/614.3ca0de21.js"><link rel="prefetch" href="/assets/js/615.ecf60a47.js"><link rel="prefetch" href="/assets/js/616.17185e83.js"><link rel="prefetch" href="/assets/js/617.769d4cdf.js"><link rel="prefetch" href="/assets/js/618.015c6376.js"><link rel="prefetch" href="/assets/js/619.3af186d0.js"><link rel="prefetch" href="/assets/js/62.e24b7811.js"><link rel="prefetch" href="/assets/js/620.f8ff3784.js"><link rel="prefetch" href="/assets/js/621.4c21311f.js"><link rel="prefetch" href="/assets/js/622.355178df.js"><link rel="prefetch" href="/assets/js/623.45a30695.js"><link rel="prefetch" href="/assets/js/624.61e89d34.js"><link rel="prefetch" href="/assets/js/625.49e0d1ce.js"><link rel="prefetch" href="/assets/js/626.1b7ae767.js"><link rel="prefetch" href="/assets/js/627.b8c507cf.js"><link rel="prefetch" href="/assets/js/628.c5a43517.js"><link rel="prefetch" href="/assets/js/629.274eb0fd.js"><link rel="prefetch" href="/assets/js/63.b804baab.js"><link rel="prefetch" href="/assets/js/630.69e055ce.js"><link rel="prefetch" href="/assets/js/631.0892fc51.js"><link rel="prefetch" href="/assets/js/632.6a68e9a2.js"><link rel="prefetch" href="/assets/js/633.d536fe74.js"><link rel="prefetch" href="/assets/js/634.24695f39.js"><link rel="prefetch" href="/assets/js/635.3aeede9c.js"><link rel="prefetch" href="/assets/js/636.3628d8a6.js"><link rel="prefetch" href="/assets/js/637.40af5a79.js"><link rel="prefetch" href="/assets/js/638.15e257ae.js"><link rel="prefetch" href="/assets/js/639.31e6597c.js"><link rel="prefetch" href="/assets/js/64.eb5699ff.js"><link rel="prefetch" href="/assets/js/640.a071f6df.js"><link rel="prefetch" href="/assets/js/641.f9edd7bf.js"><link rel="prefetch" href="/assets/js/642.adcb583f.js"><link rel="prefetch" href="/assets/js/643.7c98a990.js"><link rel="prefetch" href="/assets/js/644.fb1213d8.js"><link rel="prefetch" href="/assets/js/645.220a5034.js"><link rel="prefetch" href="/assets/js/646.d66a419b.js"><link rel="prefetch" href="/assets/js/647.12ef89ab.js"><link rel="prefetch" href="/assets/js/648.a3112300.js"><link rel="prefetch" href="/assets/js/649.f457dfa5.js"><link rel="prefetch" href="/assets/js/65.0d8501b5.js"><link rel="prefetch" href="/assets/js/650.cc63d03b.js"><link rel="prefetch" href="/assets/js/651.16d1bbd6.js"><link rel="prefetch" href="/assets/js/652.0f5343f0.js"><link rel="prefetch" href="/assets/js/653.28f7710a.js"><link rel="prefetch" href="/assets/js/654.b343d473.js"><link rel="prefetch" href="/assets/js/655.215fe67b.js"><link rel="prefetch" href="/assets/js/656.79aa1653.js"><link rel="prefetch" href="/assets/js/657.c57f2b5c.js"><link rel="prefetch" href="/assets/js/658.d0aa0b95.js"><link rel="prefetch" href="/assets/js/659.2dfaed93.js"><link rel="prefetch" href="/assets/js/66.8361cc16.js"><link rel="prefetch" href="/assets/js/660.c00b347e.js"><link rel="prefetch" href="/assets/js/661.ecc4f968.js"><link rel="prefetch" href="/assets/js/662.06f83919.js"><link rel="prefetch" href="/assets/js/663.67d8849e.js"><link rel="prefetch" href="/assets/js/664.74dba1a9.js"><link rel="prefetch" href="/assets/js/665.28b450f0.js"><link rel="prefetch" href="/assets/js/666.0f4bb6ba.js"><link rel="prefetch" href="/assets/js/667.586074e3.js"><link rel="prefetch" href="/assets/js/668.b13c0e70.js"><link rel="prefetch" href="/assets/js/669.9d0d4cbc.js"><link rel="prefetch" href="/assets/js/67.37f46ba2.js"><link rel="prefetch" href="/assets/js/670.6b36ca72.js"><link rel="prefetch" href="/assets/js/671.33b2e754.js"><link rel="prefetch" href="/assets/js/672.3b02c287.js"><link rel="prefetch" href="/assets/js/673.3f274929.js"><link rel="prefetch" href="/assets/js/674.7d75584f.js"><link rel="prefetch" href="/assets/js/675.0de52334.js"><link rel="prefetch" href="/assets/js/676.6734133e.js"><link rel="prefetch" href="/assets/js/677.c6f4a973.js"><link rel="prefetch" href="/assets/js/678.1344b6be.js"><link rel="prefetch" href="/assets/js/679.23fed56f.js"><link rel="prefetch" href="/assets/js/68.27dbce5b.js"><link rel="prefetch" href="/assets/js/680.c49329d6.js"><link rel="prefetch" href="/assets/js/681.8df66615.js"><link rel="prefetch" href="/assets/js/682.77b4bff8.js"><link rel="prefetch" href="/assets/js/683.6cf41cf4.js"><link rel="prefetch" href="/assets/js/684.58deecd5.js"><link rel="prefetch" href="/assets/js/685.d2f7480e.js"><link rel="prefetch" href="/assets/js/686.0b77a241.js"><link rel="prefetch" href="/assets/js/687.2cc04b4f.js"><link rel="prefetch" href="/assets/js/688.da24cbae.js"><link rel="prefetch" href="/assets/js/689.a9961f74.js"><link rel="prefetch" href="/assets/js/69.8052a977.js"><link rel="prefetch" href="/assets/js/690.cb736269.js"><link rel="prefetch" href="/assets/js/691.21c13be1.js"><link rel="prefetch" href="/assets/js/692.3ed557d0.js"><link rel="prefetch" href="/assets/js/693.066efe93.js"><link rel="prefetch" href="/assets/js/694.5368f98a.js"><link rel="prefetch" href="/assets/js/695.4fdb93d5.js"><link rel="prefetch" href="/assets/js/696.9c055ac6.js"><link rel="prefetch" href="/assets/js/697.51e0c47c.js"><link rel="prefetch" href="/assets/js/698.08ca1dbd.js"><link rel="prefetch" href="/assets/js/699.ce7e9e2a.js"><link rel="prefetch" href="/assets/js/7.7e21c947.js"><link rel="prefetch" href="/assets/js/70.19faeb78.js"><link rel="prefetch" href="/assets/js/700.3676fa7f.js"><link rel="prefetch" href="/assets/js/701.82db4887.js"><link rel="prefetch" href="/assets/js/702.73425f22.js"><link rel="prefetch" href="/assets/js/703.d9391c74.js"><link rel="prefetch" href="/assets/js/704.d6e275cf.js"><link rel="prefetch" href="/assets/js/705.d2f23969.js"><link rel="prefetch" href="/assets/js/706.1c66dcc1.js"><link rel="prefetch" href="/assets/js/707.0fc5a26a.js"><link rel="prefetch" href="/assets/js/708.97471ee6.js"><link rel="prefetch" href="/assets/js/709.9b4d5665.js"><link rel="prefetch" href="/assets/js/71.d1683810.js"><link rel="prefetch" href="/assets/js/710.75fa8103.js"><link rel="prefetch" href="/assets/js/711.43777b40.js"><link rel="prefetch" href="/assets/js/712.5c583e39.js"><link rel="prefetch" href="/assets/js/713.5aa72111.js"><link rel="prefetch" href="/assets/js/714.e8215702.js"><link rel="prefetch" href="/assets/js/715.46614e7c.js"><link rel="prefetch" href="/assets/js/716.eaac6d69.js"><link rel="prefetch" href="/assets/js/717.c344c042.js"><link rel="prefetch" href="/assets/js/718.437bf0b2.js"><link rel="prefetch" href="/assets/js/719.23aa3deb.js"><link rel="prefetch" href="/assets/js/72.9fa783f0.js"><link rel="prefetch" href="/assets/js/720.9456a449.js"><link rel="prefetch" href="/assets/js/721.67fd324a.js"><link rel="prefetch" href="/assets/js/722.fc5e79ca.js"><link rel="prefetch" href="/assets/js/723.46db8115.js"><link rel="prefetch" href="/assets/js/724.31a11b8c.js"><link rel="prefetch" href="/assets/js/725.49cef603.js"><link rel="prefetch" href="/assets/js/726.7d0a2e7f.js"><link rel="prefetch" href="/assets/js/727.a1de6f02.js"><link rel="prefetch" href="/assets/js/728.7e0a727e.js"><link rel="prefetch" href="/assets/js/729.b6bf04fa.js"><link rel="prefetch" href="/assets/js/73.1ac0ac37.js"><link rel="prefetch" href="/assets/js/730.1c102528.js"><link rel="prefetch" href="/assets/js/731.80403e3d.js"><link rel="prefetch" href="/assets/js/732.cf8b4a6d.js"><link rel="prefetch" href="/assets/js/733.aab88d38.js"><link rel="prefetch" href="/assets/js/734.965a0adc.js"><link rel="prefetch" href="/assets/js/735.f9d33608.js"><link rel="prefetch" href="/assets/js/736.d1621f9e.js"><link rel="prefetch" href="/assets/js/737.a12ea0d3.js"><link rel="prefetch" href="/assets/js/738.96e61512.js"><link rel="prefetch" href="/assets/js/739.9bce4dfe.js"><link rel="prefetch" href="/assets/js/74.1913daec.js"><link rel="prefetch" href="/assets/js/740.c1a0bf7b.js"><link rel="prefetch" href="/assets/js/741.0185115e.js"><link rel="prefetch" href="/assets/js/742.21e99d78.js"><link rel="prefetch" href="/assets/js/743.e5f2407e.js"><link rel="prefetch" href="/assets/js/744.53d4e25a.js"><link rel="prefetch" href="/assets/js/745.9fb6722c.js"><link rel="prefetch" href="/assets/js/746.893e3a2f.js"><link rel="prefetch" href="/assets/js/747.ad94fed4.js"><link rel="prefetch" href="/assets/js/748.3421b09b.js"><link rel="prefetch" href="/assets/js/749.15c364e9.js"><link rel="prefetch" href="/assets/js/75.d63a9540.js"><link rel="prefetch" href="/assets/js/750.4e5379b7.js"><link rel="prefetch" href="/assets/js/751.18b0273f.js"><link rel="prefetch" href="/assets/js/752.24717596.js"><link rel="prefetch" href="/assets/js/753.5868bcc4.js"><link rel="prefetch" href="/assets/js/754.77808a6c.js"><link rel="prefetch" href="/assets/js/755.af7f7a71.js"><link rel="prefetch" href="/assets/js/76.342d837c.js"><link rel="prefetch" href="/assets/js/77.466349c3.js"><link rel="prefetch" href="/assets/js/78.886d05b6.js"><link rel="prefetch" href="/assets/js/79.b478bdab.js"><link rel="prefetch" href="/assets/js/8.9f40767d.js"><link rel="prefetch" href="/assets/js/80.9205cc43.js"><link rel="prefetch" href="/assets/js/81.77f831c9.js"><link rel="prefetch" href="/assets/js/82.650475d1.js"><link rel="prefetch" href="/assets/js/83.aa7e3d4b.js"><link rel="prefetch" href="/assets/js/84.2fc92fb4.js"><link rel="prefetch" href="/assets/js/85.0f633e10.js"><link rel="prefetch" href="/assets/js/86.e862f4bc.js"><link rel="prefetch" href="/assets/js/87.8a869468.js"><link rel="prefetch" href="/assets/js/88.6c584051.js"><link rel="prefetch" href="/assets/js/89.3ab84e02.js"><link rel="prefetch" href="/assets/js/9.7ed864ce.js"><link rel="prefetch" href="/assets/js/90.41e6925d.js"><link rel="prefetch" href="/assets/js/91.55055993.js"><link rel="prefetch" href="/assets/js/92.ced7b439.js"><link rel="prefetch" href="/assets/js/93.41cc8a7f.js"><link rel="prefetch" href="/assets/js/94.6d2b144f.js"><link rel="prefetch" href="/assets/js/95.399a7909.js"><link rel="prefetch" href="/assets/js/96.556f8f9f.js"><link rel="prefetch" href="/assets/js/97.47ecdf46.js"><link rel="prefetch" href="/assets/js/98.fdbe6822.js"><link rel="prefetch" href="/assets/js/99.db8442e4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6ece31e0.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Fanx 知识库" class="logo"> <span class="site-name can-hide">Fanx 知识库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/779590/" class="nav-link">Java基础</a></li><li class="dropdown-item"><!----> <a href="/pages/dc7834/" class="nav-link">Java集合框架</a></li><li class="dropdown-item"><!----> <a href="/pages/f2d7db/" class="nav-link">Java多线程并发</a></li><li class="dropdown-item"><!----> <a href="/pages/dbec4d/" class="nav-link">JavaIo&amp;NIO&amp;AIO</a></li><li class="dropdown-item"><!----> <a href="/pages/b908ce/" class="nav-link">JDK相关特性</a></li><li class="dropdown-item"><!----> <a href="/pages/e59bea/" class="nav-link">JVM相关</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f8c059/" class="nav-link">数据库基础知识</a></li><li class="dropdown-item"><!----> <a href="/pages/d192fd/" class="nav-link">Mysql</a></li><li class="dropdown-item"><!----> <a href="/pages/8aa877/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/077e7c/" class="nav-link">MogoDb</a></li><li class="dropdown-item"><!----> <a href="/pages/68281b/" class="nav-link">ElasticSearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用框架" class="dropdown-title"><!----> <span class="title" style="display:;">常用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/commonFrameworks/mybatis/" class="nav-link">mybatis</a></li><li class="dropdown-item"><!----> <a href="/pages/8f6500/" class="nav-link">Spring Framework 5基础</a></li><li class="dropdown-item"><!----> <a href="/pages/7c08d4/" class="nav-link">SpringBoot 2.5.x系列</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源代码学习" class="dropdown-title"><!----> <span class="title" style="display:;">源代码学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/23a632/" class="nav-link">mybatis源码学习</a></li><li class="dropdown-item"><!----> <a href="/sourceCode/java/" class="nav-link">java源代码</a></li><li class="dropdown-item"><!----> <a href="/sourceCode/spring/" class="nav-link">Spring源码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试相关" class="dropdown-title"><!----> <span class="title" style="display:;">面试相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/2cef48/" class="nav-link">Java 基础</a></li><li class="dropdown-item"><!----> <a href="/pages/ad2692/" class="nav-link">Spring 框架</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用的技术工具" class="dropdown-title"><!----> <span class="title" style="display:;">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tool/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/linux/common/" class="nav-link">linux常用命令实践</a></li><li class="dropdown-item"><!----> <a href="/tool/maven/" class="nav-link">Mavan</a></li><li class="dropdown-item"><!----> <a href="/pages/b25802/" class="nav-link">开发工具详解</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它语言" class="dropdown-title"><!----> <span class="title" style="display:;">其它语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fc414d/" class="nav-link">Python基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="问题总结" class="dropdown-title"><!----> <span class="title" style="display:;">问题总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/question/redis/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/pages/4d0fa7/" class="nav-link">团队相关</a></li><li class="dropdown-item"><!----> <a href="/pages/75c3d7/" class="nav-link">fanx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><!----> <span class="title" style="display:;">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/caf303/" class="nav-link">数据结构基础</a></li><li class="dropdown-item"><!----> <a href="/pages/395e23/" class="nav-link">常见排序算法</a></li><li class="dropdown-item"><!----> <a href="/pages/fa3dd3/" class="nav-link">算法思想</a></li><li class="dropdown-item"><!----> <a href="/pages/79d342/" class="nav-link">一些领域算法</a></li><li class="dropdown-item"><!----> <a href="/pages/fdb54d/" class="nav-link">其它算法相关</a></li></ul></div></div> <a href="https://fanxgit.github.io/fanxNotes/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/779590/" class="nav-link">Java基础</a></li><li class="dropdown-item"><!----> <a href="/pages/dc7834/" class="nav-link">Java集合框架</a></li><li class="dropdown-item"><!----> <a href="/pages/f2d7db/" class="nav-link">Java多线程并发</a></li><li class="dropdown-item"><!----> <a href="/pages/dbec4d/" class="nav-link">JavaIo&amp;NIO&amp;AIO</a></li><li class="dropdown-item"><!----> <a href="/pages/b908ce/" class="nav-link">JDK相关特性</a></li><li class="dropdown-item"><!----> <a href="/pages/e59bea/" class="nav-link">JVM相关</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f8c059/" class="nav-link">数据库基础知识</a></li><li class="dropdown-item"><!----> <a href="/pages/d192fd/" class="nav-link">Mysql</a></li><li class="dropdown-item"><!----> <a href="/pages/8aa877/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/077e7c/" class="nav-link">MogoDb</a></li><li class="dropdown-item"><!----> <a href="/pages/68281b/" class="nav-link">ElasticSearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用框架" class="dropdown-title"><!----> <span class="title" style="display:;">常用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/commonFrameworks/mybatis/" class="nav-link">mybatis</a></li><li class="dropdown-item"><!----> <a href="/pages/8f6500/" class="nav-link">Spring Framework 5基础</a></li><li class="dropdown-item"><!----> <a href="/pages/7c08d4/" class="nav-link">SpringBoot 2.5.x系列</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源代码学习" class="dropdown-title"><!----> <span class="title" style="display:;">源代码学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/23a632/" class="nav-link">mybatis源码学习</a></li><li class="dropdown-item"><!----> <a href="/sourceCode/java/" class="nav-link">java源代码</a></li><li class="dropdown-item"><!----> <a href="/sourceCode/spring/" class="nav-link">Spring源码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试相关" class="dropdown-title"><!----> <span class="title" style="display:;">面试相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/2cef48/" class="nav-link">Java 基础</a></li><li class="dropdown-item"><!----> <a href="/pages/ad2692/" class="nav-link">Spring 框架</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用的技术工具" class="dropdown-title"><!----> <span class="title" style="display:;">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tool/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/linux/common/" class="nav-link">linux常用命令实践</a></li><li class="dropdown-item"><!----> <a href="/tool/maven/" class="nav-link">Mavan</a></li><li class="dropdown-item"><!----> <a href="/pages/b25802/" class="nav-link">开发工具详解</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它语言" class="dropdown-title"><!----> <span class="title" style="display:;">其它语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fc414d/" class="nav-link">Python基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="问题总结" class="dropdown-title"><!----> <span class="title" style="display:;">问题总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/question/redis/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/pages/4d0fa7/" class="nav-link">团队相关</a></li><li class="dropdown-item"><!----> <a href="/pages/75c3d7/" class="nav-link">fanx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><!----> <span class="title" style="display:;">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/caf303/" class="nav-link">数据结构基础</a></li><li class="dropdown-item"><!----> <a href="/pages/395e23/" class="nav-link">常见排序算法</a></li><li class="dropdown-item"><!----> <a href="/pages/fa3dd3/" class="nav-link">算法思想</a></li><li class="dropdown-item"><!----> <a href="/pages/79d342/" class="nav-link">一些领域算法</a></li><li class="dropdown-item"><!----> <a href="/pages/fdb54d/" class="nav-link">其它算法相关</a></li></ul></div></div> <a href="https://fanxgit.github.io/fanxNotes/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>mybatis</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/commonFrameworks/mybatis/" class="sidebar-link">mybatis入门</a></li><li><a href="/pages/55c7c2/" class="sidebar-link">xml配置文件</a></li><li><a href="/pages/939ab5/" aria-current="page" class="active sidebar-link">xml映射文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/939ab5/#select" class="sidebar-link">select</a></li><li class="sidebar-sub-header level2"><a href="/pages/939ab5/#insert-update-和-delete" class="sidebar-link">insert, update 和 delete</a></li><li class="sidebar-sub-header level2"><a href="/pages/939ab5/#sql" class="sidebar-link">sql</a></li><li class="sidebar-sub-header level2"><a href="/pages/939ab5/#parametertype-参数" class="sidebar-link">parameterType 参数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#mybatis-参数总结大全" class="sidebar-link">mybatis 参数总结大全</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#浅谈一下mybatis-参数处理源码" class="sidebar-link">浅谈一下mybatis 参数处理源码</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/939ab5/#字符串替换" class="sidebar-link">${}字符串替换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#、-区别" class="sidebar-link">#{}、${} 区别：</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/939ab5/#resultmap结果映射" class="sidebar-link">resultMap结果映射</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#高级结果映射" class="sidebar-link">高级结果映射</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#结果映射-resultmap" class="sidebar-link">结果映射（resultMap）</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#id-result" class="sidebar-link">id &amp; result</a></li><li class="sidebar-sub-header level4"><a href="/pages/939ab5/#支持的-jdbc-类型" class="sidebar-link">支持的 JDBC 类型</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#构造方法-constructor" class="sidebar-link">构造方法 constructor</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#关联-association-一对一" class="sidebar-link">关联 association 一对一</a></li><li class="sidebar-sub-header level4"><a href="/pages/939ab5/#关联的嵌套-select-查询" class="sidebar-link">关联的嵌套 Select 查询</a></li><li class="sidebar-sub-header level4"><a href="/pages/939ab5/#关联的嵌套结果映射" class="sidebar-link">关联的嵌套结果映射</a></li><li class="sidebar-sub-header level4"><a href="/pages/939ab5/#使用存储过程关联的多结果集-resultset" class="sidebar-link">使用存储过程关联的多结果集（ResultSet）</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#集合-collection-一对多" class="sidebar-link">集合 collection 一对多</a></li><li class="sidebar-sub-header level4"><a href="/pages/939ab5/#集合的嵌套-select-查询" class="sidebar-link">集合的嵌套 Select 查询</a></li><li class="sidebar-sub-header level4"><a href="/pages/939ab5/#集合的嵌套结果映射" class="sidebar-link">集合的嵌套结果映射</a></li><li class="sidebar-sub-header level4"><a href="/pages/939ab5/#使用存储过程集合的多结果集-resultset" class="sidebar-link">使用存储过程集合的多结果集（ResultSet）</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#鉴别器-discriminator" class="sidebar-link">鉴别器 discriminator</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/939ab5/#自动映射" class="sidebar-link">自动映射</a></li><li class="sidebar-sub-header level2"><a href="/pages/939ab5/#缓存" class="sidebar-link">缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#一级缓存-本地缓存" class="sidebar-link">一级缓存（本地缓存）：</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#二级缓存-全局缓存" class="sidebar-link">二级缓存（全局缓存）：</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#三级缓存-定制缓存" class="sidebar-link">三级缓存（定制缓存）：</a></li><li class="sidebar-sub-header level3"><a href="/pages/939ab5/#cache-ref" class="sidebar-link">cache-ref</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/939ab5/#mybatis-集成redis-做缓存" class="sidebar-link">mybatis 集成redis 做缓存</a></li></ul></li><li><a href="/pages/15becd/" class="sidebar-link">动态 SQL</a></li><li><a href="/pages/c7008d/" class="sidebar-link">Java API</a></li><li><a href="/pages/baedcb/" class="sidebar-link">SQL语句构建</a></li><li><a href="/pages/01fa30/" class="sidebar-link">mybatis日志</a></li><li><a href="/pages/fee5f9/" class="sidebar-link">mybatis集成spring+springmvc</a></li><li><a href="/pages/5e3dd6/" class="sidebar-link">mybaitsGennertate逆向工程</a></li><li><a href="/pages/605993/" class="sidebar-link">mybatis源码解析</a></li><li><a href="/pages/c164ed/" class="sidebar-link">ResultSetMetaData</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>poi</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>activiti7</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E5%B8%B8%E7%94%A8%E6%A1%86%E6%9E%B6" title="分类" data-v-06225672>常用框架</a></li><li data-v-06225672><a href="/categories/?category=mybatis" title="分类" data-v-06225672>mybatis</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/FanXGit" target="_blank" title="作者" class="beLink" data-v-06225672>fanx</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-06-28</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">xml映射文件<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="xml-映射器"><a href="#xml-映射器" class="header-anchor">#</a> XML 映射器</h1> <p>MyBatis 的真正强大在于它的语句映射，这是它的魔力所在。由于它的异常强大，映射器的 XML 文件就显得相对简单。如果拿它跟具有相同功能的 JDBC 代码进行对比，你会立即发现省掉了将近 95% 的代码。MyBatis 致力于减少使用成本，让用户能更专注于 SQL 代码。</p> <p>SQL 映射文件只有很少的几个顶级元素（按照应被定义的顺序列出）：</p> <table><thead><tr><th>元素名称</th> <th>元素含义</th></tr></thead> <tbody><tr><td>cache</td> <td>该命名空间的缓存配置</td></tr> <tr><td>cache-ref</td> <td>引用其它命名空间的缓存配置</td></tr> <tr><td>resultMap</td> <td>描述如何从数据库结果集中加载对象，是最复杂也是最强大的元素</td></tr> <tr><td><s>parameterMap</s></td> <td><s>老式风格的参数映射。此元素已被废弃，并可能在将来被移除！请使用行内参数映射。文档中不会介绍此元素。</s></td></tr> <tr><td>sql</td> <td>可被其它语句引用的可重用语句块</td></tr> <tr><td>insert</td> <td>映射插入语句</td></tr> <tr><td>update</td> <td>映射更新语句</td></tr> <tr><td>delete</td> <td>映射删除语句</td></tr> <tr><td>select</td> <td>映射查询语句</td></tr></tbody></table> <h2 id="select"><a href="#select" class="header-anchor">#</a> select</h2> <p>查询语句是 MyBatis 中最常用的元素之一 ---- 光能把数据存到数据库中价值并不大，还要能重新取出来才有用，多数应用也都是查询比修改要频繁。 MyBatis 的基本原则之一是：在每个插入、更新或删除操作之间，通常会执行多个查询操作。因此，MyBatis 在查询和结果映射做了相当多的改进。一个简单查询的 select 元素是非常简单的。比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectPerson&quot;</span> <span class="token assign-left variable">parameterType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;hashmap&quot;</span><span class="token operator">&gt;</span>
  SELECT * FROM PERSON WHERE ID <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这个语句名为 selectPerson，接受一个 int（或 Integer）类型的参数，并返回一个 HashMap 类型的对象，其中的键是列名，值便是结果行中的对应值。</p> <p>注意参数符号：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#{id}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这就告诉 MyBatis 创建一个预处理语句（PreparedStatement）参数，在 JDBC 中，这样的一个参数在 SQL 中会由一个“?”来标识，并被传递到一个新的预处理语句中，就像这样：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// 近似的 JDBC 代码，非 MyBatis 代码...
String selectPerson = &quot;SELECT * FROM PERSON WHERE ID=?&quot;;
PreparedStatement ps = conn.prepareStatement(selectPerson);
ps.setInt(1,id);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>当然，使用 JDBC 就意味着使用更多的代码，以便提取结果并将它们映射到对象实例中，而这就是 MyBatis 的拿手好戏。参数和结果映射的详细细节会分别在后面单独的小节中说明。</p> <p>select 元素允许你配置很多属性来配置每条语句的行为细节。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select
  <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectPerson&quot;</span>
  <span class="token assign-left variable">parameterType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span>
  <span class="token assign-left variable">parameterMap</span><span class="token operator">=</span><span class="token string">&quot;deprecated&quot;</span>
  <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;hashmap&quot;</span>
  <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;personResultMap&quot;</span>
  <span class="token assign-left variable">flushCache</span><span class="token operator">=</span><span class="token string">&quot;false&quot;</span>
  <span class="token assign-left variable">useCache</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
  <span class="token assign-left variable">timeout</span><span class="token operator">=</span><span class="token string">&quot;10&quot;</span>
  <span class="token assign-left variable">fetchSize</span><span class="token operator">=</span><span class="token string">&quot;256&quot;</span>
  <span class="token assign-left variable">statementType</span><span class="token operator">=</span><span class="token string">&quot;PREPARED&quot;</span>
  <span class="token assign-left variable">resultSetType</span><span class="token operator">=</span><span class="token string">&quot;FORWARD_ONLY&quot;</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Select 元素的属性</p> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>在命名空间中唯一的标识符，可以被用来引用这条语句。</td></tr> <tr><td>parameterType</td> <td>将会传入这条语句的参数的类全限定名或别名。这个属性是可选的，因为 MyBatis 可以根据语句中实际传入的参数计算出应该使用的类型处理器（TypeHandler），默认值为未设置（unset）。</td></tr> <tr><td><s>parameterMap</s></td> <td><s>将会传入这条语句的参数的类全限定名或别名。这个属性是可选的，因为 MyBatis 可以根据语句中实际传入的参数计算出应该使用的类型处理器（TypeHandler），默认值为未设置（unset）。</s></td></tr> <tr><td>resultType</td> <td>期望从这条语句中返回结果的类全限定名或别名。 注意，如果返回的是集合，那应该设置为集合包含的类型，而不是集合本身的类型。 resultType 和 resultMap 之间只能同时使用一个。</td></tr> <tr><td>resultMap</td> <td>对外部 resultMap 的命名引用。结果映射是 MyBatis 最强大的特性，如果你对其理解透彻，许多复杂的映射问题都能迎刃而解。 resultType 和 resultMap 之间只能同时使用一个。</td></tr> <tr><td>flushCache</td> <td>将其设置为 true 后，只要语句被调用，都会导致本地缓存和二级缓存被清空，默认值：false。</td></tr> <tr><td>useCache</td> <td>将其设置为 true 后，将会导致本条语句的结果被二级缓存缓存起来，默认值：对 select 元素为 true。</td></tr> <tr><td>timeout</td> <td>这个设置是在抛出异常之前，驱动程序等待数据库返回请求结果的秒数。默认值为未设置（unset）（依赖数据库驱动）。</td></tr> <tr><td>fetchSize</td> <td>这是一个给驱动的建议值，尝试让驱动程序每次批量返回的结果行数等于这个设置值。 默认值为未设置（unset）（依赖驱动）。</td></tr> <tr><td>statementType</td> <td>可选 STATEMENT，PREPARED 或 CALLABLE。这会让 MyBatis 分别使用 Statement，PreparedStatement 或 CallableStatement，默认值：PREPARED。</td></tr> <tr><td>resultSetType</td> <td>FORWARD_ONLY，SCROLL_SENSITIVE, SCROLL_INSENSITIVE 或 DEFAULT（等价于 unset） 中的一个，默认值为 unset （依赖数据库驱动）。</td></tr> <tr><td>databaseId</td> <td>如果配置了数据库厂商标识（databaseIdProvider），MyBatis 会加载所有不带 databaseId 或匹配当前 databaseId 的语句；如果带和不带的语句都有，则不带的会被忽略。</td></tr> <tr><td>resultOrdered</td> <td>这个设置仅针对嵌套结果 select 语句：如果为 true，则假设结果集以正确顺序（排序后）执行映射，当返回新的主结果行时，将不再发生对以前结果行的引用。 这样可以减少内存消耗。默认值：false。</td></tr> <tr><td>resultSets</td> <td>这个设置仅适用于多结果集的情况。它将列出语句执行后返回的结果集并赋予每个结果集一个名称，多个名称之间以逗号分隔。</td></tr> <tr><td>affectData</td> <td>Set this to true when writing a INSERT, UPDATE or DELETE statement that returns data so that the transaction is controlled properly. Also see Transaction Control Method. Default: false (since 3.5.12)</td></tr></tbody></table> <h2 id="insert-update-和-delete"><a href="#insert-update-和-delete" class="header-anchor">#</a> insert, update 和 delete</h2> <p>数据变更语句 insert，update 和 delete 的实现非常接近：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>insert
  <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;insertAuthor&quot;</span>
  <span class="token assign-left variable">parameterType</span><span class="token operator">=</span><span class="token string">&quot;domain.blog.Author&quot;</span>
  <span class="token assign-left variable">flushCache</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
  <span class="token assign-left variable">statementType</span><span class="token operator">=</span><span class="token string">&quot;PREPARED&quot;</span>
  <span class="token assign-left variable">keyProperty</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
  <span class="token assign-left variable">keyColumn</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
  <span class="token assign-left variable">useGeneratedKeys</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
  <span class="token assign-left variable">timeout</span><span class="token operator">=</span><span class="token string">&quot;20&quot;</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>update
  <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;updateAuthor&quot;</span>
  <span class="token assign-left variable">parameterType</span><span class="token operator">=</span><span class="token string">&quot;domain.blog.Author&quot;</span>
  <span class="token assign-left variable">flushCache</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
  <span class="token assign-left variable">statementType</span><span class="token operator">=</span><span class="token string">&quot;PREPARED&quot;</span>
  <span class="token assign-left variable">timeout</span><span class="token operator">=</span><span class="token string">&quot;20&quot;</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>delete
  <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;deleteAuthor&quot;</span>
  <span class="token assign-left variable">parameterType</span><span class="token operator">=</span><span class="token string">&quot;domain.blog.Author&quot;</span>
  <span class="token assign-left variable">flushCache</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
  <span class="token assign-left variable">statementType</span><span class="token operator">=</span><span class="token string">&quot;PREPARED&quot;</span>
  <span class="token assign-left variable">timeout</span><span class="token operator">=</span><span class="token string">&quot;20&quot;</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>Insert, Update, Delete 元素的属性</p> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>在命名空间中唯一的标识符，可以被用来引用这条语句。</td></tr> <tr><td>parameterType</td> <td>将会传入这条语句的参数的类全限定名或别名。这个属性是可选的，因为 MyBatis 可以根据语句中实际传入的参数计算出应该使用的类型处理器（TypeHandler），默认值为未设置（unset）。</td></tr> <tr><td><s>parameterMap</s></td> <td><s>用于引用外部 parameterMap 的属性，目前已被废弃。请使用行内参数映射和 parameterType 属性。</s></td></tr> <tr><td>flushCache</td> <td>将其设置为 true 后，只要语句被调用，都会导致本地缓存和二级缓存被清空，默认值：（对 insert、update 和 delete 语句）true。</td></tr> <tr><td>timeout</td> <td>这个设置是在抛出异常之前，驱动程序等待数据库返回请求结果的秒数。默认值为未设置（unset）（依赖数据库驱动）。</td></tr> <tr><td>statementType</td> <td>可选 STATEMENT，PREPARED 或 CALLABLE。这会让 MyBatis 分别使用 Statement，PreparedStatement 或 CallableStatement，默认值：PREPARED。</td></tr> <tr><td>useGeneratedKeys</td> <td>（仅适用于 insert 和 update）这会令 MyBatis 使用 JDBC 的 getGeneratedKeys 方法来取出由数据库内部生成的主键（比如：像 MySQL 和 SQL Server 这样的关系型数据库管理系统的自动递增字段），默认值：false。</td></tr> <tr><td>keyProperty</td> <td>（仅适用于 insert 和 update）指定能够唯一识别对象的属性，MyBatis 会使用 getGeneratedKeys 的返回值或 insert 语句的 selectKey 子元素设置它的值，默认值：未设置（unset）。如果生成列不止一个，可以用逗号分隔多个属性名称。</td></tr> <tr><td>keyColumn</td> <td>（仅适用于 insert 和 update）设置生成键值在表中的列名，在某些数据库（像 PostgreSQL）中，当主键列不是表中的第一列的时候，是必须设置的。如果生成列不止一个，可以用逗号分隔多个属性名称。</td></tr> <tr><td>databaseId</td> <td>如果配置了数据库厂商标识（databaseIdProvider），MyBatis 会加载所有不带 databaseId 或匹配当前 databaseId 的语句；如果带和不带的语句都有，则不带的会被忽略。</td></tr></tbody></table> <p>下面是 insert，update 和 delete 语句的示例：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>insert <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;insertAuthor&quot;</span><span class="token operator">&gt;</span>
  insert into Author <span class="token punctuation">(</span>id,username,password,email,bio<span class="token punctuation">)</span>
  values <span class="token punctuation">(</span><span class="token comment">#{id},#{username},#{password},#{email},#{bio})</span>
<span class="token operator">&lt;</span>/insert<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>update <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;updateAuthor&quot;</span><span class="token operator">&gt;</span>
  update Author <span class="token builtin class-name">set</span>
    username <span class="token operator">=</span> <span class="token comment">#{username},</span>
    password <span class="token operator">=</span> <span class="token comment">#{password},</span>
    email <span class="token operator">=</span> <span class="token comment">#{email},</span>
    bio <span class="token operator">=</span> <span class="token comment">#{bio}</span>
  where <span class="token function">id</span> <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/update<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>delete <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;deleteAuthor&quot;</span><span class="token operator">&gt;</span>
  delete from Author where <span class="token function">id</span> <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/delete<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>如前所述，插入语句的配置规则更加丰富，在插入语句里面有一些额外的属性和子元素用来处理主键的生成，并且提供了多种生成方式。</p> <p>首先，如果你的数据库支持自动生成主键的字段（比如 MySQL 和 SQL Server），那么你可以设置<span style="color:red;"><strong>useGeneratedKeys=”true”</strong></span>，然后再把 <span style="color:red;"><strong>keyProperty 设置为目标属性</strong></span>就 OK 了。例如，如果上面的 Author 表已经在 id 列上使用了自动生成，那么语句可以修改为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>insert <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;insertAuthor&quot;</span> <span class="token assign-left variable">useGeneratedKeys</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
    <span class="token assign-left variable">keyProperty</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span><span class="token operator">&gt;</span>
  insert into Author <span class="token punctuation">(</span>username,password,email,bio<span class="token punctuation">)</span>
  values <span class="token punctuation">(</span><span class="token comment">#{username},#{password},#{email},#{bio})</span>
<span class="token operator">&lt;</span>/insert<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果你的数据库还支持多行插入, 你也可以传入一个 Author 数组或集合，并返回自动生成的主键。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>insert <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;insertAuthor&quot;</span> <span class="token assign-left variable">useGeneratedKeys</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
    <span class="token assign-left variable">keyProperty</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span><span class="token operator">&gt;</span>
  insert into Author <span class="token punctuation">(</span>username, password, email, bio<span class="token punctuation">)</span> values
  <span class="token operator">&lt;</span>foreach <span class="token assign-left variable">item</span><span class="token operator">=</span><span class="token string">&quot;item&quot;</span> <span class="token assign-left variable">collection</span><span class="token operator">=</span><span class="token string">&quot;list&quot;</span> <span class="token assign-left variable">separator</span><span class="token operator">=</span><span class="token string">&quot;,&quot;</span><span class="token operator">&gt;</span>
    <span class="token punctuation">(</span><span class="token comment">#{item.username}, #{item.password}, #{item.email}, #{item.bio})</span>
  <span class="token operator">&lt;</span>/foreach<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/insert<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>对于不支持自动生成主键列的数据库和可能不支持自动生成主键的 JDBC 驱动，MyBatis 有另外一种方法来生成主键。</p> <p>这里有一个简单（也很傻）的示例，它可以生成一个随机 ID（不建议实际使用，这里只是为了展示 MyBatis 处理问题的灵活性和宽容度）：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>insert <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;insertAuthor&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>selectKey <span class="token assign-left variable">keyProperty</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span> <span class="token assign-left variable">order</span><span class="token operator">=</span><span class="token string">&quot;BEFORE&quot;</span><span class="token operator">&gt;</span>
    <span class="token keyword">select</span> CAST<span class="token punctuation">(</span><span class="token environment constant">RANDOM</span><span class="token punctuation">(</span><span class="token punctuation">)</span>*1000000 as INTEGER<span class="token punctuation">)</span> a from SYSIBM.SYSDUMMY1
  <span class="token operator">&lt;</span>/selectKey<span class="token operator">&gt;</span>
  insert into Author
    <span class="token punctuation">(</span>id, username, password, email,bio, favourite_section<span class="token punctuation">)</span>
  values
    <span class="token punctuation">(</span><span class="token comment">#{id}, #{username}, #{password}, #{email}, #{bio}, #{favouriteSection,jdbcType=VARCHAR})</span>
<span class="token operator">&lt;</span>/insert<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>在上面的示例中，首先会运行 selectKey 元素中的语句，并设置 Author 的 id，然后才会调用插入语句。这样就实现了数据库自动生成主键类似的行为，同时保持了 Java 代码的简洁。</p> <p>selectKey 元素描述如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>selectKey
<span class="token assign-left variable">keyProperty</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span>
<span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span>
<span class="token assign-left variable">order</span><span class="token operator">=</span><span class="token string">&quot;BEFORE&quot;</span>
<span class="token assign-left variable">statementType</span><span class="token operator">=</span><span class="token string">&quot;PREPARED&quot;</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>selectKey 元素的属性</p> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>keyProperty</td> <td>selectKey 语句结果应该被设置到的目标属性。如果生成列不止一个，可以用逗号分隔多个属性名称。</td></tr> <tr><td>keyColumn</td> <td>返回结果集中生成列属性的列名。如果生成列不止一个，可以用逗号分隔多个属性名称。</td></tr> <tr><td>resultType</td> <td>结果的类型。通常 MyBatis 可以推断出来，但是为了更加准确，写上也不会有什么问题。MyBatis 允许将任何简单类型用作主键的类型，包括字符串。如果生成列不止一个，则可以使用包含期望属性的 Object 或 Map。</td></tr> <tr><td>order</td> <td>可以设置为 BEFORE 或 AFTER。如果设置为 BEFORE，那么它首先会生成主键，设置 keyProperty 再执行插入语句。如果设置为 AFTER，那么先执行插入语句，然后是 selectKey 中的语句 - 这和 Oracle 数据库的行为相似，在插入语句内部可能有嵌入索引调用。</td></tr> <tr><td>statementType</td> <td>和前面一样，MyBatis 支持 STATEMENT，PREPARED 和 CALLABLE 类型的映射语句，分别代表 Statement, PreparedStatement 和 CallableStatement 类型。</td></tr></tbody></table> <p>作为一种不规则的情况，一些数据库允许INSERT、UPDATE或DELETE语句返回结果集（例如PostgreSQL和MariaDB的RETURNING子句或MSSQL Server的OUTPUT子句）。这种类型的语句必须被写成&lt;select&gt;来映射返回的数据。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;insertAndGetAuthor&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;domain.blog.Author&quot;</span>
      <span class="token assign-left variable">affectData</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span> <span class="token assign-left variable">flushCache</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">&gt;</span>
  insert into Author <span class="token punctuation">(</span>username, password, email, bio<span class="token punctuation">)</span>
  values <span class="token punctuation">(</span><span class="token comment">#{username}, #{password}, #{email}, #{bio})</span>
  returning id, username, password, email, bio
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="sql"><a href="#sql" class="header-anchor">#</a> sql</h2> <p>这个元素可以用来定义可重用的 SQL 代码片段，以便在其它语句中使用。 参数可以静态地（在加载的时候）确定下来，并且可以在不同的 include 元素中定义不同的参数值。比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>sql <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;userColumns&quot;</span><span class="token operator">&gt;</span> <span class="token variable">${alias}</span>.id,<span class="token variable">${alias}</span>.username,<span class="token variable">${alias}</span>.password <span class="token operator">&lt;</span>/sql<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这个 SQL 片段可以在其它语句中使用，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUsers&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;map&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span>
    <span class="token operator">&lt;</span>include <span class="token assign-left variable">refid</span><span class="token operator">=</span><span class="token string">&quot;userColumns&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;alias&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;t1&quot;</span>/<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/include<span class="token operator">&gt;</span>,
    <span class="token operator">&lt;</span>include <span class="token assign-left variable">refid</span><span class="token operator">=</span><span class="token string">&quot;userColumns&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;alias&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;t2&quot;</span>/<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/include<span class="token operator">&gt;</span>
  from some_table t1
    cross <span class="token function">join</span> some_table t2
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>也可以在 include 元素的 refid 属性或内部语句中使用属性值，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>sql <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;sometable&quot;</span><span class="token operator">&gt;</span>
  <span class="token variable">${prefix}</span>Table
<span class="token operator">&lt;</span>/sql<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>sql <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;someinclude&quot;</span><span class="token operator">&gt;</span>
  from
    <span class="token operator">&lt;</span>include <span class="token assign-left variable">refid</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${include_target}</span>&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/sql<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;select&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;map&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span>
    field1, field2, field3
  <span class="token operator">&lt;</span>include <span class="token assign-left variable">refid</span><span class="token operator">=</span><span class="token string">&quot;someinclude&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;prefix&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;Some&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;include_target&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;sometable&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/include<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="parametertype-参数"><a href="#parametertype-参数" class="header-anchor">#</a> parameterType 参数</h2> <p>之前见到的所有语句都使用了简单的参数形式。但实际上，参数是 MyBatis 非常强大的元素。对于大多数简单的使用场景，你都不需要使用复杂的参数，比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUsers&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;User&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span> id, username, password
  from <span class="token function">users</span>
  where <span class="token function">id</span> <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面的这个示例说明了一个非常简单的命名参数映射。鉴于参数类型（parameterType）会被自动设置为 int，这个参数可以随意命名。原始类型或简单数据类型（比如 Integer 和 String）因为没有其它属性，会用它们的值来作为参数。 然而，如果传入一个复杂的对象，行为就会有点不一样了。比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>insert <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;insertUser&quot;</span> <span class="token assign-left variable">parameterType</span><span class="token operator">=</span><span class="token string">&quot;User&quot;</span><span class="token operator">&gt;</span>
  insert into <span class="token function">users</span> <span class="token punctuation">(</span>id, username, password<span class="token punctuation">)</span>
  values <span class="token punctuation">(</span><span class="token comment">#{id}, #{username}, #{password})</span>
<span class="token operator">&lt;</span>/insert<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果 User 类型的参数对象传递到了语句中，会查找 id、username 和 password 属性，然后将它们的值传入预处理语句的参数中。</p> <p>对传递语句参数来说，这种方式真是干脆利落。不过参数映射的功能远不止于此。</p> <p>首先，和 MyBatis 的其它部分一样，参数也可以指定一个特殊的数据类型。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#{property,javaType=int,jdbcType=NUMERIC}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>和 MyBatis 的其它部分一样，几乎总是可以根据参数对象的类型确定 javaType，除非该对象是一个 HashMap。这个时候，你需要显式指定 javaType 来确保正确的类型处理器（TypeHandler）被使用。
<strong>JDBC 要求，如果一个列允许使用 null 值，并且会使用值为 null 的参数，就必须要指定 JDBC 类型（jdbcType）。阅读 PreparedStatement.setNull()的 JavaDoc 来获取更多信息。</strong>
要更进一步地自定义类型处理方式，可以指定一个特殊的类型处理器类（或别名），比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#{age,javaType=int,jdbcType=NUMERIC,typeHandler=MyTypeHandler}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数的配置好像越来越繁琐了，但实际上，很少需要如此繁琐的配置。</p> <p>对于数值类型，还可以设置 numericScale 指定小数点后保留的位数。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#{height,javaType=double,jdbcType=NUMERIC,numericScale=2}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>最后，mode 属性允许你指定 IN，OUT 或 INOUT 参数。如果参数的 mode 为 OUT 或 INOUT，将会修改参数对象的属性值，以便作为输出参数返回。 如果 mode 为 OUT（或 INOUT），而且 jdbcType 为 CURSOR（也就是 Oracle 的 REFCURSOR），你必须指定一个 resultMap 引用来将结果集 ResultSet 映射到参数的类型上。要注意这里的 javaType 属性是可选的，如果留空并且 jdbcType 是 CURSOR，它会被自动地被设为 ResultSet。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#{department, mode=OUT, jdbcType=CURSOR, javaType=ResultSet, resultMap=departmentResultMap}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>MyBatis 也支持很多高级的数据类型，比如结构体（structs），但是当使用 out 参数时，你必须显式设置类型的名称。比如（再次提示，在实际中要像这样不能换行）：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#{middleInitial, mode=OUT, jdbcType=STRUCT, jdbcTypeName=MY_TYPE, resultMap=departmentResultMap}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>尽管上面这些选项很强大，但大多时候，你只须简单指定属性名，顶多要为可能为空的列指定 jdbcType，其他的事情交给 MyBatis 自己去推断就行了。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#{firstName}</span>
<span class="token comment">#{middleInitial,jdbcType=VARCHAR}</span>
<span class="token comment">#{lastName}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="mybatis-参数总结大全"><a href="#mybatis-参数总结大全" class="header-anchor">#</a> mybatis 参数总结大全</h3> <p>1、单个参数：mybatis不会做特殊处理， #{参数名/任意名}：取出参数值。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>接口文件定义单个参数的时候，在mybatis mapper.xml中可以使用任意参数取出参数值，
因为此时参数值只有一个。所以怎么取都不会出错 如下所示:
//mapper.class
  User findUserByLoginCode(String loginCode);
//mapper.xml
  &lt;select id=&quot;findUserByLoginCode&quot; resultType=&quot;com.fzx.study.mybatis.entity.User&quot;&gt;
        select  * from   js_sys_user where   login_code = #{code}
   &lt;/select&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>2、多个参数:mybatis会做特殊处理。 多个参数会被封装成 一个map，</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>接口文件定义多个参数的时候，在mybatis mapper.xml中可以使用三种方式取出参数值,如下所示
//mapper.calss 
 User getUserByColumn(String column, String value);

//mapper.xml
//1、使用 	key：param1...paramN,或者参数的索引也可以
&lt;select id=&quot;getUserByColumn&quot; resultType=&quot;com.fzx.study.mybatis.entity.User&quot;&gt;
        SELECT *
        FROM js_sys_user
        WHERE ${param1} = #{param2}
&lt;/select&gt;
//2、使用 	key：arg0...argN
&lt;select id=&quot;getUserByColumn&quot; resultType=&quot;com.fzx.study.mybatis.entity.User&quot;&gt;
        SELECT *
        FROM js_sys_user
        WHERE ${arg0} = #{arg1}
&lt;/select&gt;        
 也可以使用arg 与param结合使用
&lt;select id=&quot;getUserByColumnThree&quot; resultType=&quot;com.fzx.study.mybatis.entity.User&quot;&gt;
        SELECT *
        FROM js_sys_user
        WHERE ${param1} = #{arg1}
&lt;/select&gt;
//3、第三种方式需要 组合  接口使用@Param注解来使用，如下所示
//mapper.class
  User getUserByColumnFour(@Param(&quot;column&quot;) String column,@Param(&quot;value&quot;) String value);
//mapper.xml
&lt;select id=&quot;getUserByColumnFour&quot; resultType=&quot;com.fzx.study.mybatis.entity.User&quot;&gt;
        SELECT *
        FROM js_sys_user
        WHERE ${column} = #{value}
&lt;/select&gt;

【命名参数】：明确指定封装参数时map的key；@Param(&quot;id&quot;)
	多个参数会被封装成 一个map，
		key：使用@Param注解指定的值
		value：参数值
	#{指定的key}取出对应的参数值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>3、使用pojo对象当做参数
如果多个参数正好是我们业务逻辑的数据模型，我们就可以直接传入pojo；</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>接口文件使用pojo对象当做参数的时候,在mapper.xml取值的时候我们就可以使用
<span class="token comment">#{属性名}：取出传入的pojo的属性值</span>
//mapper.class
  User getUserInfo<span class="token punctuation">(</span>UserVo userVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
//mapper.xml
<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;getUserInfo&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;com.fzx.study.mybatis.entity.User&quot;</span><span class="token operator">&gt;</span>
        SELECT *
        FROM js_sys_user
        <span class="token operator">&lt;</span>where<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>if <span class="token assign-left variable">test</span><span class="token operator">=</span><span class="token string">&quot;userName != null || userName != ''&quot;</span><span class="token operator">&gt;</span>
              and   user_name <span class="token operator">=</span> <span class="token comment">#{userName}</span>
            <span class="token operator">&lt;</span>/if<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>if <span class="token assign-left variable">test</span><span class="token operator">=</span><span class="token string">&quot;phone != null || phone !=''&quot;</span><span class="token operator">&gt;</span>
              and    phone <span class="token operator">=</span> <span class="token comment">#{phone}</span>
            <span class="token operator">&lt;</span>/if<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/where<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>4、使用map当做参数
如果多个参数不是业务模型中的数据，没有对应的pojo，不经常使用，为了方便，我们也可以传入map</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>接口文件使用map当做参数的时候,mapper.xml取值的时候可以使用 <span class="token comment">#{key}：取出map中对应的值</span>
//mapper.class
 User getUserInfoByMap<span class="token punctuation">(</span>Map map<span class="token punctuation">)</span><span class="token punctuation">;</span>
//mapper.xml
 <span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;getUserInfoByMap&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;com.fzx.study.mybatis.entity.User&quot;</span><span class="token operator">&gt;</span>
        SELECT *
        FROM js_sys_user
        <span class="token operator">&lt;</span>where<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>if <span class="token assign-left variable">test</span><span class="token operator">=</span><span class="token string">&quot;userName != null || userName != ''&quot;</span><span class="token operator">&gt;</span>
                and   user_name <span class="token operator">=</span> <span class="token comment">#{userName}</span>
            <span class="token operator">&lt;</span>/if<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>if <span class="token assign-left variable">test</span><span class="token operator">=</span><span class="token string">&quot;phone != null || phone !=''&quot;</span><span class="token operator">&gt;</span>
                and    phone <span class="token operator">=</span> <span class="token comment">#{phone}</span>
            <span class="token operator">&lt;</span>/if<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/where<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>5、Collection（List、Set）、数组参数</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>如果是Collection（List、Set）类型或者是数组，
也会特殊处理。也是把传入的list或者数组封装在map中。取值方式如下所示:
	key：Collection（collection）,如果是List还可以使用这个key(list)
				数组(array)
public Employee getEmpById(List&lt;Integer&gt; ids);
	取值：取出第一个id的值：   #{list[0]}
//mapepr.java
List&lt;User&gt; getUserByList(List list);
//mapper.xml
&lt;select id=&quot;getUserByList&quot; resultType=&quot;com.fzx.study.mybatis.entity.User&quot;&gt;
        SELECT *
        FROM js_sys_user
        &lt;where&gt;
            &lt;foreach item=&quot;item&quot; index=&quot;index&quot; collection=&quot;list&quot; open=&quot;user_name in (&quot; separator=&quot;,&quot; close=&quot;)&quot; &gt;
                #{item.userName}
            &lt;/foreach&gt;
        &lt;/where&gt;
&lt;/select&gt;

以上是遍历List方式的一种写法，注意collection=&quot;list&quot; 也可以 写成 collection=&quot;collection&quot; 
使用collection[0]获取属性值。还可以写成 arg0。
这块有个可以查看当前接收参数的命名取值的一个技巧，当我们使用错误的命名参数去接收mapper.java的参数时,mybatis通常会抛出异常
 Cause: org.apache.ibatis.binding.BindingException: Parameter 'userVoList' not found. Available parameters are [arg0, collection, list]
通过异常可以看出，这块的命名方式我们可以选择[arg0, collection, list] 其中之一。

以下是数组参数的一种示例:
//mapper.java
 List&lt;User&gt; getUserByArray(@Param(&quot;userVoArrays&quot;) UserVo[] userVoArrays);
//mapper.xml
&lt;select id=&quot;getUserByArray&quot; resultType=&quot;com.fzx.study.mybatis.entity.User&quot;&gt;
        SELECT *
        FROM js_sys_user
        &lt;where&gt;
            &lt;foreach item=&quot;item&quot; index=&quot;index&quot; collection=&quot;userVoArrays&quot; open=&quot;user_name in (&quot; separator=&quot;,&quot; close=&quot;)&quot; &gt;
                #{item.userName}
            &lt;/foreach&gt;
        &lt;/where&gt;
&lt;/select&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>总结：参数多时会封装map，为了不混乱，我们可以使用@Param来指定封装时使用的key；</p> <h3 id="浅谈一下mybatis-参数处理源码"><a href="#浅谈一下mybatis-参数处理源码" class="header-anchor">#</a> 浅谈一下mybatis 参数处理源码</h3> <p>给以下代码打上断点:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>userMapper.getUserByColumnOne<span class="token punctuation">(</span><span class="token string">&quot;user_code&quot;</span>, <span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/006_mybatis参数解析源码.2702d3c4.png" alt="参数解析源码">
通过debug可以得到ParamNameResolver 类的以下源码:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> public Object getNamedParams(Object[] args) {
   //获取当前方法的参数个数
    final int paramCount = names.size();
    //如果当前参数为空或者当前方法参数的个数为0 直接返回null
    if (args == null || paramCount == 0) {
      return null;
    }
    //如果当前不存在@param 注解,并且只有一个参数 则返回单个参数的处理方式
    if (!hasParamAnnotation &amp;&amp; paramCount == 1) {
      Object value = args[names.firstKey()];
      return wrapToMapIfCollection(value, useActualParamName ? names.get(names.firstKey()) : null);
    } else {
      //如果当前存在多个参数或者存在@param注解
      final Map&lt;String, Object&gt; param = new ParamMap&lt;&gt;();
      int i = 0;
      //将参数组装成  &quot;arg1&quot; -&gt; &quot;admin&quot; &quot;arg0&quot; -&gt; &quot;user_code&quot; &quot;param1&quot; -&gt; &quot;user_code&quot; &quot;param2&quot; -&gt; &quot;admin&quot;
      //或者 &quot;loginCode&quot; -&gt; &quot;admin&quot; &quot;param1&quot; -&gt; &quot;admin&quot;形式
      for (Map.Entry&lt;Integer, String&gt; entry : names.entrySet()) {
        param.put(entry.getValue(), args[entry.getKey()]);
        // add generic param names (param1, param2, ...)
        final String genericParamName = GENERIC_NAME_PREFIX + (i + 1);
        // ensure not to overwrite parameter named with @Param
         //额外的将每一个参数也保存到map中，使用新的key：param1...paramN
        //效果：有Param注解可以#{指定的key}，或者#{param1}
        if (!names.containsValue(genericParamName)) {
          param.put(genericParamName, args[entry.getKey()]);
        }
        i++;
      }
      return param;
    }
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="字符串替换"><a href="#字符串替换" class="header-anchor">#</a> ${}字符串替换</h2> <p>默认情况下，使用 #{} 参数语法时，MyBatis 会创建 PreparedStatement 参数占位符，并通过占位符安全地设置参数（就像使用 ? 一样）。 这样做更安全，更迅速，通常也是首选做法，不过有时你就是想直接在 SQL 语句中直接插入一个不转义的字符串。 比如 ORDER BY 子句，这时候你可以：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ORDER BY <span class="token variable">${columnName}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样，MyBatis 就不会修改或转义该字符串了。</p> <p>当 SQL 语句中的元数据（如表名或列名）是动态生成的时候，字符串替换将会非常有用。 举个例子，如果你想 select 一个表任意一列的数据时，不需要这样写：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>@Select<span class="token punctuation">(</span><span class="token string">&quot;select * from user where id = #{id}&quot;</span><span class="token punctuation">)</span>
User findById<span class="token punctuation">(</span>@Param<span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> long <span class="token function">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

@Select<span class="token punctuation">(</span><span class="token string">&quot;select * from user where name = #{name}&quot;</span><span class="token punctuation">)</span>
User findByName<span class="token punctuation">(</span>@Param<span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> String name<span class="token punctuation">)</span><span class="token punctuation">;</span>

@Select<span class="token punctuation">(</span><span class="token string">&quot;select * from user where email = #{email}&quot;</span><span class="token punctuation">)</span>
User findByEmail<span class="token punctuation">(</span>@Param<span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span> String email<span class="token punctuation">)</span><span class="token punctuation">;</span>

// 其它的 <span class="token string">&quot;findByXxx&quot;</span> 方法
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>而是可以只写这样一个方法：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>@Select<span class="token punctuation">(</span><span class="token string">&quot;select * from user where <span class="token variable">${column}</span> = #{value}&quot;</span><span class="token punctuation">)</span>
User findByColumn<span class="token punctuation">(</span>@Param<span class="token punctuation">(</span><span class="token string">&quot;column&quot;</span><span class="token punctuation">)</span> String column, @Param<span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span> String value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>其中 ${column} 会被直接替换，而 #{value} 会使用 ? 预处理。 这样，就能完成同样的任务：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>User userOfId1 <span class="token operator">=</span> userMapper.findByColumn<span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span>, 1L<span class="token punctuation">)</span><span class="token punctuation">;</span>
User userOfNameKid <span class="token operator">=</span> userMapper.findByColumn<span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span>, <span class="token string">&quot;kid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
User userOfEmail <span class="token operator">=</span> userMapper.findByColumn<span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span>, <span class="token string">&quot;noone@nowhere.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>打印mybatis的的日志可以发现</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">==</span><span class="token operator">&gt;</span>  Preparing: SELECT * FROM js_sys_user WHERE <span class="token function">id</span> <span class="token operator">=</span> ?
<span class="token operator">==</span><span class="token operator">&gt;</span> Parameters: <span class="token number">1</span><span class="token punctuation">(</span>Long<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>${arg0} 没有站位符，是直接替换的字符串</p> <p>这种方式也同样适用于替换表名的情况。
<strong>用这种方式接受用户的输入，并用作语句参数是不安全的，会导致潜在的 SQL 注入攻击。因此，要么不允许用户输入这些字段，要么自行转义并检验这些参数。</strong></p> <h3 id="、-区别"><a href="#、-区别" class="header-anchor">#</a> #{}、${} 区别：</h3> <ul><li>#{}:是以预编译的形式，将参数设置到sql语句中；PreparedStatement；防止sql注入
<ul><li>#{}:更丰富的用法： 规定参数的一些规则： javaType、 jdbcType、 mode（存储过程）、 numericScale、 resultMap、 typeHandler、 jdbcTypeName、 expression（未来准备支持的功能）；</li></ul></li> <li>${}:取出的值直接拼装在sql语句中；会有安全问题；<br>
大多情况下，我们去参数的值都应该去使用#{}；</li></ul> <p>原生jdbc不支持占位符的地方我们就可以使用${}进行取值<br>
比如分表、排序.......按照年份分表拆分</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>	<span class="token keyword">select</span> * from <span class="token variable">${year}</span>_salary where xxx<span class="token punctuation">;</span>
	<span class="token keyword">select</span> * from tbl_employee order by <span class="token variable">${f_name}</span> <span class="token variable">${order}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="resultmap结果映射"><a href="#resultmap结果映射" class="header-anchor">#</a> resultMap结果映射</h2> <p>resultMap 元素是 MyBatis 中最重要最强大的元素。它可以让你从 90% 的 JDBC ResultSets 数据提取代码中解放出来，并在一些情形下允许你进行一些 JDBC 不支持的操作。实际上，在为一些比如连接的复杂语句编写映射代码的时候，一份 resultMap 能够代替实现同等功能的数千行代码。ResultMap 的设计思想是，对简单的语句做到零配置，对于复杂一点的语句，只需要描述语句之间的关系就行了。</p> <p>之前你已经见过简单映射语句的示例，它们没有显式指定 resultMap。比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUsers&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;map&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span> id, username, hashedPassword
  from some_table
  where <span class="token function">id</span> <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上述语句只是简单地将所有的列映射到 HashMap 的键上，这由 resultType 属性指定。虽然在大部分情况下都够用，但是 HashMap 并不是一个很好的领域模型。你的程序更可能会使用 JavaBean 或 POJO（Plain Old Java Objects，普通老式 Java 对象）作为领域模型。MyBatis 对两者都提供了支持。看看下面这个 JavaBean：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>someapp<span class="token punctuation">.</span>model</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> hashedPassword<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> id<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> username<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getHashedPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hashedPassword<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setHashedPassword</span><span class="token punctuation">(</span><span class="token class-name">String</span> hashedPassword<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hashedPassword <span class="token operator">=</span> hashedPassword<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>基于 JavaBean 的规范，上面这个类有 3 个属性：id，username 和 hashedPassword。这些属性会对应到 select 语句中的列名。</p> <p>这样的一个 JavaBean 可以被映射到 ResultSet，就像映射到 HashMap 一样简单。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUsers&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;com.someapp.model.User&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span> id, username, hashedPassword
  from some_table
  where <span class="token function">id</span> <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>类型别名是你的好帮手。使用它们，你就可以不用输入类的全限定名了。比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span><span class="token operator">!</span>-- mybatis-config.xml 中 --<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>typeAlias <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;com.someapp.model.User&quot;</span> <span class="token assign-left variable">alias</span><span class="token operator">=</span><span class="token string">&quot;User&quot;</span>/<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span>-- SQL 映射 XML 中 --<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUsers&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;User&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span> id, username, hashedPassword
  from some_table
  where <span class="token function">id</span> <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>在这些情况下，MyBatis 会在幕后自动创建一个 ResultMap，再根据属性名来映射列到 JavaBean 的属性上。如果列名和属性名不能匹配上，可以在 SELECT 语句中设置列别名（这是一个基本的 SQL 特性）来完成匹配。比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUsers&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;User&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span>
    user_id             as <span class="token string">&quot;id&quot;</span>,
    user_name           as <span class="token string">&quot;userName&quot;</span>,
    hashed_password     as <span class="token string">&quot;hashedPassword&quot;</span>
  from some_table
  where <span class="token function">id</span> <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>在学习了上面的知识后，你会发现上面的例子没有一个需要显式配置 ResultMap，这就是 ResultMap 的优秀之处——你完全可以不用显式地配置它们。 虽然上面的例子不用显式配置 ResultMap。 但为了讲解，我们来看看如果在刚刚的示例中，显式使用外部的 resultMap 会怎样，这也是解决列名不匹配的另外一种方式。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;userResultMap&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;User&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;user_id&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;user_name&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;hashed_password&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>然后在引用它的语句中设置 resultMap 属性就行了（注意我们去掉了 resultType 属性）。比如:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUsers&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;userResultMap&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span> user_id, user_name, hashed_password
  from some_table
  where <span class="token function">id</span> <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果这个世界总是这么简单就好了。</p> <h3 id="高级结果映射"><a href="#高级结果映射" class="header-anchor">#</a> 高级结果映射</h3> <p>MyBatis 创建时的一个思想是：数据库不可能永远是你所想或所需的那个样子。 我们希望每个数据库都具备良好的第三范式或 BCNF 范式，可惜它们并不都是那样。 如果能有一种数据库映射模式，完美适配所有的应用程序，那就太好了，但可惜也没有。 而 ResultMap 就是 MyBatis 对这个问题的答案。</p> <p>比如，我们如何映射下面这个语句？</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span><span class="token operator">!</span>-- 非常复杂的语句 --<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectBlogDetails&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;detailedBlogResultMap&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span>
       B.id as blog_id,
       B.title as blog_title,
       B.author_id as blog_author_id,
       A.id as author_id,
       A.username as author_username,
       A.password as author_password,
       A.email as author_email,
       A.bio as author_bio,
       A.favourite_section as author_favourite_section,
       P.id as post_id,
       P.blog_id as post_blog_id,
       P.author_id as post_author_id,
       P.created_on as post_created_on,
       P.section as post_section,
       P.subject as post_subject,
       P.draft as draft,
       P.body as post_body,
       C.id as comment_id,
       C.post_id as comment_post_id,
       C.name as comment_name,
       C.comment as comment_text,
       T.id as tag_id,
       T.name as tag_name
  from Blog B
       left outer <span class="token function">join</span> Author A on B.author_id <span class="token operator">=</span> A.id
       left outer <span class="token function">join</span> Post P on B.id <span class="token operator">=</span> P.blog_id
       left outer <span class="token function">join</span> Comment C on P.id <span class="token operator">=</span> C.post_id
       left outer <span class="token function">join</span> Post_Tag PT on PT.post_id <span class="token operator">=</span> P.id
       left outer <span class="token function">join</span> Tag T on PT.tag_id <span class="token operator">=</span> T.id
  where B.id <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>你可能想把它映射到一个智能的对象模型，这个对象表示了一篇博客，它由某位作者所写，有很多的博文，每篇博文有零或多条的评论和标签。 我们先来看看下面这个完整的例子，它是一个非常复杂的结果映射（假设作者，博客，博文，评论和标签都是类型别名）。 不用紧张，我们会一步一步地来说明。虽然它看起来令人望而生畏，但其实非常简单。</p> <p><strong>建表语句:</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>CREATE TABLE Blog <span class="token punctuation">(</span>
  <span class="token function">id</span> INT PRIMARY KEY,
  title VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
  author_id INT
<span class="token punctuation">)</span><span class="token punctuation">;</span>

INSERT INTO Blog <span class="token punctuation">(</span>id, title, author_id<span class="token punctuation">)</span> VALUES
<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">'Blog 1'</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">2</span>, <span class="token string">'Blog 2'</span>, <span class="token number">2</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">'Blog 3'</span>, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


CREATE TABLE Author <span class="token punctuation">(</span>
  <span class="token function">id</span> INT PRIMARY KEY,
  username VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
  password VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
  email VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
  bio TEXT,
  favourite_section VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

INSERT INTO Author <span class="token punctuation">(</span>id, username, password, email, bio, favourite_section<span class="token punctuation">)</span> VALUES
<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">'user1'</span>, <span class="token string">'password1'</span>, <span class="token string">'user1@example.com'</span>, <span class="token string">'Bio 1'</span>, <span class="token string">'Section 1'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">2</span>, <span class="token string">'user2'</span>, <span class="token string">'password2'</span>, <span class="token string">'user2@example.com'</span>, <span class="token string">'Bio 2'</span>, <span class="token string">'Section 2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


CREATE TABLE Post <span class="token punctuation">(</span>
  <span class="token function">id</span> INT PRIMARY KEY,
  blog_id INT,
  author_id INT,
  created_on DATETIME,
  section VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
  subject VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
  draft BOOLEAN,
  body TEXT
<span class="token punctuation">)</span><span class="token punctuation">;</span>


INSERT INTO Post <span class="token punctuation">(</span>id, blog_id, author_id, created_on, section, subject, draft, body<span class="token punctuation">)</span> VALUES
<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span>, <span class="token number">1</span>, <span class="token string">'2023-01-01 10:00:00'</span>, <span class="token string">'Section 1'</span>, <span class="token string">'Subject 1'</span>, false, <span class="token string">'Body 1'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">1</span>, <span class="token number">2</span>, <span class="token string">'2023-01-02 11:00:00'</span>, <span class="token string">'Section 1'</span>, <span class="token string">'Subject 2'</span>, false, <span class="token string">'Body 2'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">2</span>, <span class="token number">1</span>, <span class="token string">'2023-01-03 12:00:00'</span>, <span class="token string">'Section 2'</span>, <span class="token string">'Subject 3'</span>, true, <span class="token string">'Body 3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

CREATE TABLE Comment <span class="token punctuation">(</span>
  <span class="token function">id</span> INT PRIMARY KEY,
  post_id INT,
  name VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
  comment TEXT
<span class="token punctuation">)</span><span class="token punctuation">;</span>

INSERT INTO Comment <span class="token punctuation">(</span>id, post_id, name, comment<span class="token punctuation">)</span> VALUES
<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span>, <span class="token string">'User 1'</span>, <span class="token string">'Comment 1'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">1</span>, <span class="token string">'User 2'</span>, <span class="token string">'Comment 2'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">2</span>, <span class="token string">'User 3'</span>, <span class="token string">'Comment 3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

CREATE TABLE Post_Tag <span class="token punctuation">(</span>
  post_id INT,
  tag_id INT
<span class="token punctuation">)</span><span class="token punctuation">;</span>


INSERT INTO Post_Tag <span class="token punctuation">(</span>post_id, tag_id<span class="token punctuation">)</span> VALUES
<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">2</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

CREATE TABLE Tag <span class="token punctuation">(</span>
  <span class="token function">id</span> INT PRIMARY KEY,
  name VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>


INSERT INTO Tag <span class="token punctuation">(</span>id, name<span class="token punctuation">)</span> VALUES
<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">'Tag 1'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">2</span>, <span class="token string">'Tag 2'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">'Tag 3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br></div></div><p>创建对应的 Java 类，包括 Blog、Author、Post 和 DraftPost。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>public class Blog <span class="token punctuation">{</span>
  private int <span class="token function">id</span><span class="token punctuation">;</span>
  private String title<span class="token punctuation">;</span>
  private Author author<span class="token punctuation">;</span>
  private List<span class="token operator">&lt;</span>Post<span class="token operator">&gt;</span> posts<span class="token punctuation">;</span>

  // getter and setter methods<span class="token punctuation">..</span>.
<span class="token punctuation">}</span>

public class Author <span class="token punctuation">{</span>
  private int <span class="token function">id</span><span class="token punctuation">;</span>
  private String username<span class="token punctuation">;</span>
  private String password<span class="token punctuation">;</span>
  private String email<span class="token punctuation">;</span>
  private String bio<span class="token punctuation">;</span>
  private String favouriteSection<span class="token punctuation">;</span>

  // getter and setter methods<span class="token punctuation">..</span>.
<span class="token punctuation">}</span>

public class Post <span class="token punctuation">{</span>
  private int <span class="token function">id</span><span class="token punctuation">;</span>
  private String subject<span class="token punctuation">;</span>
  private Author author<span class="token punctuation">;</span>
  private List<span class="token operator">&lt;</span>Comment<span class="token operator">&gt;</span> comments<span class="token punctuation">;</span>
  private List<span class="token operator">&lt;</span>Tag<span class="token operator">&gt;</span> tags<span class="token punctuation">;</span>

  // getter and setter methods<span class="token punctuation">..</span>.
<span class="token punctuation">}</span>

public class DraftPost extends Post <span class="token punctuation">{</span>
  // 添加 DraftPost 特有的属性和方法

  // getter and setter methods<span class="token punctuation">..</span>.
<span class="token punctuation">}</span>

public class Comment <span class="token punctuation">{</span>
  private int <span class="token function">id</span><span class="token punctuation">;</span>

  // getter and setter methods<span class="token punctuation">..</span>.
<span class="token punctuation">}</span>

public class Tag <span class="token punctuation">{</span>
  private int <span class="token function">id</span><span class="token punctuation">;</span>

  // getter and setter methods<span class="token punctuation">..</span>.
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p>创建 MyBatis 配置文件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span><span class="token operator">!</span>-- mybatis-config.xml --<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>environments <span class="token assign-left variable">default</span><span class="token operator">=</span><span class="token string">&quot;development&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>environment <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;development&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>transactionManager <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;JDBC&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>dataSource <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;POOLED&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;driver&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;com.mysql.jdbc.Driver&quot;</span>/<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;url&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;jdbc:mysql://localhost:3306/my_database&quot;</span>/<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;your_username&quot;</span>/<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;your_password&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>/dataSource<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/environment<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/environments<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>mappers<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span>-- 配置映射器文件 --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>mapper <span class="token assign-left variable">resource</span><span class="token operator">=</span><span class="token string">&quot;mapper.xml&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/mappers<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/configuration<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>创建映射器文件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span><span class="token operator">!</span>-- mapper.xml --<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>mapper <span class="token assign-left variable">namespace</span><span class="token operator">=</span><span class="token string">&quot;com.example.mapper.BlogMapper&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;detailedBlogResultMap&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;com.example.model.Blog&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>constructor<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>idArg <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_id&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/constructor<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_title&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;author&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;com.example.model.Author&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_id&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_username&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_password&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;email&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_email&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;bio&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_bio&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;favouriteSection&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_favourite_section&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/association<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>collection <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;posts&quot;</span> <span class="token assign-left variable">ofType</span><span class="token operator">=</span><span class="token string">&quot;com.example.model.Post&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;post_id&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;subject&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;post_subject&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;author&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;com.example.model.Author&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>collection <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;comments&quot;</span> <span class="token assign-left variable">ofType</span><span class="token operator">=</span><span class="token string">&quot;com.example.model.Comment&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;comment_id&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>/collection<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>collection <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;tags&quot;</span> <span class="token assign-left variable">ofType</span><span class="token operator">=</span><span class="token string">&quot;com.example.model.Tag&quot;</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;tag_id&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>/collection<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>discriminator <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;draft&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;1&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;com.example.model.DraftPost&quot;</span>/<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>/discriminator<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/collection<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;getBlogById&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;detailedBlogResultMap&quot;</span><span class="token operator">&gt;</span>
    SELECT * FROM blog WHERE blog_id <span class="token operator">=</span> <span class="token comment">#{id}</span>
  <span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/mapper<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>创建映射器接口:
创建映射器接口 BlogMapper.java，定义查询方法。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>public interface BlogMapper <span class="token punctuation">{</span>
  Blog getBlogById<span class="token punctuation">(</span>int <span class="token function">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>编写示例代码
创建一个 Java 类，编写示例代码来使用 MyBatis 进行查询。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>public class MyBatisExample {
  public static void main(String[] args) {
    // 创建 MyBatis 的配置文件输入流
    InputStream inputStream = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);
    
    // 创建 SqlSessionFactory
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
    
    // 创建 SqlSession
    SqlSession sqlSession = sqlSessionFactory.openSession();
    
    try {
      // 获取 BlogMapper 接口的实例
      BlogMapper blogMapper = sqlSession.getMapper(BlogMapper.class);
      
      // 调用方法查询博客信息
      Blog blog = blogMapper.getBlogById(1);
      
      // 打印结果
      System.out.println(blog.getTitle());
      System.out.println(blog.getAuthor().getUsername());
      System.out.println(blog.getPosts().size());
      
      // 如果查询结果是 DraftPost 类型，则可以调用 DraftPost 特有的方法
      if (blog.getPosts().get(0) instanceof DraftPost) {
        DraftPost draftPost = (DraftPost) blog.getPosts().get(0);
        // 调用 DraftPost 特有的方法
      }
      
    } finally {
      sqlSession.close();
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!-- 非常复杂的结果映射 --&gt;
&lt;resultMap id=&quot;detailedBlogResultMap&quot; type=&quot;Blog&quot;&gt;
  &lt;constructor&gt;
    &lt;idArg column=&quot;blog_id&quot; javaType=&quot;int&quot;/&gt;
  &lt;/constructor&gt;
  &lt;result property=&quot;title&quot; column=&quot;blog_title&quot;/&gt;
  &lt;association property=&quot;author&quot; javaType=&quot;Author&quot;&gt;
    &lt;id property=&quot;id&quot; column=&quot;author_id&quot;/&gt;
    &lt;result property=&quot;username&quot; column=&quot;author_username&quot;/&gt;
    &lt;result property=&quot;password&quot; column=&quot;author_password&quot;/&gt;
    &lt;result property=&quot;email&quot; column=&quot;author_email&quot;/&gt;
    &lt;result property=&quot;bio&quot; column=&quot;author_bio&quot;/&gt;
    &lt;result property=&quot;favouriteSection&quot; column=&quot;author_favourite_section&quot;/&gt;
  &lt;/association&gt;
  &lt;collection property=&quot;posts&quot; ofType=&quot;Post&quot;&gt;
    &lt;id property=&quot;id&quot; column=&quot;post_id&quot;/&gt;
    &lt;result property=&quot;subject&quot; column=&quot;post_subject&quot;/&gt;
    &lt;association property=&quot;author&quot; javaType=&quot;Author&quot;/&gt;
    &lt;collection property=&quot;comments&quot; ofType=&quot;Comment&quot;&gt;
      &lt;id property=&quot;id&quot; column=&quot;comment_id&quot;/&gt;
    &lt;/collection&gt;
    &lt;collection property=&quot;tags&quot; ofType=&quot;Tag&quot; &gt;
      &lt;id property=&quot;id&quot; column=&quot;tag_id&quot;/&gt;
    &lt;/collection&gt;
    &lt;discriminator javaType=&quot;int&quot; column=&quot;draft&quot;&gt;
      &lt;case value=&quot;1&quot; resultType=&quot;DraftPost&quot;/&gt;
    &lt;/discriminator&gt;
  &lt;/collection&gt;
&lt;/resultMap&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>resultMap 元素有很多子元素和一个值得深入探讨的结构。 下面是resultMap 元素的概念视图。</p> <h3 id="结果映射-resultmap"><a href="#结果映射-resultmap" class="header-anchor">#</a> 结果映射（resultMap）</h3> <ul><li>constructor - 用于在实例化类时，注入结果到构造方法中
<ul><li>idArg - ID 参数；标记出作为 ID 的结果可以帮助提高整体性能</li> <li>arg - 将被注入到构造方法的一个普通结果</li></ul></li> <li>id – 一个 ID 结果；标记出作为 ID 的结果可以帮助提高整体性能</li> <li>result – 注入到字段或 JavaBean 属性的普通结果</li> <li>association – 一个复杂类型的关联；许多结果将包装成这种类型
<ul><li>嵌套结果映射 – 关联可以是 resultMap 元素，或是对其它结果映射的引用</li></ul></li> <li>collection – 一个复杂类型的集合
<ul><li>嵌套结果映射 – 集合可以是 resultMap 元素，或是对其它结果映射的引用</li></ul></li> <li>discriminator – 使用结果值来决定使用哪个 resultMap
<ul><li>case – 基于某些值的结果映射
<ul><li>嵌套结果映射 – case 也是一个结果映射，因此具有相同的结构和元素；或者引用其它的结果映射</li></ul></li></ul></li></ul> <p>ResultMap 的属性列表</p> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>当前命名空间中的一个唯一标识，用于标识一个结果映射。</td></tr> <tr><td>type</td> <td>类的完全限定名, 或者一个类型别名（关于内置的类型别名，可以参考上面的表格）。</td></tr> <tr><td>autoMapping</td> <td>如果设置这个属性，MyBatis 将会为本结果映射开启或者关闭自动映射。 这个属性会覆盖全局的属性 autoMappingBehavior。默认值：未设置（unset）。</td></tr></tbody></table> <p><strong>最佳实践</strong> 最好逐步建立结果映射。单元测试可以在这个过程中起到很大帮助。 如果你尝试一次性创建像上面示例那么巨大的结果映射，不仅容易出错，难度也会直线上升。 所以，从最简单的形态开始，逐步迭代。而且别忘了单元测试！ 有时候，框架的行为像是一个黑盒子（无论是否开源）。因此，为了确保实现的行为与你的期望相一致，最好编写单元测试。 并且单元测试在提交 bug 时也能起到很大的作用。</p> <h3 id="id-result"><a href="#id-result" class="header-anchor">#</a> id &amp; result</h3> <p>这些元素是结果映射的基础。id 和 result 元素都将一个列的值映射到一个简单数据类型（String, int, double, Date 等）的属性或字段。</p> <p>这两者之间的唯一不同是，id 元素对应的属性会被标记为对象的标识符，在比较对象实例时使用。 这样可以提高整体的性能，尤其是进行缓存和嵌套结果映射（也就是连接映射）的时候。</p> <p>两个元素都有一些属性：</p> <p>Id 和 Result 的属性</p> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>property</td> <td>映射到列结果的字段或属性。如果 JavaBean 有这个名字的属性（property），会先使用该属性。否则 MyBatis 将会寻找给定名称的字段（field）。 无论是哪一种情形，你都可以使用常见的点式分隔形式进行复杂属性导航。 比如，你可以这样映射一些简单的东西：“username”，或者映射到一些复杂的东西上：“address.street.number”。</td></tr> <tr><td>column</td> <td>数据库中的列名，或者是列的别名。一般情况下，这和传递给 resultSet.getString(columnName) 方法的参数一样。</td></tr> <tr><td>javaType</td> <td>一个 Java 类的全限定名，或一个类型别名（关于内置的类型别名，可以参考上面的表格）。 如果你映射到一个 JavaBean，MyBatis 通常可以推断类型。然而，如果你映射到的是 HashMap，那么你应该明确地指定 javaType 来保证行为与期望的相一致。</td></tr> <tr><td>jdbcType</td> <td>JDBC 类型，所支持的 JDBC 类型参见这个表格之后的“支持的 JDBC 类型”。 只需要在可能执行插入、更新和删除的且允许空值的列上指定 JDBC 类型。这是 JDBC 的要求而非 MyBatis 的要求。如果你直接面向 JDBC 编程，你需要对可以为空值的列指定这个类型。</td></tr> <tr><td>typeHandler</td> <td>我们在前面讨论过默认的类型处理器。使用这个属性，你可以覆盖默认的类型处理器。 这个属性值是一个类型处理器实现类的全限定名，或者是类型别名。</td></tr></tbody></table> <h4 id="支持的-jdbc-类型"><a href="#支持的-jdbc-类型" class="header-anchor">#</a> 支持的 JDBC 类型</h4> <p>为了以后可能的使用场景，MyBatis 通过内置的 jdbcType 枚举类型支持下面的 JDBC 类型。</p> <table><thead><tr><th></th> <th></th> <th></th> <th></th> <th></th> <th></th></tr></thead> <tbody><tr><td>BIT</td> <td>FLOAT</td> <td>CHAR</td> <td>TIMESTAMP</td> <td>OTHER</td> <td>UNDEFINED</td></tr> <tr><td>TINYINT</td> <td>REAL</td> <td>VARCHAR</td> <td>BINARY</td> <td>BLOB</td> <td>NVARCHAR</td></tr> <tr><td>SMALLINT</td> <td>DOUBLE</td> <td>LONGVARCHAR</td> <td>VARBINARY</td> <td>CLOB</td> <td>NCHAR</td></tr> <tr><td>INTEGER</td> <td>NUMERIC</td> <td>DATE</td> <td>LONGVARBINARY</td> <td>BOOLEAN</td> <td>NCLOB</td></tr> <tr><td>BIGINT</td> <td>DECIMAL</td> <td>TIME</td> <td>NULL</td> <td>CURSOR</td> <td>ARRAY</td></tr></tbody></table> <p><strong>NVARCHAR</strong> 是一种数据库字段类型，表示可变长度的 Unicode 字符串类型。它在许多数据库系统中都存在，如 Oracle、SQL Server 和 PostgreSQL 等。</p> <p><strong>NVARCHAR</strong> 类型用于存储包含 Unicode 字符的字符串数据。与 VARCHAR 类型不同，NVARCHAR 能够存储多种语言的字符，包括中文、日文、韩文等，而不会出现乱码或字符转换问题。</p> <p>在 MyBatis 中，可以在映射文件（Mapper XML）中使用 <strong>NVARCHAR</strong> 类型来定义数据库字段。示例如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;userResultMap&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;User&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;user_id&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;name&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;user_name&quot;</span> <span class="token assign-left variable">jdbcType</span><span class="token operator">=</span><span class="token string">&quot;NVARCHAR&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在上述示例中，jdbcType=&quot;NVARCHAR&quot; 表示该属性使用 NVARCHAR 数据库类型进行映射。这样可以确保在数据库读取和写入操作中正确地处理 Unicode 字符串。</p> <h3 id="构造方法-constructor"><a href="#构造方法-constructor" class="header-anchor">#</a> 构造方法 constructor</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>idArg<span class="token operator">&gt;</span> 主要用于映射构造函数的主键参数     
<span class="token operator">&lt;</span>arg<span class="token operator">&gt;</span> 则用于映射构造函数的非主键参数或其他需要传递给构造函数的参数   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>通过修改对象属性的方式，可以满足大多数的数据传输对象（Data Transfer Object, DTO）以及绝大部分领域模型的要求。但有些情况下你想使用不可变类。 一般来说，很少改变或基本不变的包含引用或数据的表，很适合使用不可变类。 构造方法注入允许你在初始化时为类设置属性的值，而不用暴露出公有方法。MyBatis 也支持私有属性和私有 JavaBean 属性来完成注入，但有一些人更青睐于通过构造方法进行注入。 constructor 元素就是为此而生的。</p> <p>看看下面这个构造方法:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>public class User <span class="token punctuation">{</span>
   //<span class="token punctuation">..</span>.
   public User<span class="token punctuation">(</span>Integer id, String username, int age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     //<span class="token punctuation">..</span>.
  <span class="token punctuation">}</span>
//<span class="token punctuation">..</span>.
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>为了将结果注入构造方法，MyBatis 需要通过某种方式定位相应的构造方法。 在下面的例子中，MyBatis 搜索一个声明了三个形参的构造方法，参数类型以 java.lang.Integer, java.lang.String 和 int 的顺序给出。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>constructor<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>idArg <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span>/<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>arg <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;String&quot;</span>/<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>arg <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;age&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;_int&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/constructor<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>当你在处理一个带有多个形参的构造方法时，很容易搞乱 arg 元素的顺序。 从版本 3.4.3 开始，可以在指定参数名称的前提下，以任意顺序编写 arg 元素。 为了通过名称来引用构造方法参数，你可以添加 @Param 注解，或者使用 '-parameters' 编译选项并启用 useActualParamName 选项（默认开启）来编译项目。下面是一个等价的例子，尽管函数签名中第二和第三个形参的顺序与 constructor 元素中参数声明的顺序不匹配。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>constructor<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>idArg <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> /<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>arg <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;age&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;_int&quot;</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;age&quot;</span> /<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>arg <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;String&quot;</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> /<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/constructor<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果存在名称和类型相同的可写属性，那么可以省略 javaType 。</p> <p>剩余的属性和规则和普通的 id 和 result 元素是一样的。</p> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>column</td> <td>数据库中的列名，或者是列的别名。一般情况下，这和传递给 resultSet.getString(columnName) 方法的参数一样。</td></tr> <tr><td>javaType</td> <td>一个 Java 类的完全限定名，或一个类型别名（关于内置的类型别名，可以参考上面的表格）。 如果你映射到一个 JavaBean，MyBatis 通常可以推断类型。然而，如果你映射到的是 HashMap，那么你应该明确地指定 javaType 来保证行为与期望的相一致。</td></tr> <tr><td>jdbcType</td> <td>JDBC 类型，所支持的 JDBC 类型参见这个表格之前的“支持的 JDBC 类型”。 只需要在可能执行插入、更新和删除的且允许空值的列上指定 JDBC 类型。这是 JDBC 的要求而非 MyBatis 的要求。如果你直接面向 JDBC 编程，你需要对可能存在空值的列指定这个类型。</td></tr> <tr><td>typeHandler</td> <td>我们在前面讨论过默认的类型处理器。使用这个属性，你可以覆盖默认的类型处理器。 这个属性值是一个类型处理器实现类的完全限定名，或者是类型别名。</td></tr> <tr><td>select</td> <td>用于加载复杂类型属性的映射语句的 ID，它会从 column 属性中指定的列检索数据，作为参数传递给此 select 语句。具体请参考关联元素。</td></tr> <tr><td>resultMap</td> <td>结果映射的 ID，可以将嵌套的结果集映射到一个合适的对象树中。 它可以作为使用额外 select 语句的替代方案。它可以将多表连接操作的结果映射成一个单一的 ResultSet。这样的 ResultSet 将会将包含重复或部分数据重复的结果集。为了将结果集正确地映射到嵌套的对象树中，MyBatis 允许你 “串联”结果映射，以便解决嵌套结果集的问题。想了解更多内容，请参考下面的关联元素。</td></tr> <tr><td>name</td> <td>构造方法形参的名字。从 3.4.3 版本开始，通过指定具体的参数名，你可以以任意顺序写入 arg 元素。参看上面的解释。</td></tr></tbody></table> <h3 id="关联-association-一对一"><a href="#关联-association-一对一" class="header-anchor">#</a> 关联 association 一对一</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;author&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_author_id&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;Author&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_id&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_username&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/association<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>关联（association）元素处理“有一个”类型的关系。 比如，在我们的示例中，一个博客有一个用户。关联结果映射和其它类型的映射工作方式差不多。 你需要指定目标属性名以及属性的javaType（很多时候 MyBatis 可以自己推断出来），在必要的情况下你还可以设置 JDBC 类型，如果你想覆盖获取结果值的过程，还可以设置类型处理器。</p> <p>关联的不同之处是，你需要告诉 MyBatis 如何加载关联。MyBatis 有两种不同的方式加载关联：</p> <ul><li>嵌套 Select 查询：通过执行另外一个 SQL 映射语句来加载期望的复杂类型。
<ul><li>通过多个sql多次查询 组合成一个对象</li></ul></li> <li>嵌套结果映射：使用嵌套的结果映射来处理连接结果的重复子集。
<ul><li>通过一个sql关联多个表查询 组合成一个对象</li></ul></li></ul> <p>首先，先让我们来看看这个元素的属性。你将会发现，和普通的结果映射相比，它只在 select 和 resultMap 属性上有所不同。</p> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>property</td> <td>映射到列结果的字段或属性。如果用来匹配的 JavaBean 存在给定名字的属性，那么它将会被使用。否则 MyBatis 将会寻找给定名称的字段。 无论是哪一种情形，你都可以使用通常的点式分隔形式进行复杂属性导航。 比如，你可以这样映射一些简单的东西：“username”，或者映射到一些复杂的东西上：“address.street.number”。</td></tr> <tr><td>javaType</td> <td>一个 Java 类的完全限定名，或一个类型别名（关于内置的类型别名，可以参考上面的表格）。 如果你映射到一个 JavaBean，MyBatis 通常可以推断类型。然而，如果你映射到的是 HashMap，那么你应该明确地指定 javaType 来保证行为与期望的相一致。</td></tr> <tr><td>jdbcType</td> <td>JDBC 类型，所支持的 JDBC 类型参见这个表格之前的“支持的 JDBC 类型”。 只需要在可能执行插入、更新和删除的且允许空值的列上指定 JDBC 类型。这是 JDBC 的要求而非 MyBatis 的要求。如果你直接面向 JDBC 编程，你需要对可能存在空值的列指定这个类型。</td></tr> <tr><td>typeHandler</td> <td>我们在前面讨论过默认的类型处理器。使用这个属性，你可以覆盖默认的类型处理器。 这个属性值是一个类型处理器实现类的完全限定名，或者是类型别名。</td></tr></tbody></table> <h4 id="关联的嵌套-select-查询"><a href="#关联的嵌套-select-查询" class="header-anchor">#</a> 关联的嵌套 Select 查询</h4> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>column</td> <td>数据库中的列名，或者是列的别名。一般情况下，这和传递给 resultSet.getString(columnName) 方法的参数一样。 注意：在使用复合主键的时候，你可以使用 column=&quot;{prop1=col1,prop2=col2}&quot; 这样的语法来指定多个传递给嵌套 Select 查询语句的列名。这会使得 prop1 和 prop2 作为参数对象，被设置为对应嵌套 Select 语句的参数。</td></tr> <tr><td>select</td> <td>用于加载复杂类型属性的映射语句的 ID，它会从 column 属性指定的列中检索数据，作为参数传递给目标 select 语句。 具体请参考下面的例子。注意：在使用复合主键的时候，你可以使用 column=&quot;{prop1=col1,prop2=col2}&quot; 这样的语法来指定多个传递给嵌套 Select 查询语句的列名。这会使得 prop1 和 prop2 作为参数对象，被设置为对应嵌套 Select 语句的参数。</td></tr> <tr><td>fetchType</td> <td>可选的。有效值为 lazy 和 eager。 指定属性后，将在映射中忽略全局配置参数 lazyLoadingEnabled，使用属性的值。</td></tr></tbody></table> <p>示例：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Blog&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;author&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_id&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;Author&quot;</span> <span class="token assign-left variable">select</span><span class="token operator">=</span><span class="token string">&quot;selectAuthor&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectBlog&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span><span class="token operator">&gt;</span>
  SELECT * FROM BLOG WHERE ID <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectAuthor&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;Author&quot;</span><span class="token operator">&gt;</span>
  SELECT * FROM AUTHOR WHERE ID <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>就是这么简单。我们有两个 select 查询语句：一个用来加载博客（Blog），另外一个用来加载作者（Author），而且博客的结果映射描述了应该使用 selectAuthor 语句通过Blog的<strong>author_id</strong>字段去查询sql 加载它的 author 属性。</p> <p>其它所有的属性将会被自动加载，只要它们的列名和属性名相匹配。</p> <p>这种方式虽然很简单，但在大型数据集或大型数据表上表现不佳。这个问题被称为“N+1 查询问题”。 概括地讲，N+1 查询问题是这样子的：</p> <ul><li>你执行了一个单独的 SQL 语句来获取结果的一个列表（就是“+1”）。</li> <li>对列表返回的每条记录，你执行一个 select 查询语句来为每条记录加载详细信息（就是“N”）。</li></ul> <p>这个问题会导致成百上千的 SQL 语句被执行。有时候，我们不希望产生这样的后果。</p> <p>好消息是，MyBatis 能够对这样的查询进行延迟加载，因此可以将大量语句同时运行的开销分散开来。</p> <p><strong>如何开启关联的嵌套 Select 延迟查询呢?</strong><br>
有两种方式可以开启select 标签的延迟方法。<br>
1、全局开始延迟加载配置</p> <ul><li>mybatis配置文件增加以下配置</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>settings<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span>-- 启用延迟加载 --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>setting <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;lazyLoadingEnabled&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>/<span class="token operator">&gt;</span>
    
    <span class="token operator">&lt;</span><span class="token operator">!</span>-- 禁用激进延迟加载 --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>setting <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;aggressiveLazyLoading&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;false&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/settings<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>lazyLoadingEnabled</strong>:此设置启用关联对象和集合的延迟加载。延迟加载意味着直到显式访问关联对象或集合时，它们才会被加载。通过避免不必要的数据库查询，它有助于提高性能。</p> <p><strong>aggressiveLazyLoading</strong>:当设置为false时，MyBatis将不会主动加载嵌套对象或集合。激进延迟加载可能会导致性能问题，因为它会急切地加载所有嵌套的对象或集合。通过将其设置为false，MyBatis将根据lazyLoadingEnabled设置来延迟加载嵌套的对象或集合。</p> <p>开启当前配置后，mybatis 会为所有  关联(association)、集合(collection)的  select 属性开启延迟加载，知道获取对象、或者对象.toString()等方法的时候再去查询对象相关查询。</p> <p>2、为单个查询开启延迟查询
使用fetchType 标签 ，fetchType 有 lazy与eager 属性，分别是开启与关闭延迟加载</p> <p>下面列子就是开启延迟查询的demo</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;resultMap id=&quot;blogResult&quot; type=&quot;Blog&quot;&gt;
  &lt;association fetchType=&quot;lazy&quot; property=&quot;author&quot; column=&quot;author_id&quot; javaType=&quot;Author&quot; select=&quot;selectAuthor&quot;/&gt;
&lt;/resultMap&gt;

&lt;select id=&quot;selectBlog&quot; resultMap=&quot;blogResult&quot;&gt;
  SELECT * FROM BLOG WHERE ID = #{id}
&lt;/select&gt;

&lt;select id=&quot;selectAuthor&quot; resultType=&quot;Author&quot;&gt;
  SELECT * FROM AUTHOR WHERE ID = #{id}
&lt;/select&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>然而，如果你加载记录列表之后立刻就遍历列表以获取嵌套的数据，就会触发所有的延迟加载查询，性能可能会变得很糟糕。
所以还有另外一种方法。</p> <h4 id="关联的嵌套结果映射"><a href="#关联的嵌套结果映射" class="header-anchor">#</a> 关联的嵌套结果映射</h4> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>resultMap</td> <td>结果映射的 ID，可以将此关联的嵌套结果集映射到一个合适的对象树中。 它可以作为使用额外 select 语句的替代方案。它可以将多表连接操作的结果映射成一个单一的 ResultSet。这样的 ResultSet 有部分数据是重复的。 为了将结果集正确地映射到嵌套的对象树中, MyBatis 允许你“串联”结果映射，以便解决嵌套结果集的问题。使用嵌套结果映射的一个例子在表格以后。</td></tr> <tr><td>columnPrefix</td> <td>当连接多个表时，你可能会不得不使用列别名来避免在 ResultSet 中产生重复的列名。指定 columnPrefix 列名前缀允许你将带有这些前缀的列映射到一个外部的结果映射中。 详细说明请参考后面的例子。</td></tr> <tr><td>notNullColumn</td> <td>默认情况下，在至少一个被映射到属性的列不为空时，子对象才会被创建。 你可以在这个属性上指定非空的列来改变默认行为，指定后，Mybatis 将只在这些列中任意一列非空时才创建一个子对象。可以使用逗号分隔来指定多个列。默认值：未设置（unset）。</td></tr> <tr><td>autoMapping</td> <td>如果设置这个属性，MyBatis 将会为本结果映射开启或者关闭自动映射。 这个属性会覆盖全局的属性 autoMappingBehavior。注意，本属性对外部的结果映射无效，所以不能搭配 select 或 resultMap 元素使用。默认值：未设置（unset）。</td></tr></tbody></table> <p>之前，你已经看到了一个非常复杂的嵌套关联的例子。 下面的例子则是一个非常简单的例子，用于演示嵌套结果映射如何工作。 现在我们将博客表和作者表连接在一起，而不是执行一个独立的查询语句，就像这样：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectBlog&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span>
    B.id            as blog_id,
    B.title         as blog_title,
    B.author_id     as blog_author_id,
    A.id            as author_id,
    A.username      as author_username,
    A.password      as author_password,
    A.email         as author_email,
    A.bio           as author_bio
  from Blog B left outer <span class="token function">join</span> Author A on B.author_id <span class="token operator">=</span> A.id
  where B.id <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>注意查询中的连接，以及为确保结果能够拥有唯一且清晰的名字，我们设置的别名。 这使得进行映射非常简单。现在我们可以映射这个结果：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Blog&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_id&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_title&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;author&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_author_id&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;Author&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;authorResult&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;authorResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Author&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_id&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_username&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_password&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;email&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_email&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;bio&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_bio&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>在上面的例子中，你可以看到，博客（Blog）作者（author）的关联元素委托名为 “authorResult” 的结果映射来加载作者对象的实例。</p> <p>非常重要： id 元素在嵌套结果映射中扮演着非常重要的角色。你应该总是指定一个或多个可以唯一标识结果的属性。 虽然，即使不指定这个属性，MyBatis 仍然可以工作，但是会产生严重的性能问题。 只需要指定可以唯一标识结果的最少属性。显然，你可以选择主键（复合主键也可以）。</p> <p>现在，上面的示例使用了外部的结果映射元素来映射关联。这使得 Author 的结果映射可以被重用。 然而，如果你不打算重用它，或者你更喜欢将你所有的结果映射放在一个具有描述性的结果映射元素中。 你可以直接将结果映射作为子元素嵌套在内。这里给出使用这种方式的等效例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Blog&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_id&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_title&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;author&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;Author&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_id&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_username&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_password&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;email&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_email&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;bio&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_bio&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/association<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>那如果博客（blog）有一个共同作者（co-author）该怎么办？select 语句看起来会是这样的：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectBlog&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span>
    B.id            as blog_id,
    B.title         as blog_title,
    A.id            as author_id,
    A.username      as author_username,
    A.password      as author_password,
    A.email         as author_email,
    A.bio           as author_bio,
    CA.id           as co_author_id,
    CA.username     as co_author_username,
    CA.password     as co_author_password,
    CA.email        as co_author_email,
    CA.bio          as co_author_bio
  from Blog B
  left outer <span class="token function">join</span> Author A on B.author_id <span class="token operator">=</span> A.id
  left outer <span class="token function">join</span> Author CA on B.co_author_id <span class="token operator">=</span> CA.id
  where B.id <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>回忆一下，Author 的结果映射定义如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;authorResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Author&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_id&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_username&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_password&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;email&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_email&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;bio&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_bio&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>由于结果中的列名与结果映射中的列名不同。你需要指定 columnPrefix 以便重复使用该结果映射来映射 co-author 的结果。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Blog&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_id&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_title&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;author&quot;</span>
    <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;authorResult&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;coAuthor&quot;</span>
    <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;authorResult&quot;</span>
    <span class="token assign-left variable">columnPrefix</span><span class="token operator">=</span><span class="token string">&quot;co_&quot;</span> /<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="使用存储过程关联的多结果集-resultset"><a href="#使用存储过程关联的多结果集-resultset" class="header-anchor">#</a> 使用存储过程关联的多结果集（ResultSet）</h4> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>column</td> <td>当使用多个结果集时，该属性指定结果集中用于与 foreignColumn 匹配的列（多个列名以逗号隔开），以识别关系中的父类型与子类型。</td></tr> <tr><td>foreignColumn</td> <td>指定外键对应的列名，指定的列将与父类型中 column 的给出的列进行匹配。</td></tr> <tr><td>resultSet</td> <td>指定用于加载复杂类型的结果集名字。</td></tr></tbody></table> <p>从版本 3.2.3 开始，MyBatis 提供了另一种解决 N+1 查询问题的方法。</p> <p>某些数据库允许存储过程返回多个结果集，或一次性执行多个语句，每个语句返回一个结果集。 我们可以利用这个特性，在不使用连接的情况下，只访问数据库一次就能获得相关数据。</p> <p>在例子中，存储过程执行下面的查询并返回两个结果集。第一个结果集会返回博客（Blog）的结果，第二个则返回作者（Author）的结果。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>SELECT * FROM BLOG WHERE ID <span class="token operator">=</span> <span class="token comment">#{id}</span>

SELECT * FROM AUTHOR WHERE ID <span class="token operator">=</span> <span class="token comment">#{id}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在映射语句中，必须通过 resultSets 属性为每个结果集指定一个名字，多个名字使用逗号隔开。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectBlog&quot;</span> <span class="token assign-left variable">resultSets</span><span class="token operator">=</span><span class="token string">&quot;blogs,authors&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">statementType</span><span class="token operator">=</span><span class="token string">&quot;CALLABLE&quot;</span><span class="token operator">&gt;</span>
  <span class="token punctuation">{</span>call getBlogsAndAuthors<span class="token punctuation">(</span><span class="token comment">#{id,jdbcType=INTEGER,mode=IN})}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>现在我们可以指定使用 “authors” 结果集的数据来填充 “author” 关联：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Blog&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;author&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;Author&quot;</span> <span class="token assign-left variable">resultSet</span><span class="token operator">=</span><span class="token string">&quot;authors&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_id&quot;</span> <span class="token assign-left variable">foreignColumn</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;email&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;email&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;bio&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;bio&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/association<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>测试代码:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>  @Test
    public void <span class="token function-name function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        String path <span class="token operator">=</span> <span class="token string">&quot;config/lazy-config.xml&quot;</span><span class="token punctuation">;</span>
        try <span class="token punctuation">{</span>
            InputStream inputStream <span class="token operator">=</span> Resources.getResourceAsStream<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
            SqlSessionFactory sqlSessionFactory <span class="token operator">=</span> new SqlSessionFactoryBuilder<span class="token punctuation">(</span><span class="token punctuation">)</span>.build<span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            SqlSession sqlSession <span class="token operator">=</span> sqlSessionFactory.openSession<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            LazyMapper lazyMapper <span class="token operator">=</span> sqlSession.getMapper<span class="token punctuation">(</span>LazyMapper.class<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Blog blog <span class="token operator">=</span> lazyMapper.selectBlog<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System.out.println<span class="token punctuation">(</span>blog<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>IOException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            throw new RuntimeException<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>你已经在上面看到了如何处理“有一个”类型的关联。但是该怎么处理“有很多个”类型的关联呢？这就是我们接下来要介绍的。</p> <h3 id="集合-collection-一对多"><a href="#集合-collection-一对多" class="header-anchor">#</a> 集合 collection 一对多</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;collection property=&quot;posts&quot; ofType=&quot;domain.blog.Post&quot;&gt;
  &lt;id property=&quot;id&quot; column=&quot;post_id&quot;/&gt;
  &lt;result property=&quot;subject&quot; column=&quot;post_subject&quot;/&gt;
  &lt;result property=&quot;body&quot; column=&quot;post_body&quot;/&gt;
&lt;/collection&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>集合元素和关联元素几乎是一样的，它们相似的程度之高，以致于没有必要再介绍集合元素的相似部分。 所以让我们来关注它们的不同之处吧。</p> <p>我们来继续上面的示例，一个博客（Blog）只有一个作者（Author)。但一个博客有很多文章（Post)。 在博客类中，这可以用下面的写法来表示：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>private List<span class="token operator">&lt;</span>Post<span class="token operator">&gt;</span> posts<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>要像上面这样，映射嵌套结果集合到一个 List 中，可以使用集合元素。 和关联元素一样，我们可以使用嵌套 Select 查询，或基于连接的嵌套结果映射集合。</p> <h4 id="集合的嵌套-select-查询"><a href="#集合的嵌套-select-查询" class="header-anchor">#</a> 集合的嵌套 Select 查询</h4> <p>首先，让我们看看如何使用嵌套 Select 查询来为博客加载文章。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Blog&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>collection <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;posts&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;ArrayList&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">ofType</span><span class="token operator">=</span><span class="token string">&quot;Post&quot;</span> <span class="token assign-left variable">select</span><span class="token operator">=</span><span class="token string">&quot;selectPostsForBlog&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectBlog&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span><span class="token operator">&gt;</span>
  SELECT * FROM BLOG WHERE ID <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectPostsForBlog&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;Post&quot;</span><span class="token operator">&gt;</span>
  SELECT * FROM POST WHERE BLOG_ID <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>你可能会立刻注意到几个不同，但大部分都和我们上面学习过的关联元素非常相似。 首先，你会注意到我们使用的是集合元素。 接下来你会注意到有一个新的 <strong>“ofType”</strong> 属性。这个属性非常重要，它用来将 JavaBean（或字段）属性的类型和集合存储的类型区分开来。 所以你可以按照下面这样来阅读映射：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>collection <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;posts&quot;</span> <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;ArrayList&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">ofType</span><span class="token operator">=</span><span class="token string">&quot;Post&quot;</span> <span class="token assign-left variable">select</span><span class="token operator">=</span><span class="token string">&quot;selectPostsForBlog&quot;</span>/<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>读作： “posts 是一个存储 Post 的 ArrayList 集合”</p> <p>在一般情况下，MyBatis 可以推断 javaType 属性，因此并不需要填写。所以很多时候你可以简略成：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>collection <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;posts&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">ofType</span><span class="token operator">=</span><span class="token string">&quot;Post&quot;</span> <span class="token assign-left variable">select</span><span class="token operator">=</span><span class="token string">&quot;selectPostsForBlog&quot;</span>/<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>集合 collection 延迟查询与 关联 association 写法相同，在这就不做演示了</strong></p> <h4 id="集合的嵌套结果映射"><a href="#集合的嵌套结果映射" class="header-anchor">#</a> 集合的嵌套结果映射</h4> <p>现在你可能已经猜到了集合的嵌套结果映射是怎样工作的——除了新增的 “ofType” 属性，它和关联的完全相同。</p> <p>首先, 让我们看看对应的 SQL 语句：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectBlog&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span>
  B.id as blog_id,
  B.title as blog_title,
  B.author_id as blog_author_id,
  P.id as post_id,
  P.subject as post_subject,
  P.body as post_body,
  from Blog B
  left outer <span class="token function">join</span> Post P on B.id <span class="token operator">=</span> P.blog_id
  where B.id <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>我们再次连接了博客表和文章表，并且为每一列都赋予了一个有意义的别名，以便映射保持简单。 要映射博客里面的文章集合，就这么简单：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Blog&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_id&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;blog_title&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>collection <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;posts&quot;</span> <span class="token assign-left variable">ofType</span><span class="token operator">=</span><span class="token string">&quot;Post&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;post_id&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;subject&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;post_subject&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;body&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;post_body&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/collection<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>再提醒一次，要记得上面 id 元素的重要性，如果你不记得了，请阅读关联部分的相关部分。</p> <p>如果你喜欢更详略的、可重用的结果映射，你可以使用下面的等价形式：</p> <h4 id="使用存储过程集合的多结果集-resultset"><a href="#使用存储过程集合的多结果集-resultset" class="header-anchor">#</a> 使用存储过程集合的多结果集（ResultSet）</h4> <p>像关联元素那样，我们可以通过执行存储过程实现，它会执行两个查询并返回两个结果集，一个是博客的结果集，另一个是文章的结果集：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>SELECT * FROM BLOG WHERE ID <span class="token operator">=</span> <span class="token comment">#{id}</span>

SELECT * FROM POST WHERE BLOG_ID <span class="token operator">=</span> <span class="token comment">#{id}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在映射语句中，必须通过 resultSets 属性为每个结果集指定一个名字，多个名字使用逗号隔开。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectBlog&quot;</span> <span class="token assign-left variable">resultSets</span><span class="token operator">=</span><span class="token string">&quot;blogs,posts&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span><span class="token operator">&gt;</span>
  <span class="token punctuation">{</span>call getBlogsAndPosts<span class="token punctuation">(</span><span class="token comment">#{id,jdbcType=INTEGER,mode=IN})}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>我们指定 “posts” 集合将会使用存储在 “posts” 结果集中的数据进行填充：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Blog&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>collection <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;posts&quot;</span> <span class="token assign-left variable">ofType</span><span class="token operator">=</span><span class="token string">&quot;Post&quot;</span> <span class="token assign-left variable">resultSet</span><span class="token operator">=</span><span class="token string">&quot;posts&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">foreignColumn</span><span class="token operator">=</span><span class="token string">&quot;blog_id&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;subject&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;subject&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;body&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;body&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/collection<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>注意</strong> 对关联或集合的映射，并没有深度、广度或组合上的要求。但在映射时要留意性能问题。 在探索最佳实践的过程中，应用的单元测试和性能测试会是你的好帮手。 而 MyBatis 的好处在于，可以在不对你的代码引入重大变更（如果有）的情况下，允许你之后改变你的想法。
高级关联和集合映射是一个深度话题。文档的介绍只能到此为止。配合少许的实践，你会很快了解全部的用法。</p> <h3 id="鉴别器-discriminator"><a href="#鉴别器-discriminator" class="header-anchor">#</a> 鉴别器 discriminator</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>discriminator <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;draft&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;1&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;DraftPost&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/discriminator<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>有时候，一个数据库查询可能会返回多个不同的结果集（但总体上还是有一定的联系的）。 鉴别器（discriminator）元素就是被设计来应对这种情况的，另外也能处理其它情况，例如类的继承层次结构。 鉴别器的概念很好理解——它很像 Java 语言中的 switch 语句。</p> <p>一个鉴别器的定义需要指定 column 和 javaType 属性。column 指定了 MyBatis 查询被比较值的地方。 而 javaType 用来确保使用正确的相等测试（虽然很多情况下字符串的相等测试都可以工作）。例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;vehicleResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Vehicle&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;vin&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;vin&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;year&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;year&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;make&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;make&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;model&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;model&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;color&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;color&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>discriminator <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;vehicle_type&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;1&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;carResult&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;2&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;truckResult&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;3&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;vanResult&quot;</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;4&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;suvResult&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/discriminator<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>在这个示例中，MyBatis 会从结果集中得到每条记录，然后比较它的 vehicle type 值。 如果它匹配任意一个鉴别器的 case，就会使用这个 case 指定的结果映射。 这个过程是互斥的，也就是说，剩余的结果映射将被忽略（除非它是扩展的，我们将在稍后讨论它）。 如果不能匹配任何一个 case，MyBatis 就只会使用鉴别器块外定义的结果映射。 所以，如果 carResult 的声明如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;carResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Car&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;doorCount&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;door_count&quot;</span> /<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>那么只有 doorCount 属性会被加载。这是为了即使鉴别器的 case 之间都能分为完全独立的一组，尽管和父结果映射可能没有什么关系。在上面的例子中，我们当然知道 cars 和 vehicles 之间有关系，也就是 Car 是一个 Vehicle。因此，我们希望剩余的属性也能被加载。而这只需要一个小修改。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;carResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Car&quot;</span> <span class="token assign-left variable">extends</span><span class="token operator">=</span><span class="token string">&quot;vehicleResult&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;doorCount&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;door_count&quot;</span> /<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><span style="color:red;"><strong>注意extends的用法</strong></span><br>
现在 vehicleResult 和 carResult 的属性都会被加载了。</p> <p>可能有人又会觉得映射的外部定义有点太冗长了。 因此，对于那些更喜欢简洁的映射风格的人来说，还有另一种语法可以选择。例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;vehicleResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Vehicle&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>id <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;id&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;vin&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;vin&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;year&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;year&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;make&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;make&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;model&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;model&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;color&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;color&quot;</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>discriminator <span class="token assign-left variable">javaType</span><span class="token operator">=</span><span class="token string">&quot;int&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;vehicle_type&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;1&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;carResult&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;doorCount&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;door_count&quot;</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/case<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;2&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;truckResult&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;boxSize&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;box_size&quot;</span> /<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;extendedCab&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;extended_cab&quot;</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/case<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;3&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;vanResult&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;powerSlidingDoor&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;power_sliding_door&quot;</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/case<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>case <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;4&quot;</span> <span class="token assign-left variable">resultType</span><span class="token operator">=</span><span class="token string">&quot;suvResult&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;allWheelDrive&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;all_wheel_drive&quot;</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/case<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/discriminator<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>提示</strong> 请注意，这些都是结果映射，如果你完全不设置任何的 result 元素，MyBatis 将为你自动匹配列和属性。所以上面的例子大多都要比实际的更复杂。 这也表明，大多数数据库的复杂度都比较高，我们不太可能一直依赖于这种机制。</p> <h2 id="自动映射"><a href="#自动映射" class="header-anchor">#</a> 自动映射</h2> <p>正如你在前面一节看到的，在简单的场景下，MyBatis 可以为你自动映射查询结果。但如果遇到复杂的场景，你需要构建一个结果映射。 但是在本节中，你将看到，你可以混合使用这两种策略。让我们深入了解一下自动映射是怎样工作的。</p> <p>当自动映射查询结果时，MyBatis 会获取结果中返回的列名并在 Java 类中查找相同名字的属性（忽略大小写）。 这意味着如果发现了 ID 列和 id 属性，MyBatis 会将列 ID 的值赋给 id 属性。</p> <p>通常数据库列使用大写字母组成的单词命名，单词间用下划线分隔；而 Java 属性一般遵循驼峰命名法约定。为了在这两种命名方式之间启用自动映射，需要将 mapUnderscoreToCamelCase 设置为 true。</p> <p>甚至在提供了结果映射后，自动映射也能工作。在这种情况下，对于每一个结果映射，在 ResultSet 出现的列，如果没有设置手动映射，将被自动映射。在自动映射处理完毕后，再处理手动映射。 在下面的例子中，id 和 userName 列将被自动映射，hashed_password 列将根据配置进行映射。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUsers&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;userResultMap&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span>
    user_id             as <span class="token string">&quot;id&quot;</span>,
    user_name           as <span class="token string">&quot;userName&quot;</span>,
    hashed_password
  from some_table
  where <span class="token function">id</span> <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;userResultMap&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;User&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;hashed_password&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>有三种自动映射等级：</p> <ul><li>NONE - 禁用自动映射。仅对手动映射的属性进行映射。</li> <li>PARTIAL - 对除在内部定义了嵌套结果映射（也就是连接的属性）以外的属性进行映射</li> <li>FULL - 自动映射所有属性。
默认值是 PARTIAL，这是有原因的。当对连接查询的结果使用 FULL 时，连接查询会在同一行中获取多个不同实体的数据，因此可能导致非预期的映射。 下面的例子将展示这种风险：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectBlog&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">select</span>
    B.id,
    B.title,
    A.username,
  from Blog B left outer <span class="token function">join</span> Author A on B.author_id <span class="token operator">=</span> A.id
  where B.id <span class="token operator">=</span> <span class="token comment">#{id}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;blogResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Blog&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>association <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;author&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;authorResult&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;authorResult&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;Author&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;author_username&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>在该结果映射中，Blog 和 Author 均将被自动映射。但是注意 Author 有一个 id 属性，在 ResultSet 中也有一个名为 id 的列，所以 Author 的 id 将填入 Blog 的 id，这可不是你期望的行为。 所以，要谨慎使用 FULL。</p> <p>无论设置的自动映射等级是哪种，你都可以通过在结果映射上设置 autoMapping 属性来为指定的结果映射设置启用/禁用自动映射。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>resultMap <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;userResultMap&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;User&quot;</span> <span class="token assign-left variable">autoMapping</span><span class="token operator">=</span><span class="token string">&quot;false&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>result <span class="token assign-left variable">property</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span> <span class="token assign-left variable">column</span><span class="token operator">=</span><span class="token string">&quot;hashed_password&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/resultMap<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="缓存"><a href="#缓存" class="header-anchor">#</a> 缓存</h2> <p>MyBatis 内置了一个强大的事务性查询缓存机制，它可以非常方便地配置和定制。 为了使它更加强大而且易于配置，我们对 MyBatis 3 中的缓存实现进行了许多改进。</p> <p>mybatis 通常有三种缓存 也叫三级缓存，分别是本地会话缓存(一级缓存)、全局会话缓存(二级缓存)、定制缓存(缓存)</p> <h3 id="一级缓存-本地缓存"><a href="#一级缓存-本地缓存" class="header-anchor">#</a> 一级缓存（本地缓存）：</h3> <p>一级缓存是 MyBatis 默认开启的缓存机制，它是基于线程的缓存。当执行一个 SQL 语句时，查询的结果会被缓存到当前会话（SqlSession）的一级缓存中。之后，如果再次执行相同的 SQL 语句，MyBatis 会首先检查一级缓存中是否存在相同的查询，如果存在，则直接从缓存中获取结果，而不会再次向数据库发送查询请求。一级缓存的作用范围是会话级别，在同一个会话中，多次执行相同的查询会从缓存中获取结果，提高了查询性能。</p> <p>一级缓存：（本地缓存）：sqlSession级别的缓存。一级缓存是一直开启的；SqlSession级别的一个Map
与数据库同一次会话期间查询到的数据会放在本地缓存中。
以后如果需要获取相同的数据，直接从缓存中拿，没必要再去查询数据库；</p> <p>一级缓存失效情况（没有使用到当前一级缓存的情况，效果就是，还需要再向数据库发出查询）：
1、sqlSession不同。
2、sqlSession相同，查询条件不同.(当前一级缓存中还没有这个数据)
3、sqlSession相同，两次查询之间执行了增删改操作(这次增删改可能对当前数据有影响)
4、sqlSession相同，手动清除了一级缓存（缓存清空）</p> <p>默认情况下，mybatis 一级缓存是开启的.如果想关闭一级缓存，需要对查询语句额外配置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;select ...  flushCache=&quot;false&quot;/&gt;

//useCache =&quot;true/false&quot; 影响的是二级缓存，跟一级缓存没有关系
//flushCache 将其设置为 true 后，只要语句被调用，都会导致本地缓存和二级缓存被清空，默认值：false
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="二级缓存-全局缓存"><a href="#二级缓存-全局缓存" class="header-anchor">#</a> 二级缓存（全局缓存）：</h3> <p>二级缓存是基于 Mapper 的namespace 的缓存机制，一个namespace对应一个二级缓存，可以被同一个namespace的多个会话（SqlSession）共享。当启用二级缓存时，查询的结果会被缓存到二级缓存中，供后续的会话共享使用。二级缓存的作用范围是 Mapper 级别，如果在不同的会话中执行相同的查询，MyBatis 会先检查二级缓存中是否存在相同的查询结果，如果存在，则直接从缓存中获取结果，避免了多次查询数据库。需要注意的是，二级缓存的配置需要手动开启，并且需要在 Mapper XML 文件中明确指定哪些语句需要启用二级缓存。</p> <p><strong>工作机制</strong>：<br>
1、一个会话，查询一条数据，这个数据就会被放在当前会话的一级缓存中；<br>
2、如果会话关闭；一级缓存中的数据会被保存到二级缓存中；新的会话查询信息，就可以参照二级缓存中的内容；<br>
3、 不同namespace查出的数据会放在自己对应的缓存中（map）    <br></p> <p><strong>效果</strong>：数据会从二级缓存中获取、查出的数据都会被默认先放在一级缓存中。只有会话提交或者关闭以后，一级缓存中的数据才会转移到二级缓存中<br></p> <p><strong>使用</strong>：<br>
1）、开启全局二级缓存配置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;&lt;br&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2）、去mapper.xml中配置使用二级缓存：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>cache<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/cache<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3）、我们的POJO需要实现序列化接口<br></p> <p>基本上就是这样。这个简单语句的效果如下:</p> <p>映射语句文件中的所有 select 语句的结果将会被缓存。</p> <ul><li>映射语句文件中的所有 insert、update 和 delete 语句会刷新缓存。</li> <li>缓存<strong>默认</strong>会使用最近最少使用算法（LRU, Least Recently Used）算法来清除不需要的缓存。</li> <li>缓存不会定时进行刷新（也就是说，没有刷新间隔）。</li> <li>缓存默认会保存列表或对象（无论查询方法返回哪种）的 1024 个引用。可以只用size 属性指定缓存保存对象的个数</li> <li>缓存会被视为读/写缓存，这意味着获取到的对象并不是共享的，可以安全地被调用者修改，而不干扰其他调用者或线程所做的潜在修改。使用readOnly 指定，readOnly=&quot;true&quot; 缓存与会共享对象，优点是快 缺点是不安全</li></ul> <p><strong>提示</strong> 缓存只作用于 cache 标签所在的映射文件中的语句。如果你混合使用 Java API 和 XML 映射文件，在共用接口中的语句将不会被默认缓存。你需要使用 @CacheNamespaceRef 注解指定缓存作用域。</p> <p>这些属性可以通过 cache 元素的属性来修改。比如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;cache
  eviction=&quot;FIFO&quot;
  flushInterval=&quot;60000&quot;
  size=&quot;512&quot;
  readOnly=&quot;true&quot;/&gt;
  
eviction:缓存的回收策略：
flushInterval：缓存刷新间隔
readOnly:是否只读：
size：缓存存放多少元素；
type=&quot;&quot;：指定自定义缓存的全类名；实现Cache接口即可；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这个更高级的配置创建了一个 FIFO 缓存，每隔 60 秒刷新，最多可以存储结果对象或列表的 512 个引用，而且返回的对象被认为是只读的，因此对它们进行修改可能会在不同线程中的调用者产生冲突。</p> <ul><li>eviction可用的清除策略有：
<ul><li>LRU – 最近最少使用：移除最长时间不被使用的对象(mybatis 默认使用)。</li> <li>FIFO – 先进先出：按对象进入缓存的顺序来移除它们。</li> <li>SOFT – 软引用：基于垃圾回收器状态和软引用规则移除对象。</li> <li>WEAK – 弱引用：更积极地基于垃圾收集器状态和弱引用规则移除对象。</li></ul></li> <li>flushInterval（刷新间隔）属性可以被设置为任意的正整数，设置的值应该是一个以毫秒为单位的合理时间量。 默认情况是不设置，也就是没有刷新间隔，缓存仅仅会在调用语句时刷新。<br></li> <li>size（引用数目）属性可以被设置为任意正整数，需要注意缓存对象的大小和运行环境中可用的内存资源。默认值是 1024。<br></li> <li>readOnly（只读）属性可以被设置为 true 或 false。只读的缓存会给所有调用者返回缓存对象的相同实例。 因此这些对象不能被修改。这就提供了可观的性能提升。而可读写的缓存会（通过序列化）返回缓存对象的拷贝。 速度上会慢一些，但是更安全，因此默认值是 false。<br></li></ul> <p><strong>提示</strong> 二级缓存是事务性的，这意味着当 SqlSession 完成并提交，或者完成并回滚但没有执行带有 flushCache=true 的 insert/delete/update 语句时，缓存会被更新</p> <h3 id="三级缓存-定制缓存"><a href="#三级缓存-定制缓存" class="header-anchor">#</a> 三级缓存（定制缓存）：</h3> <p><strong>使用自定义缓存</strong><br>
除了上述二级缓存的的实现方式，你也可以通过实现自定义缓存或为其他第三方缓存方案创建适配器，来完全覆盖缓存行为。<br>
三级缓存是 MyBatis 3.2.6 版本中引入的一种扩展机制，它允许用户自定义缓存实现。使用三级缓存，你可以使用自己的缓存实现，例如使用第三方缓存库（如 Redis、Ehcache 等）。通过实现 Cache 接口，可以自定义缓存的存储、过期策略等。三级缓存的作用范围是全局级别，不同的会话可以共享同一个自定义的缓存实现。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;cache type=&quot;com.domain.something.MyCustomCache&quot;/&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这个示例展示了如何使用一个自定义的缓存实现。type 属性指定的类必须实现 org.apache.ibatis.cache.Cache 接口，且提供一个接受 String 参数作为 id 的构造器。 这个接口是 MyBatis 框架中许多复杂的接口之一，但是行为却非常简单。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>public interface Cache <span class="token punctuation">{</span>
  String getId<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  int getSize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  void putObject<span class="token punctuation">(</span>Object key, Object value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object getObject<span class="token punctuation">(</span>Object key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  boolean hasKey<span class="token punctuation">(</span>Object key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object removeObject<span class="token punctuation">(</span>Object key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  void clear<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>为了对你的缓存进行配置，只需要简单地在你的缓存实现中添加公有的 JavaBean 属性，然后通过 cache 元素传递属性值，例如，下面的例子将在你的缓存实现上调用一个名为 setCacheFile(String file) 的方法：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>cache <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;com.domain.something.MyCustomCache&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;cacheFile&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;/tmp/my-custom-cache.tmp&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/cache<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>你可以使用所有简单类型作为 JavaBean 属性的类型，MyBatis 会进行转换。 你也可以使用占位符（如 ${cache.file}），以便替换成在配置文件属性中定义的值。</p> <p>从版本 3.4.2 开始，MyBatis 已经支持在所有属性设置完毕之后，调用一个初始化方法。 如果想要使用这个特性，请在你的自定义缓存类里实现 org.apache.ibatis.builder.InitializingObject 接口。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>public interface InitializingObject <span class="token punctuation">{</span>
  void initialize<span class="token punctuation">(</span><span class="token punctuation">)</span> throws Exception<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>提示 二级缓存对缓存的配置（如清除策略、可读或可读写等），不能应用于自定义缓存。</strong></p> <p>请注意，缓存的配置和缓存实例会被绑定到 SQL 映射文件的命名空间中。 因此，同一命名空间中的所有语句和缓存将通过命名空间绑定在一起。 每条语句可以自定义与缓存交互的方式，或将它们完全排除于缓存之外，这可以通过在每条语句上使用两个简单属性来达成。 默认情况下，语句会这样来配置：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>select <span class="token punctuation">..</span>. <span class="token assign-left variable">flushCache</span><span class="token operator">=</span><span class="token string">&quot;false&quot;</span> <span class="token assign-left variable">useCache</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>insert <span class="token punctuation">..</span>. <span class="token assign-left variable">flushCache</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>update <span class="token punctuation">..</span>. <span class="token assign-left variable">flushCache</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>delete <span class="token punctuation">..</span>. <span class="token assign-left variable">flushCache</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>/<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>鉴于这是默认行为，显然你永远不应该以这样的方式显式配置一条语句。但如果你想改变默认的行为，只需要设置 flushCache 和 useCache 属性。比如，某些情况下你可能希望特定 select 语句的结果排除于缓存之外，或希望一条 select 语句清空缓存。类似地，你可能希望某些 update 语句执行时不要刷新缓存。</p> <h3 id="cache-ref"><a href="#cache-ref" class="header-anchor">#</a> cache-ref</h3> <p>回想一下上一节的内容，对某一命名空间的语句，只会使用该命名空间的缓存进行缓存或刷新。 但你可能会想要在多个命名空间中共享相同的缓存配置和实例。要实现这种需求，你可以使用 cache-ref 元素来引用另一个缓存。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>cache-ref <span class="token assign-left variable">namespace</span><span class="token operator">=</span><span class="token string">&quot;com.someone.application.data.SomeMapper&quot;</span>/<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>要想实现不同的mapper 执行相同的sql 命中缓存的情况，需要重新mybatis CacheKey的生成规则。MyBatis 默认的 CacheKey 是基于 Mapper 接口、方法名和参数值生成的，因此不同的 Mapper 接口会生成不同的 CacheKey。</p> <h2 id="mybatis-集成redis-做缓存"><a href="#mybatis-集成redis-做缓存" class="header-anchor">#</a> mybatis 集成redis 做缓存</h2> <p>1、前往mybatis  的github 地址，可以看到很多mybatis 周边的项目。 找到<a href="https://github.com/mybatis" target="_blank" rel="noopener noreferrer">redis-cache <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>项目
<img src="/assets/img/redis_cache.89d47e80.png" alt="redis-cache"></p> <p>2、点开<a href="https://mybatis.org/redis-cache/" target="_blank" rel="noopener noreferrer">See the docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 可以看到其相应的文档</p> <p>其实mybatis引入redis 做缓存很容易，只需要简单的几步</p> <ul><li>1、引入相关jar包</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>dependencies<span class="token operator">&gt;</span>
  <span class="token punctuation">..</span>.
  <span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org.mybatis.caches<span class="token operator">&lt;</span>/groupId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>mybatis-redis<span class="token operator">&lt;</span>/artifactId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>version<span class="token operator">&gt;</span><span class="token number">1.0</span>.0-beta<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>/version<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/dependency<span class="token operator">&gt;</span>
  <span class="token punctuation">..</span>.
<span class="token operator">&lt;</span>/dependencies<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>2、在想要缓存的mapper上写上以下配置</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>mapper <span class="token assign-left variable">namespace</span><span class="token operator">=</span><span class="token string">&quot;org.acme.FooMapper&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>cache <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;org.mybatis.caches.redis.RedisCache&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token punctuation">..</span>.
<span class="token operator">&lt;</span>/mapper<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>3、配置redis连接
Redis 缓存可通过放置/redis.properties类路径资源来配置；如果没有找到，客户端将使用默认设置。
配置文件中找到的任何属性都将设置为 bean JedisConfigPool的属性。还有一个额外的参数host用于设置Redis服务器主机名；如果未设置，将使用“localhost”。</li></ul> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code>//redis.properties
<span class="token key attr-name">host</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1</span>
<span class="token key attr-name">port</span><span class="token punctuation">=</span><span class="token value attr-value">6380</span>
<span class="token key attr-name">password</span><span class="token punctuation">=</span><span class="token value attr-value">123123123</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>4、编写测试代码</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>  @Test
    public void <span class="token function-name function">testRedisCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        String path <span class="token operator">=</span> <span class="token string">&quot;config/mybatis-redis-config.xml&quot;</span><span class="token punctuation">;</span>
        InputStream inputStream <span class="token operator">=</span> null<span class="token punctuation">;</span>
        try <span class="token punctuation">{</span>
            inputStream <span class="token operator">=</span> Resources.getResourceAsStream<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
            SqlSession session <span class="token operator">=</span> new SqlSessionFactoryBuilder<span class="token punctuation">(</span><span class="token punctuation">)</span>.build<span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span>.openSession<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            MybatisRedisMapper mybatisRedisMapper <span class="token operator">=</span> session.getMapper<span class="token punctuation">(</span>MybatisRedisMapper.class<span class="token punctuation">)</span><span class="token punctuation">;</span>

            System.out.println<span class="token punctuation">(</span>mybatisRedisMapper.getById<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
            session.commit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System.out.println<span class="token punctuation">(</span>mybatisRedisMapper.getById<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
            System.out.println<span class="token punctuation">(</span>mybatisRedisMapper.getById<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>IOException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            throw new RuntimeException<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>效果:
<img src="/assets/img/cache.62d04aee.png" alt="命中缓存"></p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://fanxgit.github.io/fanxNotes/edit/master/docs/常用框架/01.mybatis/03.xml映射文件.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=mybatis" title="标签">#mybatis</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">7/13/2023, 6:02:49 PM</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/55c7c2/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">xml配置文件</div></a> <a href="/pages/15becd/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">动态 SQL</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/55c7c2/" class="prev">xml配置文件</a></span> <span class="next"><a href="/pages/15becd/">动态 SQL</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/797621/"><div>
            VuePress+GithubPages教程
            <!----></div></a> <span class="date">11-19</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/016620/"><div>
            java打jar包整理
            <!----></div></a> <span class="date">11-19</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/b23a10/"><div>
            多线程问题总结
            <!----></div></a> <span class="date">11-14</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.38fd400a.js" defer></script><script src="/assets/js/3.e11db813.js" defer></script><script src="/assets/js/323.17573ee3.js" defer></script>
  </body>
</html>
