(window.webpackJsonp=window.webpackJsonp||[]).push([[258],{1144:function(s,a,t){s.exports=t.p+"assets/img/springboot-file-updownload-2.afd03079.png"},1145:function(s,a,t){s.exports=t.p+"assets/img/springboot-file-updownload-1.0c64c5ba.png"},1146:function(s,a,t){s.exports=t.p+"assets/img/springboot-file-updownload-3.692ba94a.png"},1147:function(s,a,t){s.exports=t.p+"assets/img/springboot-file-updownload-4.81a56d69.png"},3706:function(s,a,t){"use strict";t.r(a);var e=t(7),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"▶springboot集成文件-基础的文件上传和下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#▶springboot集成文件-基础的文件上传和下载"}},[s._v("#")]),s._v(" ▶SpringBoot集成文件 - 基础的文件上传和下载")]),s._v(" "),a("blockquote",[a("p",[s._v("项目中常见的功能是需要将数据文件（比如Excel,csv)上传到服务器端进行处理，亦或是将服务器端的数据以某种文件形式（比如excel,pdf,csv,word)下载到客户端。本文主要介绍基于SpringBoot的对常规文件的上传和下载，以及常见的问题等。@pdai")])]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#springboot%E9%9B%86%E6%88%90%E6%96%87%E4%BB%B6---%E5%9F%BA%E7%A1%80%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD"}},[s._v("▶SpringBoot集成文件 - 基础的文件上传和下载")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E7%9F%A5%E8%AF%86%E5%87%86%E5%A4%87"}},[s._v("知识准备")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E5%93%AA%E4%BA%9B%E5%9C%BA%E6%99%AF%E9%9C%80%E8%A6%81%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD"}},[s._v("哪些场景需要文件上传和下载")])])])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E5%AE%9E%E7%8E%B0%E6%A1%88%E4%BE%8B"}},[s._v("实现案例")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#pom%E4%BE%9D%E8%B5%96"}},[s._v("Pom依赖")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"}},[s._v("文件上传")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"}},[s._v("文件下载")])])])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%90%86%E8%A7%A3"}},[s._v("进一步理解")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#springboot%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A4%A7%E5%B0%8F%E5%8F%82%E6%95%B0"}},[s._v("SpringBoot文件上传大小参数？")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"}},[s._v("多个文件上传？")])])])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E7%A4%BA%E4%BE%8B%E6%BA%90%E7%A0%81"}},[s._v("示例源码")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"}},[s._v("参考文章")])])])])]),s._v(" "),a("h1",{attrs:{id:"知识准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#知识准备"}},[s._v("#")]),s._v(" 知识准备")]),s._v(" "),a("hr"),s._v(" "),a("blockquote",[a("p",[s._v("需要理解文件上传和下载的常见场景和技术手段。@pdai")])]),s._v(" "),a("h3",{attrs:{id:"哪些场景需要文件上传和下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#哪些场景需要文件上传和下载"}},[s._v("#")]),s._v(" 哪些场景需要文件上传和下载")]),s._v(" "),a("p",[s._v("项目中常见的功能是需要将数据文件（比如Excel,csv)上传到服务器端进行处理，亦或是将服务器端的数据以某种文件形式（比如excel,pdf,csv,word)下载到客户端。")]),s._v(" "),a("h1",{attrs:{id:"实现案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现案例"}},[s._v("#")]),s._v(" 实现案例")]),s._v(" "),a("hr"),s._v(" "),a("blockquote",[a("p",[s._v("本例子主要展示文件的上传和文件的下载。")])]),s._v(" "),a("h3",{attrs:{id:"pom依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pom依赖"}},[s._v("#")]),s._v(" Pom依赖")]),s._v(" "),a("p",[s._v("引入spring-boot-starter-web即可")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"文件上传"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件上传"}},[s._v("#")]),s._v(" 文件上传")]),s._v(" "),a("p",[s._v("上传一个文件，并保存到本地文件夹中")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('@PostMapping("/upload")\npublic ResponseResult<String> upload(@RequestParam(value = "file", required = true) MultipartFile file) {\n    try {\n        // 本地文件保存位置\n        String uploadPath = "/Users/pdai/uploadFile"; // 改这里\n        File uploadDir = new File(uploadPath);\n        if (!uploadDir.exists()) {\n            uploadDir.mkdir();\n        }\n        log.info(uploadDir.getAbsolutePath());\n\n        // 本地文件\n        File localFile = new File(uploadPath + File.separator + file.getOriginalFilename());\n\n        // transfer to local\n        file.transferTo(localFile);\n    } catch (Exception e) {\n        e.printStackTrace();\n        return ResponseResult.fail(e.getMessage());\n    }\n    return ResponseResult.success();\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("通过postman，模拟上传的请求")]),s._v(" "),a("p",[a("img",{attrs:{src:t(1144),alt:""}})]),s._v(" "),a("p",[s._v("上传文件结果：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(1145),alt:""}})]),s._v(" "),a("h3",{attrs:{id:"文件下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件下载"}},[s._v("#")]),s._v(" 文件下载")]),s._v(" "),a("p",[s._v("从本地文件夹中读取文件，并通过http下载")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('@GetMapping("/download")\npublic void download(HttpServletResponse response) {\n    response.reset();\n    response.setContentType("application/octet-stream");\n    response.setHeader("Content-disposition",\n            "attachment;filename=file_" + System.currentTimeMillis() + ".hprof");\n\n    // 从文件读到servlet response输出流中\n    File file = new File("/Users/pdai/pdai_heap_dump_test.hprof"); // 改这里\n    try (FileInputStream inputStream = new FileInputStream(file);) { // try-with-resources\n        byte[] b = new byte[1024];\n        int len;\n        while ((len = inputStream.read(b)) > 0) {\n            response.getOutputStream().write(b, 0, len);\n        }\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("p",[s._v("下载文件")]),s._v(" "),a("p",[a("img",{attrs:{src:t(1146),alt:""}})]),s._v(" "),a("p",[s._v("注：")]),s._v(" "),a("p",[s._v("如果使用postman下载文件，默认的response大小是50MB，下载大于50MB的文件需要在这里自行设置。")]),s._v(" "),a("p",[a("img",{attrs:{src:t(1147),alt:""}})]),s._v(" "),a("h1",{attrs:{id:"进一步理解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进一步理解"}},[s._v("#")]),s._v(" 进一步理解")]),s._v(" "),a("hr"),s._v(" "),a("blockquote",[a("p",[s._v("通过如下几个问题进一步理解。")])]),s._v(" "),a("h3",{attrs:{id:"springboot文件上传大小参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#springboot文件上传大小参数"}},[s._v("#")]),s._v(" SpringBoot文件上传大小参数？")]),s._v(" "),a("p",[s._v("SpringBoot对上传的文件大小有限制，默认的最大每个文件配置最大为1MB，默认多个文件上传（上传目标文件夹）总大小是10MB。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("spring:\n  servlet:\n    multipart:\n      max-file-size: 1024MB # 单个文件大小\n      max-request-size: 10240MB # 总文件大小（允许存储文件的文件夹大小）\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("更多其它的参数可以参看MultipartProperties类")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('@ConfigurationProperties(prefix = "spring.servlet.multipart", ignoreUnknownFields = false)\npublic class MultipartProperties {\n\n\t/**\n\t * Whether to enable support of multipart uploads.\n\t */\n\tprivate boolean enabled = true;\n\n\t/**\n\t * Intermediate location of uploaded files.\n\t */\n\tprivate String location;\n\n\t/**\n\t * Max file size.\n\t */\n\tprivate DataSize maxFileSize = DataSize.ofMegabytes(1);\n\n\t/**\n\t * Max request size.\n\t */\n\tprivate DataSize maxRequestSize = DataSize.ofMegabytes(10);\n\n\t/**\n\t * Threshold after which files are written to disk.\n\t */\n\tprivate DataSize fileSizeThreshold = DataSize.ofBytes(0);\n\n\t/**\n\t * Whether to resolve the multipart request lazily at the time of file or parameter\n\t * access.\n\t */\n\tprivate boolean resolveLazily = false;\n\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("h3",{attrs:{id:"多个文件上传"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多个文件上传"}},[s._v("#")]),s._v(" 多个文件上传？")]),s._v(" "),a("p",[s._v("Spring支持接收多个文件的，只需要用MultipartFile接收即可")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('@PostMapping("/upload")\npublic ResponseResult<String> upload(MultipartFile[] files) {\n\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h1",{attrs:{id:"示例源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例源码"}},[s._v("#")]),s._v(" 示例源码")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("https://github.com/realpdai/tech-pdai-spring-demos")]),s._v(" "),a("h1",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("https://www.jianshu.com/p/95469ecfbb62")])])}),[],!1,null,null,null);a.default=n.exports}}]);