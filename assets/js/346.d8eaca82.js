(window.webpackJsonp=window.webpackJsonp||[]).push([[346],{1160:function(e,s){e.exports="data:image/png;base64,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"},1161:function(e,s,n){e.exports=n.p+"assets/img/springboot-file-excel-poi-1.30aaa629.png"},3710:function(e,s,n){"use strict";n.r(s);var t=n(7),a=Object(t.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"springboot集成文件-集成poi之excel导入导出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#springboot集成文件-集成poi之excel导入导出"}},[e._v("#")]),e._v(" SpringBoot集成文件 - 集成POI之Excel导入导出")]),e._v(" "),s("blockquote",[s("p",[e._v("Apache POI 是用Java编写的免费开源的跨平台的 Java API，Apache POI提供API给Java程序对Microsoft Office格式档案读和写的功能。本文主要介绍通过SpringBoot集成POI工具实现Excel的导入和导出功能。@pdai")])]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#springboot%E9%9B%86%E6%88%90%E6%96%87%E4%BB%B6---%E9%9B%86%E6%88%90poi%E4%B9%8Bexcel%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA"}},[e._v("SpringBoot集成文件 - 集成POI之Excel导入导出")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#%E7%9F%A5%E8%AF%86%E5%87%86%E5%A4%87"}},[e._v("知识准备")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#%E4%BB%80%E4%B9%88%E6%98%AFpoi"}},[e._v("什么是POI")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#poi%E4%B8%AD%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"}},[e._v("POI中基础概念")])])])]),e._v(" "),s("li",[s("a",{attrs:{href:"#%E5%AE%9E%E7%8E%B0%E6%A1%88%E4%BE%8B"}},[e._v("实现案例")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#pom%E4%BE%9D%E8%B5%96"}},[e._v("Pom依赖")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#%E5%AF%BC%E5%87%BAexcel"}},[e._v("导出Excel")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#%E5%AF%BC%E5%85%A5excel"}},[e._v("导入Excel")])])])]),e._v(" "),s("li",[s("a",{attrs:{href:"#%E7%A4%BA%E4%BE%8B%E6%BA%90%E7%A0%81"}},[e._v("示例源码")])]),e._v(" "),s("li",[s("a",{attrs:{href:"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"}},[e._v("参考文章")])])])])]),e._v(" "),s("h1",{attrs:{id:"知识准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#知识准备"}},[e._v("#")]),e._v(" 知识准备")]),e._v(" "),s("hr"),e._v(" "),s("blockquote",[s("p",[e._v("需要了解POI工具，以及POI对Excel中的对象的封装对应关系。")])]),e._v(" "),s("h3",{attrs:{id:"什么是poi"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是poi"}},[e._v("#")]),e._v(" 什么是POI")]),e._v(" "),s("blockquote",[s("p",[e._v("Apache POI 是用Java编写的免费开源的跨平台的 Java API，Apache POI提供API给Java程序对Microsoft Office格式档案读和写的功能。POI为“Poor Obfuscation Implementation”的首字母缩写，意为“简洁版的模糊实现”。")])]),e._v(" "),s("p",[e._v("Apache POI 是创建和维护操作各种符合Office Open XML（OOXML）标准和微软的OLE 2复合文档格式（OLE2）的Java API。用它可以使用Java读取和创建,修改MS Excel文件.而且,还可以使用Java读取和创建MS Word和MSPowerPoint文件。更多请参考"),s("a",{attrs:{href:"https://poi.apache.org/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方文档 在新窗口打开"),s("OutboundLink")],1),e._v("。")]),e._v(" "),s("h3",{attrs:{id:"poi中基础概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#poi中基础概念"}},[e._v("#")]),e._v(" POI中基础概念")]),e._v(" "),s("blockquote",[s("p",[e._v("生成xls和xlsx有什么区别？POI对Excel中的对象的封装对应关系？")])]),e._v(" "),s("p",[e._v("生成xls和xlsx有什么区别呢？")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("XLS")]),e._v(" "),s("th",[e._v("XLSX")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("只能打开xls格式，无法直接打开xlsx格式")]),e._v(" "),s("td",[e._v("可以直接打开xls、xlsx格式")])]),e._v(" "),s("tr",[s("td",[e._v("只有65536行、256列")]),e._v(" "),s("td",[e._v("可以有1048576行、16384列")])]),e._v(" "),s("tr",[s("td",[e._v("占用空间大")]),e._v(" "),s("td",[e._v("占用空间小，运算速度也会快一点")])])])]),e._v(" "),s("p",[e._v("POI对Excel中的对象的封装对应关系如下：")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("Excel")]),e._v(" "),s("th",[e._v("POI XLS")]),e._v(" "),s("th",[e._v("POI XLSX(Excel 2007+)")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("Excel 文件")]),e._v(" "),s("td",[e._v("HSSFWorkbook （xls）")]),e._v(" "),s("td",[e._v("XSSFWorkbook（xlsx）")])]),e._v(" "),s("tr",[s("td",[e._v("Excel 工作表")]),e._v(" "),s("td",[e._v("HSSFSheet")]),e._v(" "),s("td",[e._v("XSSFSheet")])]),e._v(" "),s("tr",[s("td",[e._v("Excel 行")]),e._v(" "),s("td",[e._v("HSSFRow")]),e._v(" "),s("td",[e._v("XSSFRow")])]),e._v(" "),s("tr",[s("td",[e._v("Excel 单元格")]),e._v(" "),s("td",[e._v("HSSFCell")]),e._v(" "),s("td",[e._v("XSSFCell")])]),e._v(" "),s("tr",[s("td",[e._v("Excel 单元格样式")]),e._v(" "),s("td",[e._v("HSSFCellStyle")]),e._v(" "),s("td",[e._v("HSSFCellStyle")])]),e._v(" "),s("tr",[s("td",[e._v("Excel 颜色")]),e._v(" "),s("td",[e._v("HSSFColor")]),e._v(" "),s("td",[e._v("XSSFColor")])]),e._v(" "),s("tr",[s("td",[e._v("Excel 字体")]),e._v(" "),s("td",[e._v("HSSFFont")]),e._v(" "),s("td",[e._v("XSSFFont")])])])]),e._v(" "),s("h1",{attrs:{id:"实现案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现案例"}},[e._v("#")]),e._v(" 实现案例")]),e._v(" "),s("hr"),e._v(" "),s("blockquote",[s("p",[e._v("这里展示SpringBoot集成POI导出用户列表的和导入用户列表的例子。")])]),e._v(" "),s("h3",{attrs:{id:"pom依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pom依赖"}},[e._v("#")]),e._v(" Pom依赖")]),e._v(" "),s("p",[e._v("引入poi的依赖包")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("<dependency>\n    <groupId>org.apache.poi</groupId>\n    <artifactId>poi</artifactId>\n    <version>5.2.2</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.poi</groupId>\n    <artifactId>poi-ooxml</artifactId>\n    <version>5.2.2</version>\n</dependency>\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br")])]),s("h3",{attrs:{id:"导出excel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导出excel"}},[e._v("#")]),e._v(" 导出Excel")]),e._v(" "),s("p",[e._v("UserController中导出的方法")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('@ApiOperation("Download Excel")\n@GetMapping("/excel/download")\npublic void download(HttpServletResponse response) {\n    try {\n        SXSSFWorkbook workbook = userService.generateExcelWorkbook();\n        response.reset();\n        response.setContentType("application/vnd.ms-excel");\n        response.setHeader("Content-disposition",\n                "attachment;filename=user_excel_" + System.currentTimeMillis() + ".xlsx");\n        OutputStream os = response.getOutputStream();\n        workbook.write(os);\n        workbook.dispose();\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br")])]),s("p",[e._v("UserServiceImple中导出Excel的主方法")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('private static final int POSITION_ROW = 1;\nprivate static final int POSITION_COL = 1;\n\n/**\n  * @return SXSSFWorkbook\n  */\n@Override\npublic SXSSFWorkbook generateExcelWorkbook() {\n    SXSSFWorkbook workbook = new SXSSFWorkbook();\n    Sheet sheet = workbook.createSheet();\n\n    int rows = POSITION_ROW;\n    int cols = POSITION_COL;\n\n    // 表头\n    Row head = sheet.createRow(rows++);\n    String[] columns = new String[]{"ID", "Name", "Email", "Phone", "Description"};\n    int[] colWidths = new int[]{2000, 3000, 5000, 5000, 8000};\n    CellStyle headStyle = getHeadCellStyle(workbook);\n    for (int i = 0; i < columns.length; ++i) {\n        sheet.setColumnWidth(cols, colWidths[i]);\n        addCellWithStyle(head, cols++, headStyle).setCellValue(columns[i]);\n    }\n\n    // 表内容\n    CellStyle bodyStyle = getBodyCellStyle(workbook);\n    for (User user : getUserList()) {\n        cols = POSITION_COL;\n        Row row = sheet.createRow(rows++);\n        addCellWithStyle(row, cols++, bodyStyle).setCellValue(user.getId());\n        addCellWithStyle(row, cols++, bodyStyle).setCellValue(user.getUserName());\n        addCellWithStyle(row, cols++, bodyStyle).setCellValue(user.getEmail());\n        addCellWithStyle(row, cols++, bodyStyle).setCellValue(String.valueOf(user.getPhoneNumber()));\n        addCellWithStyle(row, cols++, bodyStyle).setCellValue(user.getDescription());\n    }\n    return workbook;\n}\n\nprivate Cell addCellWithStyle(Row row, int colPosition, CellStyle cellStyle) {\n    Cell cell = row.createCell(colPosition);\n    cell.setCellStyle(cellStyle);\n    return cell;\n}\n\nprivate List<User> getUserList() {\n    return Collections.singletonList(User.builder()\n            .id(1L).userName("pdai").email("pdai@pdai.tech").phoneNumber(121231231231L)\n            .description("hello world")\n            .build());\n}\n\nprivate CellStyle getHeadCellStyle(Workbook workbook) {\n    CellStyle style = getBaseCellStyle(workbook);\n\n    // fill\n    style.setFillForegroundColor(IndexedColors.GREY_25_PERCENT.getIndex());\n    style.setFillPattern(FillPatternType.SOLID_FOREGROUND);\n\n    return style;\n}\n\nprivate CellStyle getBodyCellStyle(Workbook workbook) {\n    return getBaseCellStyle(workbook);\n}\n\nprivate CellStyle getBaseCellStyle(Workbook workbook) {\n    CellStyle style = workbook.createCellStyle();\n\n    // font\n    Font font = workbook.createFont();\n    font.setBold(true);\n    style.setFont(font);\n\n    // align\n    style.setAlignment(HorizontalAlignment.CENTER);\n    style.setVerticalAlignment(VerticalAlignment.TOP);\n\n    // border\n    style.setBorderBottom(BorderStyle.THIN);\n    style.setBottomBorderColor(IndexedColors.BLACK.getIndex());\n    style.setBorderLeft(BorderStyle.THIN);\n    style.setLeftBorderColor(IndexedColors.BLACK.getIndex());\n    style.setBorderRight(BorderStyle.THIN);\n    style.setRightBorderColor(IndexedColors.BLACK.getIndex());\n    style.setBorderTop(BorderStyle.THIN);\n    style.setTopBorderColor(IndexedColors.BLACK.getIndex());\n\n    return style;\n}\n\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br"),s("span",{staticClass:"line-number"},[e._v("23")]),s("br"),s("span",{staticClass:"line-number"},[e._v("24")]),s("br"),s("span",{staticClass:"line-number"},[e._v("25")]),s("br"),s("span",{staticClass:"line-number"},[e._v("26")]),s("br"),s("span",{staticClass:"line-number"},[e._v("27")]),s("br"),s("span",{staticClass:"line-number"},[e._v("28")]),s("br"),s("span",{staticClass:"line-number"},[e._v("29")]),s("br"),s("span",{staticClass:"line-number"},[e._v("30")]),s("br"),s("span",{staticClass:"line-number"},[e._v("31")]),s("br"),s("span",{staticClass:"line-number"},[e._v("32")]),s("br"),s("span",{staticClass:"line-number"},[e._v("33")]),s("br"),s("span",{staticClass:"line-number"},[e._v("34")]),s("br"),s("span",{staticClass:"line-number"},[e._v("35")]),s("br"),s("span",{staticClass:"line-number"},[e._v("36")]),s("br"),s("span",{staticClass:"line-number"},[e._v("37")]),s("br"),s("span",{staticClass:"line-number"},[e._v("38")]),s("br"),s("span",{staticClass:"line-number"},[e._v("39")]),s("br"),s("span",{staticClass:"line-number"},[e._v("40")]),s("br"),s("span",{staticClass:"line-number"},[e._v("41")]),s("br"),s("span",{staticClass:"line-number"},[e._v("42")]),s("br"),s("span",{staticClass:"line-number"},[e._v("43")]),s("br"),s("span",{staticClass:"line-number"},[e._v("44")]),s("br"),s("span",{staticClass:"line-number"},[e._v("45")]),s("br"),s("span",{staticClass:"line-number"},[e._v("46")]),s("br"),s("span",{staticClass:"line-number"},[e._v("47")]),s("br"),s("span",{staticClass:"line-number"},[e._v("48")]),s("br"),s("span",{staticClass:"line-number"},[e._v("49")]),s("br"),s("span",{staticClass:"line-number"},[e._v("50")]),s("br"),s("span",{staticClass:"line-number"},[e._v("51")]),s("br"),s("span",{staticClass:"line-number"},[e._v("52")]),s("br"),s("span",{staticClass:"line-number"},[e._v("53")]),s("br"),s("span",{staticClass:"line-number"},[e._v("54")]),s("br"),s("span",{staticClass:"line-number"},[e._v("55")]),s("br"),s("span",{staticClass:"line-number"},[e._v("56")]),s("br"),s("span",{staticClass:"line-number"},[e._v("57")]),s("br"),s("span",{staticClass:"line-number"},[e._v("58")]),s("br"),s("span",{staticClass:"line-number"},[e._v("59")]),s("br"),s("span",{staticClass:"line-number"},[e._v("60")]),s("br"),s("span",{staticClass:"line-number"},[e._v("61")]),s("br"),s("span",{staticClass:"line-number"},[e._v("62")]),s("br"),s("span",{staticClass:"line-number"},[e._v("63")]),s("br"),s("span",{staticClass:"line-number"},[e._v("64")]),s("br"),s("span",{staticClass:"line-number"},[e._v("65")]),s("br"),s("span",{staticClass:"line-number"},[e._v("66")]),s("br"),s("span",{staticClass:"line-number"},[e._v("67")]),s("br"),s("span",{staticClass:"line-number"},[e._v("68")]),s("br"),s("span",{staticClass:"line-number"},[e._v("69")]),s("br"),s("span",{staticClass:"line-number"},[e._v("70")]),s("br"),s("span",{staticClass:"line-number"},[e._v("71")]),s("br"),s("span",{staticClass:"line-number"},[e._v("72")]),s("br"),s("span",{staticClass:"line-number"},[e._v("73")]),s("br"),s("span",{staticClass:"line-number"},[e._v("74")]),s("br"),s("span",{staticClass:"line-number"},[e._v("75")]),s("br"),s("span",{staticClass:"line-number"},[e._v("76")]),s("br"),s("span",{staticClass:"line-number"},[e._v("77")]),s("br"),s("span",{staticClass:"line-number"},[e._v("78")]),s("br"),s("span",{staticClass:"line-number"},[e._v("79")]),s("br"),s("span",{staticClass:"line-number"},[e._v("80")]),s("br"),s("span",{staticClass:"line-number"},[e._v("81")]),s("br"),s("span",{staticClass:"line-number"},[e._v("82")]),s("br"),s("span",{staticClass:"line-number"},[e._v("83")]),s("br"),s("span",{staticClass:"line-number"},[e._v("84")]),s("br"),s("span",{staticClass:"line-number"},[e._v("85")]),s("br"),s("span",{staticClass:"line-number"},[e._v("86")]),s("br"),s("span",{staticClass:"line-number"},[e._v("87")]),s("br"),s("span",{staticClass:"line-number"},[e._v("88")]),s("br"),s("span",{staticClass:"line-number"},[e._v("89")]),s("br"),s("span",{staticClass:"line-number"},[e._v("90")]),s("br")])]),s("p",[e._v("导出后的excel如下")]),e._v(" "),s("p",[s("img",{attrs:{src:n(1160),alt:""}})]),e._v(" "),s("h3",{attrs:{id:"导入excel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入excel"}},[e._v("#")]),e._v(" 导入Excel")]),e._v(" "),s("blockquote",[s("p",[e._v("我们将上面导出的excel文件导入。")])]),e._v(" "),s("p",[e._v("UserController中导入的方法")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('@ApiOperation("Upload Excel")\n@PostMapping("/excel/upload")\npublic ResponseResult<String> upload(@RequestParam(value = "file", required = true) MultipartFile file) {\n    try {\n        userService.upload(file.getInputStream());\n    } catch (Exception e) {\n        e.printStackTrace();\n        return ResponseResult.fail(e.getMessage());\n    }\n    return ResponseResult.success();\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br")])]),s("p",[e._v("UserServiceImple中导入Excel的主方法")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('@Override\npublic void upload(InputStream inputStream) throws IOException {\n    XSSFWorkbook book = new XSSFWorkbook(inputStream);\n    XSSFSheet sheet = book.getSheetAt(0);\n    // add some validation here\n\n    // parse data\n    int cols;\n    for (int i = POSITION_ROW; i < sheet.getLastRowNum(); i++) {\n        XSSFRow row = sheet.getRow(i + 1); // 表头不算\n        cols = POSITION_COL;\n        User user = User.builder()\n                .id(getCellLongValue(row.getCell(cols++)))\n                .userName(getCellStringValue(row.getCell(cols++)))\n                .email(getCellStringValue(row.getCell(cols++)))\n                .phoneNumber(Long.parseLong(getCellStringValue(row.getCell(cols++))))\n                .description(getCellStringValue(row.getCell(cols++)))\n                .build();\n        log.info(user.toString());\n    }\n\n    book.close();\n}\n\nprivate String getCellStringValue(XSSFCell cell) {\n    try {\n        if (null!=cell) {\n            return String.valueOf(cell.getStringCellValue());\n        }\n    } catch (Exception e) {\n        return String.valueOf(getCellIntValue(cell));\n    }\n    return "";\n}\n\nprivate long getCellLongValue(XSSFCell cell) {\n    try {\n        if (null!=cell) {\n            return Long.parseLong("" + (long) cell.getNumericCellValue());\n        }\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n    return 0L;\n}\n\nprivate int getCellIntValue(XSSFCell cell) {\n    try {\n        if (null!=cell) {\n            return Integer.parseInt("" + (int) cell.getNumericCellValue());\n        }\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n    return 0;\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br"),s("span",{staticClass:"line-number"},[e._v("23")]),s("br"),s("span",{staticClass:"line-number"},[e._v("24")]),s("br"),s("span",{staticClass:"line-number"},[e._v("25")]),s("br"),s("span",{staticClass:"line-number"},[e._v("26")]),s("br"),s("span",{staticClass:"line-number"},[e._v("27")]),s("br"),s("span",{staticClass:"line-number"},[e._v("28")]),s("br"),s("span",{staticClass:"line-number"},[e._v("29")]),s("br"),s("span",{staticClass:"line-number"},[e._v("30")]),s("br"),s("span",{staticClass:"line-number"},[e._v("31")]),s("br"),s("span",{staticClass:"line-number"},[e._v("32")]),s("br"),s("span",{staticClass:"line-number"},[e._v("33")]),s("br"),s("span",{staticClass:"line-number"},[e._v("34")]),s("br"),s("span",{staticClass:"line-number"},[e._v("35")]),s("br"),s("span",{staticClass:"line-number"},[e._v("36")]),s("br"),s("span",{staticClass:"line-number"},[e._v("37")]),s("br"),s("span",{staticClass:"line-number"},[e._v("38")]),s("br"),s("span",{staticClass:"line-number"},[e._v("39")]),s("br"),s("span",{staticClass:"line-number"},[e._v("40")]),s("br"),s("span",{staticClass:"line-number"},[e._v("41")]),s("br"),s("span",{staticClass:"line-number"},[e._v("42")]),s("br"),s("span",{staticClass:"line-number"},[e._v("43")]),s("br"),s("span",{staticClass:"line-number"},[e._v("44")]),s("br"),s("span",{staticClass:"line-number"},[e._v("45")]),s("br"),s("span",{staticClass:"line-number"},[e._v("46")]),s("br"),s("span",{staticClass:"line-number"},[e._v("47")]),s("br"),s("span",{staticClass:"line-number"},[e._v("48")]),s("br"),s("span",{staticClass:"line-number"},[e._v("49")]),s("br"),s("span",{staticClass:"line-number"},[e._v("50")]),s("br"),s("span",{staticClass:"line-number"},[e._v("51")]),s("br"),s("span",{staticClass:"line-number"},[e._v("52")]),s("br"),s("span",{staticClass:"line-number"},[e._v("53")]),s("br"),s("span",{staticClass:"line-number"},[e._v("54")]),s("br"),s("span",{staticClass:"line-number"},[e._v("55")]),s("br"),s("span",{staticClass:"line-number"},[e._v("56")]),s("br")])]),s("p",[e._v("通过PostMan进行接口测试")]),e._v(" "),s("p",[s("img",{attrs:{src:n(1161),alt:""}})]),e._v(" "),s("p",[e._v("执行接口后，后台的日志如下")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("2022-06-10 21:36:01.720  INFO 15100 --- [nio-8080-exec-2] t.p.s.f.e.p.s.impl.UserServiceImpl       : User(id=1, userName=pdai, email=pdai@pdai.tech, phoneNumber=121231231231, description=hello world)\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h1",{attrs:{id:"示例源码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例源码"}},[e._v("#")]),e._v(" 示例源码")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("https://github.com/realpdai/tech-pdai-spring-demos")]),e._v(" "),s("h1",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[e._v("#")]),e._v(" 参考文章")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("https://poi.apache.org/index.html")])])}),[],!1,null,null,null);s.default=a.exports}}]);