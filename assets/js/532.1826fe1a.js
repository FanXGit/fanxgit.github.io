(window.webpackJsonp=window.webpackJsonp||[]).push([[532],{3661:function(s,n,a){"use strict";a.r(n);var e=a(7),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"▶springboot接口-如何统一接口封装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#▶springboot接口-如何统一接口封装"}},[s._v("#")]),s._v(" ▶SpringBoot接口 - 如何统一接口封装")]),s._v(" "),n("blockquote",[n("p",[s._v("在以SpringBoot开发Restful接口时，统一返回方便前端进行开发和封装，以及出现时给出响应编码和信息。@pdai")])]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"#springboot%E6%8E%A5%E5%8F%A3---%E5%A6%82%E4%BD%95%E7%BB%9F%E4%B8%80%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85"}},[s._v("▶SpringBoot接口 - 如何统一接口封装")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"#restful-api%E6%8E%A5%E5%8F%A3"}},[s._v("RESTful API接口?")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%BB%9F%E4%B8%80%E5%B0%81%E8%A3%85%E6%8E%A5%E5%8F%A3"}},[s._v("为什么要统一封装接口")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E5%AE%9E%E7%8E%B0%E6%A1%88%E4%BE%8B"}},[s._v("实现案例")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"#%E7%8A%B6%E6%80%81%E7%A0%81%E5%B0%81%E8%A3%85"}},[s._v("状态码封装")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E8%BF%94%E5%9B%9E%E5%86%85%E5%AE%B9%E5%B0%81%E8%A3%85"}},[s._v("返回内容封装")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E6%8E%A5%E5%8F%A3%E8%BF%94%E5%9B%9E%E6%97%B6%E8%B0%83%E7%94%A8"}},[s._v("接口返回时调用")])])])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E7%A4%BA%E4%BE%8B%E6%BA%90%E7%A0%81"}},[s._v("示例源码")])])])])]),s._v(" "),n("h1",{attrs:{id:"restful-api接口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#restful-api接口"}},[s._v("#")]),s._v(" RESTful API接口?")]),s._v(" "),n("hr"),s._v(" "),n("ul",[n("li",[n("strong",[s._v("什么是 REST")]),s._v("？")])]),s._v(" "),n("p",[s._v("Representational State Transfer，翻译是“表现层状态转化”。可以总结为一句话："),n("strong",[s._v("REST 是所有 Web 应用都应该遵守的架构设计指导原则")]),s._v("。")]),s._v(" "),n("p",[s._v("面向资源是 REST 最明显的特征，对于同一个资源的一组不同的操作。资源是服务器上一个可命名的抽象概念，资源是以名词为核心来组织的，首先关注的是名词。REST 要求，必须通过统一的接口来对资源执行各种操作。对于每个资源只能执行一组有限的操作。")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("什么是 RESTful API")]),s._v("？")])]),s._v(" "),n("p",[n("strong",[s._v("符合 REST 设计标准的 API")]),s._v("，即 RESTful API。REST 架构设计，遵循的各项标准和准则，就是 HTTP 协议的表现，换句话说，HTTP 协议就是属于 REST 架构的设计模式。比如，无状态，请求-响应。")]),s._v(" "),n("p",[s._v("Restful相关文档可以参考 "),n("a",{attrs:{href:"https://restfulapi.net/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://restfulapi.net/ 在新窗口打开"),n("OutboundLink")],1)]),s._v(" "),n("h1",{attrs:{id:"为什么要统一封装接口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么要统一封装接口"}},[s._v("#")]),s._v(" 为什么要统一封装接口")]),s._v(" "),n("hr"),s._v(" "),n("blockquote",[n("p",[s._v("现在大多数项目采用前后分离的模式进行开发，统一返回方便前端进行开发和封装，以及出现时给出响应编码和信息。")])]),s._v(" "),n("p",[s._v("以查询某个用户接口而言，如果没有封装, 返回结果如下")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "userId": 1,\n  "userName": "赵一"\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("如果封装了，返回正常的结果如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "timestamp": 11111111111,\n  "status": 200,\n  "message": "success",\n  "data": {\n    "userId": 1,\n    "userName": "赵一"\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("异常返回结果如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "timestamp": 11111111111,\n  "status": 10001,\n  "message": "User not exist",\n  "data": null\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h1",{attrs:{id:"实现案例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实现案例"}},[s._v("#")]),s._v(" 实现案例")]),s._v(" "),n("hr"),s._v(" "),n("blockquote",[n("p",[s._v("如何实现上面的封装呢？")])]),s._v(" "),n("h3",{attrs:{id:"状态码封装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#状态码封装"}},[s._v("#")]),s._v(" 状态码封装")]),s._v(" "),n("p",[s._v("这里以常见的状态码为例，包含responseCode 和 description两个属性。")]),s._v(" "),n("p",[s._v("如果还有其它业务状态码，也可以放到这个类中。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('/**\n * @author pdai\n */\n@Getter\n@AllArgsConstructor\npublic enum ResponseStatus {\n\n    SUCCESS("200", "success"),\n    FAIL("500", "failed"),\n\n    HTTP_STATUS_200("200", "ok"),\n    HTTP_STATUS_400("400", "request error"),\n    HTTP_STATUS_401("401", "no authentication"),\n    HTTP_STATUS_403("403", "no authorities"),\n    HTTP_STATUS_500("500", "server error");\n\n    public static final List<ResponseStatus> HTTP_STATUS_ALL = Collections.unmodifiableList(\n            Arrays.asList(HTTP_STATUS_200, HTTP_STATUS_400, HTTP_STATUS_401, HTTP_STATUS_403, HTTP_STATUS_500\n            ));\n\n    /**\n     * response code\n     */\n    private final String responseCode;\n\n    /**\n     * description.\n     */\n    private final String description;\n\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("h3",{attrs:{id:"返回内容封装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#返回内容封装"}},[s._v("#")]),s._v(" 返回内容封装")]),s._v(" "),n("p",[s._v("包含公共的接口返回时间，状态status, 消息message， 以及数据data。")]),s._v(" "),n("p",[s._v("考虑到数据的序列化（比如在网络上传输），这里data有时候还会extends Serializable。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("@Data\n@Builder\npublic class ResponseResult<T> {\n\n    /**\n     * response timestamp.\n     */\n    private long timestamp;\n\n    /**\n     * response code, 200 -> OK.\n     */\n    private String status;\n\n    /**\n     * response message.\n     */\n    private String message;\n\n    /**\n     * response data.\n     */\n    private T data;\n\n    /**\n     * response success result wrapper.\n     *\n     * @param <T> type of data class\n     * @return response result\n     */\n    public static <T> ResponseResult<T> success() {\n        return success(null);\n    }\n\n    /**\n     * response success result wrapper.\n     *\n     * @param data response data\n     * @param <T>  type of data class\n     * @return response result\n     */\n    public static <T> ResponseResult<T> success(T data) {\n        return ResponseResult.<T>builder().data(data)\n                .message(ResponseStatus.SUCCESS.getDescription())\n                .status(ResponseStatus.SUCCESS.getResponseCode())\n                .timestamp(System.currentTimeMillis())\n                .build();\n    }\n\n    /**\n     * response error result wrapper.\n     *\n     * @param message error message\n     * @param <T>     type of data class\n     * @return response result\n     */\n    public static <T extends Serializable> ResponseResult<T> fail(String message) {\n        return fail(null, message);\n    }\n\n    /**\n     * response error result wrapper.\n     *\n     * @param data    response data\n     * @param message error message\n     * @param <T>     type of data class\n     * @return response result\n     */\n    public static <T> ResponseResult<T> fail(T data, String message) {\n        return ResponseResult.<T>builder().data(data)\n                .message(message)\n                .status(ResponseStatus.FAIL.getResponseCode())\n                .timestamp(System.currentTimeMillis())\n                .build();\n    }\n\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br")])]),n("h3",{attrs:{id:"接口返回时调用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#接口返回时调用"}},[s._v("#")]),s._v(" 接口返回时调用")]),s._v(" "),n("p",[s._v("在接口返回时调用, 以用户接口为例")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('/**\n * @author pdai\n */\n@RestController\n@RequestMapping("/user")\npublic class UserController {\n\n    @Autowired\n    private IUserService userService;\n\n    /**\n     * @param user user param\n     * @return user\n     */\n    @ApiOperation("Add/Edit User")\n    @PostMapping("add")\n    public ResponseResult<User> add(User user) {\n        if (user.getId()==null || !userService.exists(user.getId())) {\n            user.setCreateTime(LocalDateTime.now());\n            user.setUpdateTime(LocalDateTime.now());\n            userService.save(user);\n        } else {\n            user.setUpdateTime(LocalDateTime.now());\n            userService.update(user);\n        }\n        return ResponseResult.success(userService.find(user.getId()));\n    }\n\n\n    /**\n     * @return user list\n     */\n    @ApiOperation("Query User One")\n    @GetMapping("edit/{userId}")\n    public ResponseResult<User> edit(@PathVariable("userId") Long userId) {\n        return ResponseResult.success(userService.find(userId));\n    }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br")])]),n("h1",{attrs:{id:"示例源码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#示例源码"}},[s._v("#")]),s._v(" 示例源码")]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("https://github.com/realpdai/tech-pdai-spring-demos")])])}),[],!1,null,null,null);n.default=t.exports}}]);