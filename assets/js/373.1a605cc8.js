(window.webpackJsonp=window.webpackJsonp||[]).push([[373],{2968:function(s,a,t){s.exports=t.p+"assets/img/datart缓存配置.ccb6eec6.png"},2969:function(s,a,t){s.exports=t.p+"assets/img/datart业务层数据源连接池配置.71f51e5f.png"},4016:function(s,a,t){"use strict";t.r(a);var n=t(7),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"datart-目前常规可优化的地方"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#datart-目前常规可优化的地方"}},[s._v("#")]),s._v(" datart 目前常规可优化的地方:")]),s._v(" "),a("h2",{attrs:{id:"_1、缓存优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、缓存优化"}},[s._v("#")]),s._v(" 1、缓存优化")]),s._v(" "),a("h3",{attrs:{id:"_1-1、安装redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、安装redis"}},[s._v("#")]),s._v(" 1.1、安装redis")]),s._v(" "),a("p",[s._v("redis 版本 redis-6.0.8")]),s._v(" "),a("h3",{attrs:{id:"_1-2、增加datart-redis-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、增加datart-redis-配置"}},[s._v("#")]),s._v(" 1.2、增加datart redis 配置")]),s._v(" "),a("p",[s._v("在datart的项目路径下 config/profiles/application-config.yml 添加以下配置")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis config")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123123123")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("该配置文件下已将相关代码注释掉了，解开注释，修改成自己redis服务配置信息即可。")]),s._v(" "),a("p",[s._v("datart 通过开发报表视图可配置"),a("em",[s._v("有是否启用缓存")]),s._v("、与配置"),a("em",[s._v("缓存时间")]),s._v("的选项，做的非常灵活。\n"),a("img",{attrs:{src:t(2968),alt:""}}),s._v(" "),a("br")]),s._v(" "),a("p",[a("em",[s._v("ps:设置过期时间时，时间区间最好分散，不要对应的业务报表数据缓存统一时间过期")])]),s._v(" "),a("h2",{attrs:{id:"_2、spring内置的tomcat-线程池参数优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、spring内置的tomcat-线程池参数优化"}},[s._v("#")]),s._v(" 2、spring内置的tomcat 线程池参数优化")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tomcat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("threads")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##线程池最大连接数")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##最小空闲线程数，默认值为 10。")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("min-spare")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"_3、datart-数据库连接池的参数优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、datart-数据库连接池的参数优化"}},[s._v("#")]),s._v(" 3、datart 数据库连接池的参数优化")]),s._v(" "),a("h3",{attrs:{id:"_3-1-datart-自身平台数据库连接池参数优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-datart-自身平台数据库连接池参数优化"}},[s._v("#")]),s._v(" 3.1 datart 自身平台数据库连接池参数优化")]),s._v(" "),a("p",[s._v("datart 平台存储了大量的数据源、报表信息，点击界面，界面大量的报表信息回频繁查询 自身的平台数据库，所以这块最好做一下连接池的优化")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver-class-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" com.mysql.cj.jdbc.Driver\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" com.alibaba.druid.pool.DruidDataSource\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("datasource.ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token null important"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("datasource.port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("datasource.database"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("datart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),a("span",{pre:!0,attrs:{class:"token important"}},[s._v("&allowMultiQueries=true&characterEncoding=utf-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("datasource.username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("datasource.password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 以下是新增的配置")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("druid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化大小")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("initial-size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最小连接数")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("min-idle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最大连接数")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-active")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取连接时的最大等待时间")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-wait")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 一个连接在池中最小生存的时间，单位是毫秒")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("min-evictable-idle-time-millis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 多久才进行一次检测需要关闭的空闲连接，单位是毫秒")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("time-between-eviction-runs-millis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h3",{attrs:{id:"_3-2-datart业务数据库连接池参数优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-datart业务数据库连接池参数优化"}},[s._v("#")]),s._v(" 3.2 datart业务数据库连接池参数优化")]),s._v(" "),a("p",[s._v("由于增加了缓存层，datart 业务层数据库连接池的的压力应该没有datart 平台数据库的压力大，可不用建立太大的最小连接数\n"),a("img",{attrs:{src:t(2969),alt:""}})])])}),[],!1,null,null,null);a.default=e.exports}}]);