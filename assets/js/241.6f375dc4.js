(window.webpackJsonp=window.webpackJsonp||[]).push([[241],{335:function(n,e,s){n.exports=s.p+"assets/img/tomcat-x-jmx-1.6cdcae3e.jpg"},3382:function(n,e,s){n.exports=s.p+"assets/img/tomcat-x-jmx-2.0a72d1f1.png"},3383:function(n,e,s){n.exports=s.p+"assets/img/tomcat-x-jmx-3.d8cb8273.jpg"},3384:function(n,e,s){n.exports=s.p+"assets/img/tomcat-x-jmx-4.3b8e5d15.jpg"},3385:function(n,e,s){n.exports=s.p+"assets/img/tomcat-x-jmx-5.5bb8082d.jpg"},4202:function(n,e,s){"use strict";s.r(e);var a=s(7),t=Object(a.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"tomcat-组件拓展管理-jmx和mbean"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-组件拓展管理-jmx和mbean"}},[n._v("#")]),n._v(" Tomcat - 组件拓展管理:JMX和MBean")]),n._v(" "),e("p",[n._v("=======================================================")]),n._v(" "),e("blockquote",[e("p",[n._v("我们在前文中讲Lifecycle以及组件，怎么会突然讲JMX和MBean呢？本文通过承接上文Lifecycle讲Tomcat基于JMX的实现。@pdai")])]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#tomcat---%E7%BB%84%E4%BB%B6%E6%8B%93%E5%B1%95%E7%AE%A1%E7%90%86jmx%E5%92%8Cmbean"}},[n._v("Tomcat - 组件拓展管理:JMX和MBean")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E5%BC%95%E5%85%A5"}},[n._v("引入")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BA%86%E8%A7%A3jmx"}},[n._v("为什么要了解JMX")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E4%BB%80%E4%B9%88%E6%98%AFjmx%E5%92%8Cmbean"}},[n._v("什么是JMX和MBean")])])])]),n._v(" "),e("li",[e("a",{attrs:{href:"#jmx%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"}},[n._v("JMX使用案例")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E5%9F%BA%E4%BA%8Ejmx%E7%9A%84%E7%9B%91%E6%8E%A7%E4%BE%8B%E5%AD%90"}},[n._v("基于JMX的监控例子")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E5%9F%BA%E4%BA%8Ejmx%E7%9A%84htmladapter%E6%A1%88%E4%BE%8B"}},[n._v("基于JMX的HTMLAdapter案例")])])])]),n._v(" "),e("li",[e("a",{attrs:{href:"#tomcat%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87jmx%E5%AE%9E%E7%8E%B0%E7%BB%84%E4%BB%B6%E7%AE%A1%E7%90%86"}},[n._v("Tomcat如何通过JMX实现组件管理")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#mbeanregistration"}},[n._v("MBeanRegistration")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#jmxenabled"}},[n._v("JmxEnabled")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#lifecyclembeanbase"}},[n._v("LifecycleMBeanBase")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#jmxenabled%E7%9A%84%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0"}},[n._v("JmxEnabled的接口实现")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#lifecyclebase%E7%9B%B8%E5%85%B3%E6%8E%A5%E5%8F%A3"}},[n._v("LifecycleBase相关接口")])])])])])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"}},[n._v("参考文档")])])])])]),n._v(" "),e("h1",{attrs:{id:"引入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#引入"}},[n._v("#")]),n._v(" 引入")]),n._v(" "),e("hr"),n._v(" "),e("blockquote",[e("p",[n._v("我们在前文中讲Lifecycle以及组件，怎么会突然讲JMX和MBean呢？本文通过承接上文Lifecycle讲Tomcat基于JMX的实现。")])]),n._v(" "),e("h3",{attrs:{id:"为什么要了解jmx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为什么要了解jmx"}},[n._v("#")]),n._v(" 为什么要了解JMX")]),n._v(" "),e("p",[n._v("我们在上文中讲Lifecycle和相关组件时，你会发现其实还设计一块就是左侧的JMX和MBean的实现，即LifecycleMBeanBase.")]),n._v(" "),e("p",[e("img",{attrs:{src:s(335),alt:""}})]),n._v(" "),e("h3",{attrs:{id:"什么是jmx和mbean"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是jmx和mbean"}},[n._v("#")]),n._v(" 什么是JMX和MBean")]),n._v(" "),e("blockquote",[e("p",[n._v("JMX是java1.5中引入的新特性。JMX全称为“Java Management Extension”，即Java管理扩展。")])]),n._v(" "),e("p",[n._v("JMX(Java Management Extensions)是一个为应用程序植入管理功能的框架。JMX是一套标准的代理和服务，实际上，用户可以在任何Java应用程序中使用这些代理和服务实现管理。它使用了最简单的一类javaBean，使用有名的MBean，其内部包含了数据信息，这些信息可能是程序配置信息、模块信息、系统信息、统计信息等。MBean可以操作可读可写的属性、直接操作某些函数。")]),n._v(" "),e("p",[e("strong",[n._v("应用场景")]),n._v("：中间件软件WebLogic的管理页面就是基于JMX开发的，而JBoss则整个系统都基于JMX构架，我们今天讲的Tomcat也是基于JMX开发而来的。")]),n._v(" "),e("p",[n._v("我们看下"),e("strong",[n._v("JMX的结构")])]),n._v(" "),e("p",[e("img",{attrs:{src:s(3382),alt:""}})]),n._v(" "),e("ul",[e("li",[e("strong",[n._v("Probe Level")]),n._v(" 负责资源的检测（获取信息），包含MBeans，通常也叫做Instrumentation Level。MX管理构件（MBean）分为四种形式，分别是标准管理构件（Standard MBean）、动态管理构件（Dynamic MBean）、开放管理构件(Open Mbean)和模型管理构件(Model MBean)。")]),n._v(" "),e("li",[e("strong",[n._v("The Agent Level")]),n._v(" 或者叫做MBean Server（代理服务器），是JMX的核心，连接Mbeans和远程监控程序。")]),n._v(" "),e("li",[e("strong",[n._v("Remote Management Level")]),n._v(" 通过connectors和adaptors来远程操作MBean Server。")])]),n._v(" "),e("h1",{attrs:{id:"jmx使用案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jmx使用案例"}},[n._v("#")]),n._v(" JMX使用案例")]),n._v(" "),e("hr"),n._v(" "),e("blockquote",[e("p",[n._v("上节只是引入和相关概念，这是不够的，你依然需要一个案例来帮助你理解JMX是如何工作的。")])]),n._v(" "),e("h3",{attrs:{id:"基于jmx的监控例子"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基于jmx的监控例子"}},[n._v("#")]),n._v(" 基于JMX的监控例子")]),n._v(" "),e("ul",[e("li",[n._v("ServerImpl - 我们模拟的某个服务器ServerImpl状态")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("public class ServerImpl {\n    public final long startTime;\n    public ServerImpl() {\n        startTime = System.currentTimeMillis();\n    }\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br")])]),e("ul",[e("li",[n._v("由于MXBean规定，标准MBean也要实现一个接口，其所有向外界公开的方法都要在该接口中声明，否则管理系统就不能从中获取信息。此外，该接口的命名有一定的规范：在标准MBean类名后加上MBean后缀。这里的标准MBean类就是ServerMonitor，所以其对应的接口就应该是ServerMonitorMBean。因此ServerMonitorMBean的实现如下")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("public interface ServerMonitorMBean {\n\tpublic long getUpTime();\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br")])]),e("ul",[e("li",[n._v("使用ServerMonitor类来监测ServerImpl的状态，实现如下")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("public class ServerMonitor implements ServerMonitorMBean {\n    private final ServerImpl target;\n    public ServerMonitor(ServerImpl target) {\n        this.target = target;\n    }\n\n    @Override\n    public long getUpTime() {\n        return System.currentTimeMillis() - target.startTime;\n    }\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br")])]),e("ul",[e("li",[n._v("对于管理系统来讲，这些MBean中公开的方法，最终会被JMX转换为属性（Attribute）、监听（Listener）和调用（Invoke）的概念。下面代码中Main类的manage方法就模拟了管理程序是如何获取监测到的属性，并表现监测结果。")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('import javax.management.MBeanServer;\nimport javax.management.MBeanServerFactory;\nimport javax.management.ObjectName;\n\npublic class Main {\n    private static ObjectName objectName;\n    private static MBeanServer mBeanServer;\n\n    public static void main(String[] args) throws Exception {\n        init();\n        manage();\n    }\n\n    private static void init() throws Exception {\n        ServerImpl serverImpl = new ServerImpl();\n        ServerMonitor serverMonitor = new ServerMonitor(serverImpl);\n        mBeanServer = MBeanServerFactory.createMBeanServer();\n        objectName = new ObjectName("objectName:id=ServerMonitor1");\n\n        // 注册到MBeanServer\n        mBeanServer.registerMBean(serverMonitor, objectName);\n    }\n\n    private static void manage() throws Exception {\n        // 获取属性值\n        long upTime = (Long)mBeanServer.getAttribute(objectName, "UpTime");\n        System.out.println(upTime);\n    }\n}\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br")])]),e("ul",[e("li",[n._v("整体流程")])]),n._v(" "),e("p",[e("img",{attrs:{src:s(3383),alt:""}})]),n._v(" "),e("blockquote",[e("p",[n._v("如上步骤就能让你理解常见的Jconsole是如何通过JMX获取属性，对象等监控信息的了。")])]),n._v(" "),e("h3",{attrs:{id:"基于jmx的htmladapter案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基于jmx的htmladapter案例"}},[n._v("#")]),n._v(" 基于JMX的HTMLAdapter案例")]),n._v(" "),e("blockquote",[e("p",[n._v("上面例子，还没有体现adapter展示，比如上述信息在HTML页面中展示出来，再看一个例子")])]),n._v(" "),e("ul",[e("li",[n._v("我们的管理目标")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("public class ControlTarget {\n\tprivate long width;\n\tprivate long length;\n\t\n\tpublic ControlTarget( long width, long length) {\n\t\tthis.width = width;\n\t\tthis.length = length;\n\t}\n\t\n\tpublic long getWidth() {\n\t\treturn width;\n\t}\n\t\n\tpublic long getLength() {\n\t\treturn length;\n\t}\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br")])]),e("ul",[e("li",[n._v("根据标准MBean类抽象出符合规范的MBean类的接口，并修改标准MBean类实现该接口。")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("public interface ControlImplMBean {\n\tpublic long getLength();\n\tpublic long getWidth();\n\tpublic long getArea();\n\tpublic double getLengthWidthRatio();\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br")])]),e("ul",[e("li",[n._v("根据需求，创建管理（目标程序）的类，其中包含操纵和获取（目标程序）特性的方法。这个类就是标准MBean类。")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("public class ControlImpl implements ControlImplMBean {\n\tprivate ControlTarget target;\n\t\n\tpublic ControlImpl(ControlTarget target) {\n\t\tthis.target = target;\n\t}\n\t\n\t@Override\n\tpublic long getLength() {\n\t\treturn target.getLength();\n\t}\n\t\n\t@Override\n\tpublic long getWidth() {\n\t\treturn target.getWidth();\n\t}\n\t\n\t@Override\n\tpublic long getArea() {\n\t\treturn target.getLength() * target.getWidth();\n\t}\n\t\n\t@Override\n\tpublic double getLengthWidthRatio() {\n\t\treturn  target.getLength() * 1.0f / target.getWidth();\n\t}\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br")])]),e("ul",[e("li",[n._v("创建MBean的代理类，代理中包含创建MBeanServer、生成ObjectName、注册MBean、表现MBean")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('import com.sun.jdmk.comm.HtmlAdaptorServer;\n\nimport javax.management.*;\n\npublic class ControlImplAgent {\n\n    public static void main(String[] args) throws MalformedObjectNameException, NullPointerException, InstanceAlreadyExistsException, MBeanRegistrationException, NotCompliantMBeanException {\n\n        // 创建MBeanServer\n        MBeanServer server = MBeanServerFactory.createMBeanServer();\n\n        // 为MBean创建ObjectName\n        ObjectName controlImplName = new ObjectName("controlImpl:name=firstOne");\n\n        // 注册MBean到Server中\n        server.registerMBean(new ControlImpl(new ControlTarget(50, 200)), controlImplName);\n\n        // 表现MBean(一种方式)\n        ObjectName adapterName = new ObjectName("ControlImpl:name=htmladapter,port=8082");\n        HtmlAdaptorServer adapter = new HtmlAdaptorServer();\n        server.registerMBean(adapter, adapterName);\n\n        adapter.start();\n        //adapter.stop();\n    }\n\n}\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br")])]),e("ul",[e("li",[n._v("打开相关页面")])]),n._v(" "),e("p",[n._v("PS：相关Adapter可以通过这里下载https://download.csdn.net/download/com_ma/10379741")]),n._v(" "),e("p",[e("img",{attrs:{src:s(3384),alt:""}})]),n._v(" "),e("p",[n._v("点击最后一个链接")]),n._v(" "),e("p",[e("img",{attrs:{src:s(3385),alt:""}})]),n._v(" "),e("h1",{attrs:{id:"tomcat如何通过jmx实现组件管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tomcat如何通过jmx实现组件管理"}},[n._v("#")]),n._v(" Tomcat如何通过JMX实现组件管理")]),n._v(" "),e("hr"),n._v(" "),e("blockquote",[e("p",[n._v("在简单理解了JMX概念和案例之后，我们便可以开始学习Tomcat基于JMX的实现了。")])]),n._v(" "),e("p",[e("img",{attrs:{src:s(335),alt:""}})]),n._v(" "),e("p",[n._v("上述图中，我们看下相关的类的用途")]),n._v(" "),e("ul",[e("li",[e("p",[e("code",[n._v("MBeanRegistration")]),n._v("：Java JMX框架提供的注册MBean的接口，引入此接口是为了便于使用JMX提供的管理功能；")])]),n._v(" "),e("li",[e("p",[e("code",[n._v("JmxEnabled")]),n._v(": 此接口由组件实现，这些组件在创建时将注册到MBean服务器，在销毁时将注销这些组件。它主要是由实现生命周期的组件来实现的，但并不是专门为它们实现的。")])]),n._v(" "),e("li",[e("p",[e("code",[n._v("LifecycleMBeanBase")]),n._v("：Tomcat提供的对MBeanRegistration的抽象实现类，运用抽象模板模式将所有容器统一注册到JMX；")])])]),n._v(" "),e("p",[n._v("此外，ContainerBase、StandardServer、StandardService、WebappLoader、Connector、StandardContext、StandardEngine、StandardHost、StandardWrapper等容器都继承了LifecycleMBeanBase，因此这些容器都具有了同样的生命周期并可以通过JMX进行管理。")]),n._v(" "),e("h3",{attrs:{id:"mbeanregistration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mbeanregistration"}},[n._v("#")]),n._v(" MBeanRegistration")]),n._v(" "),e("p",[n._v("理解MBeanRegistration主要在于:")]),n._v(" "),e("ul",[e("li",[n._v("两块内容：registered 和 unregistered")]),n._v(" "),e("li",[n._v("两类方法：before和after")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("public interface MBeanRegistration   {\n\n    // 在注册之前执行的方法，如果发生异常，MBean不会注册到MBean Server中\n    public ObjectName preRegister(MBeanServer server,\n                                  ObjectName name) throws java.lang.Exception;\n    // 在注册之后执行的方法，比如注册失败提供报错信息\n    public void postRegister(Boolean registrationDone);\n\n\n    // 在卸载前执行的方法\n    public void preDeregister() throws java.lang.Exception ;\n    // 在执行卸载之后的方法\n    public void postDeregister();\n\n }\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br")])]),e("h3",{attrs:{id:"jmxenabled"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jmxenabled"}},[n._v("#")]),n._v(" JmxEnabled")]),n._v(" "),e("p",[n._v("理解JmxEnabled：在设计上它引一个域（Domain）对注册的MBeans进行隔离，这个域类似于MBean上层的命名空间一样。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("public interface JmxEnabled extends MBeanRegistration {\n\n    // 获取MBean所属于的Domain\n    String getDomain();\n\n    // 设置Domain\n    void setDomain(String domain);\n\n    // 获取MBean的名字\n    ObjectName getObjectName();\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br")])]),e("h3",{attrs:{id:"lifecyclembeanbase"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lifecyclembeanbase"}},[n._v("#")]),n._v(" LifecycleMBeanBase")]),n._v(" "),e("p",[n._v("这样理解LifecycleMBeanBase时，你便知道它包含两块，一个是Lifecycle的接口实现，一个是Jmx接口封装实现。")]),n._v(" "),e("p",[n._v("从它实现的类继承和实现关系便能看出：")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("public abstract class LifecycleMBeanBase extends LifecycleBase\n        implements JmxEnabled {\n\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br")])]),e("h4",{attrs:{id:"jmxenabled的接口实现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jmxenabled的接口实现"}},[n._v("#")]),n._v(" JmxEnabled的接口实现")]),n._v(" "),e("ul",[e("li",[n._v("Domain和mBeanName相关，代码很简单，不做详解")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("/* Cache components of the MBean registration. */\nprivate String domain = null;\nprivate ObjectName oname = null;\n@Deprecated\nprotected MBeanServer mserver = null;\n\n/**\n  * Specify the domain under which this component should be registered. Used\n  * with components that cannot (easily) navigate the component hierarchy to\n  * determine the correct domain to use.\n  */\n@Override\npublic final void setDomain(String domain) {\n    this.domain = domain;\n}\n\n\n/**\n  * Obtain the domain under which this component will be / has been\n  * registered.\n  */\n@Override\npublic final String getDomain() {\n    if (domain == null) {\n        domain = getDomainInternal();\n    }\n\n    if (domain == null) {\n        domain = Globals.DEFAULT_MBEAN_DOMAIN;\n    }\n\n    return domain;\n}\n\n\n/**\n  * Method implemented by sub-classes to identify the domain in which MBeans\n  * should be registered.\n  *\n  * @return  The name of the domain to use to register MBeans.\n  */\nprotected abstract String getDomainInternal();\n\n\n/**\n  * Obtain the name under which this component has been registered with JMX.\n  */\n@Override\npublic final ObjectName getObjectName() {\n    return oname;\n}\n\n\n/**\n  * Allow sub-classes to specify the key properties component of the\n  * {@link ObjectName} that will be used to register this component.\n  *\n  * @return  The string representation of the key properties component of the\n  *          desired {@link ObjectName}\n  */\nprotected abstract String getObjectNameKeyProperties();\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br"),e("span",{staticClass:"line-number"},[n._v("47")]),e("br"),e("span",{staticClass:"line-number"},[n._v("48")]),e("br"),e("span",{staticClass:"line-number"},[n._v("49")]),e("br"),e("span",{staticClass:"line-number"},[n._v("50")]),e("br"),e("span",{staticClass:"line-number"},[n._v("51")]),e("br"),e("span",{staticClass:"line-number"},[n._v("52")]),e("br"),e("span",{staticClass:"line-number"},[n._v("53")]),e("br"),e("span",{staticClass:"line-number"},[n._v("54")]),e("br"),e("span",{staticClass:"line-number"},[n._v("55")]),e("br"),e("span",{staticClass:"line-number"},[n._v("56")]),e("br"),e("span",{staticClass:"line-number"},[n._v("57")]),e("br"),e("span",{staticClass:"line-number"},[n._v("58")]),e("br"),e("span",{staticClass:"line-number"},[n._v("59")]),e("br"),e("span",{staticClass:"line-number"},[n._v("60")]),e("br"),e("span",{staticClass:"line-number"},[n._v("61")]),e("br")])]),e("ul",[e("li",[n._v("注册和卸载的相关方法")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("/**\n  * Utility method to enable sub-classes to easily register additional\n  * components that don't implement {@link JmxEnabled} with an MBean server.\n  * <br>\n  * Note: This method should only be used once {@link #initInternal()} has\n  * been called and before {@link #destroyInternal()} has been called.\n  *\n  * @param obj                       The object the register\n  * @param objectNameKeyProperties   The key properties component of the\n  *                                  object name to use to register the\n  *                                  object\n  *\n  * @return  The name used to register the object\n  */\nprotected final ObjectName register(Object obj,\n        String objectNameKeyProperties) {\n\n    // Construct an object name with the right domain\n    StringBuilder name = new StringBuilder(getDomain());\n    name.append(':');\n    name.append(objectNameKeyProperties);\n\n    ObjectName on = null;\n\n    try {\n        on = new ObjectName(name.toString());\n        Registry.getRegistry(null, null).registerComponent(obj, on, null);\n    } catch (MalformedObjectNameException e) {\n        log.warn(sm.getString(\"lifecycleMBeanBase.registerFail\", obj, name),\n                e);\n    } catch (Exception e) {\n        log.warn(sm.getString(\"lifecycleMBeanBase.registerFail\", obj, name),\n                e);\n    }\n\n    return on;\n}\n\n\n/**\n  * Utility method to enable sub-classes to easily unregister additional\n  * components that don't implement {@link JmxEnabled} with an MBean server.\n  * <br>\n  * Note: This method should only be used once {@link #initInternal()} has\n  * been called and before {@link #destroyInternal()} has been called.\n  *\n  * @param objectNameKeyProperties   The key properties component of the\n  *                                  object name to use to unregister the\n  *                                  object\n  */\nprotected final void unregister(String objectNameKeyProperties) {\n    // Construct an object name with the right domain\n    StringBuilder name = new StringBuilder(getDomain());\n    name.append(':');\n    name.append(objectNameKeyProperties);\n    Registry.getRegistry(null, null).unregisterComponent(name.toString());\n}\n\n\n/**\n  * Utility method to enable sub-classes to easily unregister additional\n  * components that don't implement {@link JmxEnabled} with an MBean server.\n  * <br>\n  * Note: This method should only be used once {@link #initInternal()} has\n  * been called and before {@link #destroyInternal()} has been called.\n  *\n  * @param on    The name of the component to unregister\n  */\nprotected final void unregister(ObjectName on) {\n    Registry.getRegistry(null, null).unregisterComponent(on);\n}\n\n\n/**\n  * Not used - NOOP.\n  */\n@Override\npublic final void postDeregister() {\n    // NOOP\n}\n\n\n/**\n  * Not used - NOOP.\n  */\n@Override\npublic final void postRegister(Boolean registrationDone) {\n    // NOOP\n}\n\n\n/**\n  * Not used - NOOP.\n  */\n@Override\npublic final void preDeregister() throws Exception {\n    // NOOP\n}\n\n\n/**\n  * Allows the object to be registered with an alternative\n  * {@link MBeanServer} and/or {@link ObjectName}.\n  */\n@Override\npublic final ObjectName preRegister(MBeanServer server, ObjectName name)\n        throws Exception {\n\n    this.mserver = server;\n    this.oname = name;\n    this.domain = name.getDomain().intern();\n\n    return oname;\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br"),e("span",{staticClass:"line-number"},[n._v("47")]),e("br"),e("span",{staticClass:"line-number"},[n._v("48")]),e("br"),e("span",{staticClass:"line-number"},[n._v("49")]),e("br"),e("span",{staticClass:"line-number"},[n._v("50")]),e("br"),e("span",{staticClass:"line-number"},[n._v("51")]),e("br"),e("span",{staticClass:"line-number"},[n._v("52")]),e("br"),e("span",{staticClass:"line-number"},[n._v("53")]),e("br"),e("span",{staticClass:"line-number"},[n._v("54")]),e("br"),e("span",{staticClass:"line-number"},[n._v("55")]),e("br"),e("span",{staticClass:"line-number"},[n._v("56")]),e("br"),e("span",{staticClass:"line-number"},[n._v("57")]),e("br"),e("span",{staticClass:"line-number"},[n._v("58")]),e("br"),e("span",{staticClass:"line-number"},[n._v("59")]),e("br"),e("span",{staticClass:"line-number"},[n._v("60")]),e("br"),e("span",{staticClass:"line-number"},[n._v("61")]),e("br"),e("span",{staticClass:"line-number"},[n._v("62")]),e("br"),e("span",{staticClass:"line-number"},[n._v("63")]),e("br"),e("span",{staticClass:"line-number"},[n._v("64")]),e("br"),e("span",{staticClass:"line-number"},[n._v("65")]),e("br"),e("span",{staticClass:"line-number"},[n._v("66")]),e("br"),e("span",{staticClass:"line-number"},[n._v("67")]),e("br"),e("span",{staticClass:"line-number"},[n._v("68")]),e("br"),e("span",{staticClass:"line-number"},[n._v("69")]),e("br"),e("span",{staticClass:"line-number"},[n._v("70")]),e("br"),e("span",{staticClass:"line-number"},[n._v("71")]),e("br"),e("span",{staticClass:"line-number"},[n._v("72")]),e("br"),e("span",{staticClass:"line-number"},[n._v("73")]),e("br"),e("span",{staticClass:"line-number"},[n._v("74")]),e("br"),e("span",{staticClass:"line-number"},[n._v("75")]),e("br"),e("span",{staticClass:"line-number"},[n._v("76")]),e("br"),e("span",{staticClass:"line-number"},[n._v("77")]),e("br"),e("span",{staticClass:"line-number"},[n._v("78")]),e("br"),e("span",{staticClass:"line-number"},[n._v("79")]),e("br"),e("span",{staticClass:"line-number"},[n._v("80")]),e("br"),e("span",{staticClass:"line-number"},[n._v("81")]),e("br"),e("span",{staticClass:"line-number"},[n._v("82")]),e("br"),e("span",{staticClass:"line-number"},[n._v("83")]),e("br"),e("span",{staticClass:"line-number"},[n._v("84")]),e("br"),e("span",{staticClass:"line-number"},[n._v("85")]),e("br"),e("span",{staticClass:"line-number"},[n._v("86")]),e("br"),e("span",{staticClass:"line-number"},[n._v("87")]),e("br"),e("span",{staticClass:"line-number"},[n._v("88")]),e("br"),e("span",{staticClass:"line-number"},[n._v("89")]),e("br"),e("span",{staticClass:"line-number"},[n._v("90")]),e("br"),e("span",{staticClass:"line-number"},[n._v("91")]),e("br"),e("span",{staticClass:"line-number"},[n._v("92")]),e("br"),e("span",{staticClass:"line-number"},[n._v("93")]),e("br"),e("span",{staticClass:"line-number"},[n._v("94")]),e("br"),e("span",{staticClass:"line-number"},[n._v("95")]),e("br"),e("span",{staticClass:"line-number"},[n._v("96")]),e("br"),e("span",{staticClass:"line-number"},[n._v("97")]),e("br"),e("span",{staticClass:"line-number"},[n._v("98")]),e("br"),e("span",{staticClass:"line-number"},[n._v("99")]),e("br"),e("span",{staticClass:"line-number"},[n._v("100")]),e("br"),e("span",{staticClass:"line-number"},[n._v("101")]),e("br"),e("span",{staticClass:"line-number"},[n._v("102")]),e("br"),e("span",{staticClass:"line-number"},[n._v("103")]),e("br"),e("span",{staticClass:"line-number"},[n._v("104")]),e("br"),e("span",{staticClass:"line-number"},[n._v("105")]),e("br"),e("span",{staticClass:"line-number"},[n._v("106")]),e("br"),e("span",{staticClass:"line-number"},[n._v("107")]),e("br"),e("span",{staticClass:"line-number"},[n._v("108")]),e("br"),e("span",{staticClass:"line-number"},[n._v("109")]),e("br"),e("span",{staticClass:"line-number"},[n._v("110")]),e("br"),e("span",{staticClass:"line-number"},[n._v("111")]),e("br"),e("span",{staticClass:"line-number"},[n._v("112")]),e("br"),e("span",{staticClass:"line-number"},[n._v("113")]),e("br"),e("span",{staticClass:"line-number"},[n._v("114")]),e("br")])]),e("h4",{attrs:{id:"lifecyclebase相关接口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lifecyclebase相关接口"}},[n._v("#")]),n._v(" LifecycleBase相关接口")]),n._v(" "),e("p",[n._v("这样你就知道这里抽象出的LifecycleBase如下两个方法的用意，就是为了注册和卸载MBean")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("/**\n注册MBean\n  */\n@Override\nprotected void initInternal() throws LifecycleException {\n    // If oname is not null then registration has already happened via\n    // preRegister().\n    if (oname == null) {\n        mserver = Registry.getRegistry(null, null).getMBeanServer();\n\n        oname = register(this, getObjectNameKeyProperties());\n    }\n}\n\n\n/**\n  卸载MBean\n  */\n@Override\nprotected void destroyInternal() throws LifecycleException {\n    unregister(oname);\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br")])]),e("h1",{attrs:{id:"参考文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[n._v("#")]),n._v(" 参考文档")]),n._v(" "),e("hr"),n._v(" "),e("p",[n._v("JMX例子整理自：")]),n._v(" "),e("ul",[e("li",[e("p",[n._v("https://blog.csdn.net/xiaoxiaoyusheng2012/article/details/52101083")])]),n._v(" "),e("li",[e("p",[n._v("https://www.cnblogs.com/dongguacai/p/5900507.html)")])])])])}),[],!1,null,null,null);e.default=t.exports}}]);