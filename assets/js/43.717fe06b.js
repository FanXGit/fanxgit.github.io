(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{3414:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-1.f18ee086.png"},3415:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-2.1c7efdf3.png"},3416:function(s,e){s.exports="data:image/png;base64,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"},3417:function(s,e){s.exports="data:image/png;base64,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"},3418:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-6.d96dfe2f.png"},3419:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-7.495dd2cf.png"},3420:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-8.f70b6c33.png"},3421:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-9.4e7c90a2.png"},3422:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-10.ba2cad27.png"},3423:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-11.013f3211.png"},3424:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-12.d094b560.png"},3425:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-13.94e37df9.png"},3426:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-14.8ab4a261.png"},3427:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-15.6b8704f6.png"},3428:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-16.54fd53f9.png"},3429:function(s,e,a){s.exports=a.p+"assets/img/mybatis-y-dynamic-sql-17.79d9a73b.png"},4217:function(s,e,a){"use strict";a.r(e);var n=a(7),t=Object(n.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"mybatis详解-动态sql使用与原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mybatis详解-动态sql使用与原理"}},[s._v("#")]),s._v(" MyBatis详解 - 动态SQL使用与原理")]),s._v(" "),e("p",[s._v("=================================================")]),s._v(" "),e("blockquote",[e("p",[s._v("动态 SQL 是 MyBatis 的强大特性之一。如果你使用过 JDBC 或其它类似的框架，你应该能理解根据不同条件拼接 SQL 语句有多痛苦，例如拼接时要确保不能忘记添加必要的空格，还要注意去掉列表最后一个列名的逗号。利用动态 SQL，可以彻底摆脱这种痛苦。@pdai")])]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#mybatis%E8%AF%A6%E8%A7%A3---%E5%8A%A8%E6%80%81sql%E4%BD%BF%E7%94%A8%E4%B8%8E%E5%8E%9F%E7%90%86"}},[s._v("MyBatis详解 - 动态SQL使用与原理")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E5%8A%A8%E6%80%81sql%E5%AE%98%E6%96%B9%E4%BD%BF%E7%94%A8%E5%8F%82%E8%80%83"}},[s._v("动态SQL官方使用参考")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#if"}},[s._v("if")])]),s._v(" "),e("li",[e("a",{attrs:{href:"#choosewhenotherwise"}},[s._v("choose、when、otherwise")])]),s._v(" "),e("li",[e("a",{attrs:{href:"#trimwhereset"}},[s._v("trim、where、set")])]),s._v(" "),e("li",[e("a",{attrs:{href:"#foreach"}},[s._v("foreach")])]),s._v(" "),e("li",[e("a",{attrs:{href:"#script"}},[s._v("script")])]),s._v(" "),e("li",[e("a",{attrs:{href:"#bind"}},[s._v("bind")])]),s._v(" "),e("li",[e("a",{attrs:{href:"#%E5%A4%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E6%94%AF%E6%8C%81"}},[s._v("多数据库支持")])]),s._v(" "),e("li",[e("a",{attrs:{href:"#%E5%8A%A8%E6%80%81-sql-%E4%B8%AD%E7%9A%84%E6%8F%92%E5%85%A5%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80"}},[s._v("动态 SQL 中的插入脚本语言")])])])]),s._v(" "),e("li",[e("a",{attrs:{href:"#%E5%8A%A8%E6%80%81sql%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86"}},[s._v("动态SQL解析原理")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E5%85%B3%E4%BA%8E%E5%8A%A8%E6%80%81sql%E7%9A%84%E6%8E%A5%E5%8F%A3%E5%92%8C%E7%B1%BB"}},[s._v("关于动态SQL的接口和类")])]),s._v(" "),e("li",[e("a",{attrs:{href:"#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E8%B5%B0%E8%B5%B7"}},[s._v("源码分析走起")])]),s._v(" "),e("li",[e("a",{attrs:{href:"#%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90"}},[s._v("实例分析")])])])])])])]),s._v(" "),e("h1",{attrs:{id:"动态sql官方使用参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#动态sql官方使用参考"}},[s._v("#")]),s._v(" 动态SQL官方使用参考")]),s._v(" "),e("hr"),s._v(" "),e("p",[s._v("动态 SQL 是 MyBatis 的强大特性之一。如果你使用过 JDBC 或其它类似的框架，你应该能理解根据不同条件拼接 SQL 语句有多痛苦，例如拼接时要确保不能忘记添加必要的空格，还要注意去掉列表最后一个列名的逗号。利用动态 SQL，可以彻底摆脱这种痛苦。")]),s._v(" "),e("p",[s._v("使用动态 SQL 并非一件易事，但借助可用于任何 SQL 映射语句中的强大的动态 SQL 语言，MyBatis 显著地提升了这一特性的易用性。")]),s._v(" "),e("p",[s._v("如果你之前用过 JSTL 或任何基于类 XML 语言的文本处理器，你对动态 SQL 元素可能会感觉似曾相识。在 MyBatis 之前的版本中，需要花时间了解大量的元素。借助功能强大的基于 OGNL 的表达式，MyBatis 3 替换了之前的大部分元素，大大精简了元素种类，现在要学习的元素种类比原来的一半还要少。")]),s._v(" "),e("ul",[e("li",[s._v("if")]),s._v(" "),e("li",[s._v("choose (when, otherwise)")]),s._v(" "),e("li",[s._v("trim (where, set)")]),s._v(" "),e("li",[s._v("foreach")])]),s._v(" "),e("h3",{attrs:{id:"if"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#if"}},[s._v("#")]),s._v(" if")]),s._v(" "),e("p",[s._v("使用动态 SQL 最常见情景是根据条件包含 where 子句的一部分。比如：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<select id="findActiveBlogWithTitleLike"\n     resultType="Blog">\n  SELECT * FROM BLOG\n  WHERE state = ‘ACTIVE’\n  <if test="title != null">\n    AND title like #{title}\n  </if>\n</select>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("这条语句提供了可选的查找文本功能。如果不传入 “title”，那么所有处于 “ACTIVE” 状态的 BLOG 都会返回；如果传入了 “title” 参数，那么就会对 “title” 一列进行模糊查找并返回对应的 BLOG 结果（细心的读者可能会发现，“title” 的参数值需要包含查找掩码或通配符字符）。")]),s._v(" "),e("p",[s._v("如果希望通过 “title” 和 “author” 两个参数进行可选搜索该怎么办呢？首先，我想先将语句名称修改成更名副其实的名称；接下来，只需要加入另一个条件即可。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<select id="findActiveBlogLike"\n     resultType="Blog">\n  SELECT * FROM BLOG WHERE state = ‘ACTIVE’\n  <if test="title != null">\n    AND title like #{title}\n  </if>\n  <if test="author != null and author.name != null">\n    AND author_name like #{author.name}\n  </if>\n</select>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"choose、when、otherwise"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#choose、when、otherwise"}},[s._v("#")]),s._v(" choose、when、otherwise")]),s._v(" "),e("p",[s._v("有时候，我们不想使用所有的条件，而只是想从多个条件中选择一个使用。针对这种情况，MyBatis 提供了 choose 元素，它有点像 Java 中的 switch 语句。")]),s._v(" "),e("p",[s._v("还是上面的例子，但是策略变为：传入了 “title” 就按 “title” 查找，传入了 “author” 就按 “author” 查找的情形。若两者都没有传入，就返回标记为 featured 的 BLOG（这可能是管理员认为，与其返回大量的无意义随机 Blog，还不如返回一些由管理员挑选的 Blog）。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<select id="findActiveBlogLike"\n     resultType="Blog">\n  SELECT * FROM BLOG WHERE state = ‘ACTIVE’\n  <choose>\n    <when test="title != null">\n      AND title like #{title}\n    </when>\n    <when test="author != null and author.name != null">\n      AND author_name like #{author.name}\n    </when>\n    <otherwise>\n      AND featured = 1\n    </otherwise>\n  </choose>\n</select>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h3",{attrs:{id:"trim、where、set"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#trim、where、set"}},[s._v("#")]),s._v(" trim、where、set")]),s._v(" "),e("p",[s._v("前面几个例子已经合宜地解决了一个臭名昭著的动态 SQL 问题。现在回到之前的 “if” 示例，这次我们将 “state = ‘ACTIVE’” 设置成动态条件，看看会发生什么。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<select id="findActiveBlogLike"\n     resultType="Blog">\n  SELECT * FROM BLOG\n  WHERE\n  <if test="state != null">\n    state = #{state}\n  </if>\n  <if test="title != null">\n    AND title like #{title}\n  </if>\n  <if test="author != null and author.name != null">\n    AND author_name like #{author.name}\n  </if>\n</select>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("如果没有匹配的条件会怎么样？最终这条 SQL 会变成这样：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT * FROM BLOG\nWHERE\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("这会导致查询失败。如果匹配的只是第二个条件又会怎样？这条 SQL 会是这样:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT * FROM BLOG\nWHERE\nAND title like ‘someTitle’\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("这个查询也会失败。这个问题不能简单地用条件元素来解决。这个问题是如此的难以解决，以至于解决过的人不会再想碰到这种问题。")]),s._v(" "),e("p",[s._v("MyBatis 有一个简单且适合大多数场景的解决办法。而在其他场景中，可以对其进行自定义以符合需求。而这，只需要一处简单的改动：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<select id="findActiveBlogLike"\n     resultType="Blog">\n  SELECT * FROM BLOG\n  <where>\n    <if test="state != null">\n         state = #{state}\n    </if>\n    <if test="title != null">\n        AND title like #{title}\n    </if>\n    <if test="author != null and author.name != null">\n        AND author_name like #{author.name}\n    </if>\n  </where>\n</select>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("where 元素只会在子元素返回任何内容的情况下才插入 “WHERE” 子句。而且，若子句的开头为 “AND” 或 “OR”，where 元素也会将它们去除。")]),s._v(" "),e("p",[s._v("如果 where 元素与你期望的不太一样，你也可以通过自定义 trim 元素来定制 where 元素的功能。比如，和 where 元素等价的自定义 trim 元素为：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<trim prefix="WHERE" prefixOverrides="AND |OR ">\n  ...\n</trim>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("prefixOverrides 属性会忽略通过管道符分隔的文本序列（注意此例中的空格是必要的）。上述例子会移除所有 prefixOverrides 属性中指定的内容，并且插入 prefix 属性中指定的内容。")]),s._v(" "),e("p",[s._v("用于动态更新语句的类似解决方案叫做 set。set 元素可以用于动态包含需要更新的列，忽略其它不更新的列。比如：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<update id="updateAuthorIfNecessary">\n  update Author\n    <set>\n      <if test="username != null">username=#{username},</if>\n      <if test="password != null">password=#{password},</if>\n      <if test="email != null">email=#{email},</if>\n      <if test="bio != null">bio=#{bio}</if>\n    </set>\n  where id=#{id}\n</update>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("p",[s._v("这个例子中，set 元素会动态地在行首插入 SET 关键字，并会删掉额外的逗号（这些逗号是在使用条件语句给列赋值时引入的）。")]),s._v(" "),e("p",[s._v("来看看与 set 元素等价的自定义 trim 元素吧：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<trim prefix="SET" suffixOverrides=",">\n  ...\n</trim>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("注意，我们覆盖了后缀值设置，并且自定义了前缀值。")]),s._v(" "),e("h3",{attrs:{id:"foreach"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#foreach"}},[s._v("#")]),s._v(" foreach")]),s._v(" "),e("p",[s._v("动态 SQL 的另一个常见使用场景是对集合进行遍历（尤其是在构建 IN 条件语句的时候）。比如：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<select id="selectPostIn" resultType="domain.blog.Post">\n  SELECT *\n  FROM POST P\n  WHERE ID in\n  <foreach item="item" index="index" collection="list"\n      open="(" separator="," close=")">\n        #{item}\n  </foreach>\n</select>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("foreach 元素的功能非常强大，它允许你指定一个集合，声明可以在元素体内使用的集合项（item）和索引（index）变量。它也允许你指定开头与结尾的字符串以及集合项迭代之间的分隔符。这个元素也不会错误地添加多余的分隔符，看它多智能！")]),s._v(" "),e("blockquote",[e("p",[s._v("提示 你可以将任何可迭代对象（如 List、Set 等）、Map 对象或者数组对象作为集合参数传递给 foreach。当使用可迭代对象或者数组时，index 是当前迭代的序号，item 的值是本次迭代获取到的元素。当使用 Map 对象（或者 Map.Entry 对象的集合）时，index 是键，item 是值。")])]),s._v(" "),e("p",[s._v("至此，我们已经完成了与 XML 配置及映射文件相关的讨论。下一章将详细探讨 Java API，以便你能充分利用已经创建的映射配置。")]),s._v(" "),e("h3",{attrs:{id:"script"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#script"}},[s._v("#")]),s._v(" script")]),s._v(" "),e("p",[s._v("要在带注解的映射器接口类中使用动态 SQL，可以使用 script 元素。比如:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    @Update({"<script>",\n      "update Author",\n      "  <set>",\n      "    <if test=\'username != null\'>username=#{username},</if>",\n      "    <if test=\'password != null\'>password=#{password},</if>",\n      "    <if test=\'email != null\'>email=#{email},</if>",\n      "    <if test=\'bio != null\'>bio=#{bio}</if>",\n      "  </set>",\n      "where id=#{id}",\n      "<\/script>"})\n    void updateAuthorValues(Author author);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h3",{attrs:{id:"bind"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bind"}},[s._v("#")]),s._v(" bind")]),s._v(" "),e("p",[s._v("bind 元素允许你在 OGNL 表达式以外创建一个变量，并将其绑定到当前的上下文。比如：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<select id="selectBlogsLike" resultType="Blog">\n  <bind name="pattern" value="\'%\' + _parameter.getTitle() + \'%\'" />\n  SELECT * FROM BLOG\n  WHERE title LIKE #{pattern}\n</select>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"多数据库支持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#多数据库支持"}},[s._v("#")]),s._v(" 多数据库支持")]),s._v(" "),e("p",[s._v("如果配置了 databaseIdProvider，你就可以在动态代码中使用名为 “_databaseId” 的变量来为不同的数据库构建特定的语句。比如下面的例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<insert id="insert">\n  <selectKey keyProperty="id" resultType="int" order="BEFORE">\n    <if test="_databaseId == \'oracle\'">\n      select seq_users.nextval from dual\n    </if>\n    <if test="_databaseId == \'db2\'">\n      select nextval for seq_users from sysibm.sysdummy1"\n    </if>\n  </selectKey>\n  insert into users values (#{id}, #{name})\n</insert>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h3",{attrs:{id:"动态-sql-中的插入脚本语言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#动态-sql-中的插入脚本语言"}},[s._v("#")]),s._v(" 动态 SQL 中的插入脚本语言")]),s._v(" "),e("p",[s._v("MyBatis 从 3.2 版本开始支持插入脚本语言，这允许你插入一种语言驱动，并基于这种语言来编写动态 SQL 查询语句。")]),s._v(" "),e("p",[s._v("可以通过实现以下接口来插入一种语言：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("public interface LanguageDriver {\n  ParameterHandler createParameterHandler(MappedStatement mappedStatement, Object parameterObject, BoundSql boundSql);\n  SqlSource createSqlSource(Configuration configuration, XNode script, Class<?> parameterType);\n  SqlSource createSqlSource(Configuration configuration, String script, Class<?> parameterType);\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("实现自定义语言驱动后，你就可以在 mybatis-config.xml 文件中将它设置为默认语言：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<typeAliases>\n  <typeAlias type="org.sample.MyLanguageDriver" alias="myLanguage"/>\n</typeAliases>\n<settings>\n  <setting name="defaultScriptingLanguage" value="myLanguage"/>\n</settings>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("或者，你也可以使用 lang 属性为特定的语句指定语言：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<select id="selectBlog" lang="myLanguage">\n  SELECT * FROM BLOG\n</select>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("或者，在你的 mapper 接口上添加 @Lang 注解：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('public interface Mapper {\n  @Lang(MyLanguageDriver.class)\n  @Select("SELECT * FROM BLOG")\n  List<Blog> selectBlog();\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("blockquote",[e("p",[s._v("提示 可以使用 Apache Velocity 作为动态语言，更多细节请参考 MyBatis-Velocity 项目。")])]),s._v(" "),e("p",[s._v("你前面看到的所有 xml 标签都由默认 MyBatis 语言提供，而它由语言驱动 org.apache.ibatis.scripting.xmltags.XmlLanguageDriver（别名为 xml）所提供。")]),s._v(" "),e("h1",{attrs:{id:"动态sql解析原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#动态sql解析原理"}},[s._v("#")]),s._v(" 动态SQL解析原理")]),s._v(" "),e("hr"),s._v(" "),e("p",[s._v("我们在使用mybatis的时候，会在xml中编写sql语句。比如这段动态sql代码：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<update id="update" parameterType="org.format.dynamicproxy.mybatis.bean.User">\n    UPDATE users\n    <trim prefix="SET" prefixOverrides=",">\n        <if test="name != null and name != \'\'">\n            name = #{name}\n        </if>\n        <if test="age != null and age != \'\'">\n            , age = #{age}\n        </if>\n        <if test="birthday != null and birthday != \'\'">\n            , birthday = #{birthday}\n        </if>\n    </trim>\n    where id = ${id}\n</update>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("mybatis底层是如何构造这段sql的？下面带着这个疑问，我们一步一步分析。")]),s._v(" "),e("h3",{attrs:{id:"关于动态sql的接口和类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关于动态sql的接口和类"}},[s._v("#")]),s._v(" 关于动态SQL的接口和类")]),s._v(" "),e("p",[s._v("SqlNode接口，简单理解就是xml中的每个标签，比如上述sql的update,trim,if标签：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("public interface SqlNode {\n    boolean apply(DynamicContext context);\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[e("img",{attrs:{src:a(3414),alt:""}})]),s._v(" "),e("p",[s._v("SqlSource Sql源接口，代表从xml文件或注解映射的sql内容，主要就是用于创建BoundSql，有实现类DynamicSqlSource(动态Sql源)，StaticSqlSource(静态Sql源)等：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("public interface SqlSource {\n    BoundSql getBoundSql(Object parameterObject);\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[e("img",{attrs:{src:a(3415),alt:""}})]),s._v(" "),e("p",[s._v("BoundSql类，封装mybatis最终产生sql的类，包括sql语句，参数，参数源数据等参数：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3416),alt:""}})]),s._v(" "),e("p",[s._v("XNode，一个Dom API中的Node接口的扩展类：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3417),alt:""}})]),s._v(" "),e("p",[s._v("BaseBuilder接口及其实现类(属性，方法省略了，大家有兴趣的自己看),这些Builder的作用就是用于构造sql：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3418),alt:""}})]),s._v(" "),e("p",[s._v("下面我们简单分析下其中4个Builder：")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("XMLConfigBuilder")]),s._v("：解析mybatis中configLocation属性中的全局xml文件，内部会使用XMLMapperBuilder解析各个xml文件。")]),s._v(" "),e("li",[e("strong",[s._v("XMLMapperBuilder")]),s._v("：遍历mybatis中mapperLocations属性中的xml文件中每个节点的Builder，比如user.xml，内部会使用XMLStatementBuilder处理xml中的每个节点。")]),s._v(" "),e("li",[e("strong",[s._v("XMLStatementBuilder")]),s._v("：解析xml文件中各个节点，比如select,insert,update,delete节点，内部会使用XMLScriptBuilder处理节点的sql部分，遍历产生的数据会丢到Configuration的mappedStatements中。")]),s._v(" "),e("li",[e("strong",[s._v("XMLScriptBuilder")]),s._v("：解析xml中各个节点sql部分的Builder。")])]),s._v(" "),e("p",[s._v("LanguageDriver接口及其实现类(属性，方法省略了，大家有兴趣的自己看)，该接口主要的作用就是构造sql:")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3419),alt:""}})]),s._v(" "),e("p",[s._v("简单分析下XMLLanguageDriver(处理xml中的sql，RawLanguageDriver处理静态sql)：XMLLanguageDriver内部会使用XMLScriptBuilder解析xml中的sql部分。")]),s._v(" "),e("h3",{attrs:{id:"源码分析走起"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#源码分析走起"}},[s._v("#")]),s._v(" 源码分析走起")]),s._v(" "),e("p",[s._v("Spring与Mybatis整合的时候需要配置SqlSessionFactoryBean，该配置会加入数据源和mybatis xml配置文件路径等信息：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">\n    <property name="dataSource" ref="dataSource"/>\n    <property name="configLocation" value="classpath:mybatisConfig.xml"/>\n    <property name="mapperLocations" value="classpath*:org/format/dao/*.xml"/>\n</bean>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("我们就分析这一段配置背后的细节：")]),s._v(" "),e("p",[s._v("SqlSessionFactoryBean实现了Spring的InitializingBean接口，InitializingBean接口的afterPropertiesSet方法中会调用buildSqlSessionFactory方法 该方法内部会使用XMLConfigBuilder解析属性configLocation中配置的路径，还会使用XMLMapperBuilder属性解析mapperLocations属性中的各个xml文件。部分源码如下：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3420),alt:""}})]),s._v(" "),e("p",[s._v("由于XMLConfigBuilder内部也是使用XMLMapperBuilder，我们就看看XMLMapperBuilder的解析细节：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3421),alt:""}})]),s._v(" "),e("p",[e("img",{attrs:{src:a(3422),alt:""}})]),s._v(" "),e("p",[s._v("我们关注一下，增删改查节点的解析：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3423),alt:""}})]),s._v(" "),e("p",[s._v("XMLStatementBuilder的解析：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3424),alt:""}})]),s._v(" "),e("p",[s._v("默认会使用XMLLanguageDriver创建SqlSource（Configuration构造函数中设置）。")]),s._v(" "),e("p",[s._v("XMLLanguageDriver创建SqlSource：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3425),alt:""}})]),s._v(" "),e("p",[s._v("XMLScriptBuilder解析sql：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3426),alt:""}})]),s._v(" "),e("p",[s._v("得到SqlSource之后，会放到Configuration中，有了SqlSource，就能拿BoundSql了，BoundSql可以得到最终的sql。")]),s._v(" "),e("h3",{attrs:{id:"实例分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实例分析"}},[s._v("#")]),s._v(" 实例分析")]),s._v(" "),e("p",[s._v("以下面的xml解析大概说下parseDynamicTags的解析过程：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<update id="update" parameterType="org.format.dynamicproxy.mybatis.bean.User">\n    UPDATE users\n    <trim prefix="SET" prefixOverrides=",">\n        <if test="name != null and name != \'\'">\n            name = #{name}\n        </if>\n        <if test="age != null and age != \'\'">\n            , age = #{age}\n        </if>\n        <if test="birthday != null and birthday != \'\'">\n            , birthday = #{birthday}\n        </if>\n    </trim>\n    where id = ${id}\n</update>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("parseDynamicTags方法的返回值是一个List，也就是一个Sql节点集合。SqlNode本文一开始已经介绍，分析完解析过程之后会说一下各个SqlNode类型的作用。")]),s._v(" "),e("p",[s._v("首先根据update节点(Node)得到所有的子节点，分别是3个子节点：")]),s._v(" "),e("ul",[e("li",[s._v("文本节点 \\n UPDATE users")]),s._v(" "),e("li",[s._v("trim子节点 ...")]),s._v(" "),e("li",[s._v("文本节点 \\n where id = #")])]),s._v(" "),e("p",[s._v("遍历各个子节点：")]),s._v(" "),e("ul",[e("li",[s._v("如果节点类型是文本或者CDATA，构造一个TextSqlNode或StaticTextSqlNode；")]),s._v(" "),e("li",[s._v("如果节点类型是元素，说明该update节点是个动态sql，然后会使用NodeHandler处理各个类型的子节点。这里的NodeHandler是XMLScriptBuilder的一个内部接口，其实现类包括TrimHandler、WhereHandler、SetHandler、IfHandler、ChooseHandler等。看类名也就明白了这个Handler的作用，比如我们分析的trim节点，对应的是TrimHandler；if节点，对应的是IfHandler...这里子节点trim被TrimHandler处理，TrimHandler内部也使用parseDynamicTags方法解析节点。")])]),s._v(" "),e("p",[s._v("遇到子节点是元素的话，重复以上步骤：")]),s._v(" "),e("p",[s._v("trim子节点内部有7个子节点，分别是文本节点、if节点、是文本节点、if节点、是文本节点、if节点、文本节点。文本节点跟之前一样处理，if节点使用IfHandler处理。遍历步骤如上所示，下面我们看下几个Handler的实现细节。")]),s._v(" "),e("p",[s._v("IfHandler处理方法也是使用parseDynamicTags方法，然后加上if标签必要的属性：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('private class IfHandler implements NodeHandler {\n    public void handleNode(XNode nodeToHandle, List<SqlNode> targetContents) {\n      List<SqlNode> contents = parseDynamicTags(nodeToHandle);\n      MixedSqlNode mixedSqlNode = new MixedSqlNode(contents);\n      String test = nodeToHandle.getStringAttribute("test");\n      IfSqlNode ifSqlNode = new IfSqlNode(mixedSqlNode, test);\n      targetContents.add(ifSqlNode);\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("TrimHandler处理方法也是使用parseDynamicTags方法，然后加上trim标签必要的属性：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('private class TrimHandler implements NodeHandler {\n    public void handleNode(XNode nodeToHandle, List<SqlNode> targetContents) {\n      List<SqlNode> contents = parseDynamicTags(nodeToHandle);\n      MixedSqlNode mixedSqlNode = new MixedSqlNode(contents);\n      String prefix = nodeToHandle.getStringAttribute("prefix");\n      String prefixOverrides = nodeToHandle.getStringAttribute("prefixOverrides");\n      String suffix = nodeToHandle.getStringAttribute("suffix");\n      String suffixOverrides = nodeToHandle.getStringAttribute("suffixOverrides");\n      TrimSqlNode trim = new TrimSqlNode(configuration, mixedSqlNode, prefix, prefixOverrides, suffix, suffixOverrides);\n      targetContents.add(trim);\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("p",[s._v("以上update方法最终通过parseDynamicTags方法得到的SqlNode集合如下：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3427),alt:""}})]),s._v(" "),e("p",[s._v("trim节点：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3428),alt:""}})]),s._v(" "),e("p",[s._v("由于这个update方法是个动态节点，因此构造出了DynamicSqlSource。DynamicSqlSource内部就可以构造sql了:")]),s._v(" "),e("p",[e("img",{attrs:{src:a(3429),alt:""}})]),s._v(" "),e("p",[s._v("DynamicSqlSource内部的SqlNode属性是一个MixedSqlNode。然后我们看看各个SqlNode实现类的apply方法。下面分析一下各个SqlNode实现类的apply方法实现：")]),s._v(" "),e("p",[s._v("MixedSqlNode：MixedSqlNode会遍历调用内部各个sqlNode的apply方法。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("public boolean apply(DynamicContext context) {\n   for (SqlNode sqlNode : contents) {\n     sqlNode.apply(context);\n   }\n   return true;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("StaticTextSqlNode：直接append sql文本。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("public boolean apply(DynamicContext context) {\n   context.appendSql(text);\n   return true;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("IfSqlNode：这里的evaluator是一个ExpressionEvaluator类型的实例，内部使用了OGNL处理表达式逻辑。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("public boolean apply(DynamicContext context) {\n   if (evaluator.evaluateBoolean(test, context.getBindings())) {\n     contents.apply(context);\n     return true;\n   }\n   return false;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("TrimSqlNode：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('public boolean apply(DynamicContext context) {\n    FilteredDynamicContext filteredDynamicContext = new FilteredDynamicContext(context);\n    boolean result = contents.apply(filteredDynamicContext);\n    filteredDynamicContext.applyAll();\n    return result;\n}\n\npublic void applyAll() {\n    sqlBuffer = new StringBuilder(sqlBuffer.toString().trim());\n    String trimmedUppercaseSql = sqlBuffer.toString().toUpperCase(Locale.ENGLISH);\n    if (trimmedUppercaseSql.length() > 0) {\n        applyPrefix(sqlBuffer, trimmedUppercaseSql);\n        applySuffix(sqlBuffer, trimmedUppercaseSql);\n    }\n    delegate.appendSql(sqlBuffer.toString());\n}\n\nprivate void applyPrefix(StringBuilder sql, String trimmedUppercaseSql) {\n    if (!prefixApplied) {\n        prefixApplied = true;\n        if (prefixesToOverride != null) {\n            for (String toRemove : prefixesToOverride) {\n                if (trimmedUppercaseSql.startsWith(toRemove)) {\n                    sql.delete(0, toRemove.trim().length());\n                    break;\n                }\n            }\n        }\n        if (prefix != null) {\n            sql.insert(0, " ");\n            sql.insert(0, prefix);\n        }\n   }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br")])]),e("p",[s._v("TrimSqlNode的apply方法也是调用属性contents(一般都是MixedSqlNode)的apply方法，按照实例也就是7个SqlNode，都是StaticTextSqlNode和IfSqlNode。 最后会使用FilteredDynamicContext过滤掉prefix和suffix。)")])])}),[],!1,null,null,null);e.default=t.exports}}]);