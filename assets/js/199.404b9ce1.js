(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{2365:function(o,t,n){o.exports=n.p+"assets/img/mongo-y-arch-1.7f338b76.png"},2366:function(o,t,n){o.exports=n.p+"assets/img/mongo-y-arch-3.ae2175ff.png"},2367:function(o,t,n){o.exports=n.p+"assets/img/mongo-y-arch-2.32a568e4.png"},2368:function(o,t,n){o.exports=n.p+"assets/img/mongo-y-arch-4.657c06e4.png"},2369:function(o,t){o.exports="data:image/png;base64,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"},2370:function(o,t,n){o.exports=n.p+"assets/img/mongo-y-arch-6.9eaa5e4f.png"},3917:function(o,t,n){"use strict";n.r(t);var e=n(7),a=Object(e.a)({},(function(){var o=this,t=o._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":o.$parent.slotKey}},[t("h1",{attrs:{id:"mongo进阶-mongodb体系结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongo进阶-mongodb体系结构"}},[o._v("#")]),o._v(" Mongo进阶 - MongoDB体系结构")]),o._v(" "),t("p",[o._v("===============================================")]),o._v(" "),t("blockquote",[t("p",[o._v("上面章节已经对MongoDB生态中工具以及使用有了基础，后续文章我们将开始理解MongoDB是如何支撑这些功能的。我们将从最基本的MongoDB的体系结构开始介绍，主要包括"),t("code",[o._v("MongoDB的包结构")]),o._v("，"),t("code",[o._v("MongoDB的数据逻辑结构")]),o._v("，"),t("code",[o._v("MongoDB的数据文件结构")]),o._v("。其中围绕着MongoDB的数据文件结构，将为我们后续介绍MongoDB的存储引擎详解打下基础。@pdai")])]),o._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#mongo%E8%BF%9B%E9%98%B6---mongodb%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"}},[o._v("Mongo进阶 - MongoDB体系结构")]),o._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#mongodb%E5%8C%85%E7%BB%84%E4%BB%B6%E7%BB%93%E6%9E%84"}},[o._v("MongoDB包组件结构")])]),o._v(" "),t("li",[t("a",{attrs:{href:"#mongodb%E6%95%B0%E6%8D%AE%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84"}},[o._v("MongoDB数据逻辑结构")]),o._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E6%95%B0%E6%8D%AE%E5%BA%93"}},[o._v("数据库")])]),o._v(" "),t("li",[t("a",{attrs:{href:"#%E9%9B%86%E5%90%88"}},[o._v("集合")])]),o._v(" "),t("li",[t("a",{attrs:{href:"#%E6%96%87%E6%A1%A3"}},[o._v("文档")])])])]),o._v(" "),t("li",[t("a",{attrs:{href:"#mongodb%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6"}},[o._v("MongoDB数据库文件")]),o._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#mongodb---mmapv1%E5%BC%95%E6%93%8E%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6"}},[o._v("MongoDB - MMAPv1引擎下的数据库文件")])]),o._v(" "),t("li",[t("a",{attrs:{href:"#mongodb---wiredtiger"}},[o._v("MongoDB - WiredTiger")])])])]),o._v(" "),t("li",[t("a",{attrs:{href:"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"}},[o._v("参考文章")])])])])]),o._v(" "),t("h1",{attrs:{id:"mongodb包组件结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongodb包组件结构"}},[o._v("#")]),o._v(" MongoDB包组件结构")]),o._v(" "),t("hr"),o._v(" "),t("blockquote",[t("p",[o._v("主要是MongoDB数据库服务以及一些工具。")])]),o._v(" "),t("p",[t("img",{attrs:{src:n(2365),alt:""}})]),o._v(" "),t("p",[o._v("回顾下我们在MongoDB生态中展示的"),t("a",{attrs:{href:"https://docs.mongodb.com/database-tools/",target:"_blank",rel:"noopener noreferrer"}},[o._v("MongoDB Database Tools 在新窗口打开"),t("OutboundLink")],1)]),o._v(" "),t("ul",[t("li",[o._v("二进制导入导出\n"),t("ul",[t("li",[t("code",[o._v("mongodump")]),o._v(" Creates a binary export of the contents of a mongod database.")]),o._v(" "),t("li",[t("code",[o._v("mongorestore")]),o._v(" Restores data from a mongodump database dump into a mongod or mongos")]),o._v(" "),t("li",[t("code",[o._v("bsondump")]),o._v(" Converts BSON dump files into JSON.")])])]),o._v(" "),t("li",[o._v("数据导入导出\n"),t("ul",[t("li",[t("code",[o._v("mongoimport")]),o._v(" Imports content from an Extended JSON, CSV, or TSV export file.")]),o._v(" "),t("li",[t("code",[o._v("mongoexport")]),o._v(" Produces a JSON or CSV export of data stored in a mongod instance.")])])]),o._v(" "),t("li",[o._v("诊断工具\n"),t("ul",[t("li",[t("code",[o._v("mongostat")]),o._v(" Provides a quick overview of the status of a currently running mongod or mongos instance.")]),o._v(" "),t("li",[t("code",[o._v("mongotop")]),o._v(" Provides an overview of the time a mongod instance spends reading and writing data.")])])]),o._v(" "),t("li",[o._v("GridFS 工具\n"),t("ul",[t("li",[t("code",[o._v("mongofiles")]),o._v(" Supports manipulating files stored in your MongoDB instance in GridFS objects.")])])])]),o._v(" "),t("p",[o._v("除了上述没有列举到，还有：")]),o._v(" "),t("ul",[t("li",[t("code",[o._v("mongoperf")]),o._v(": mongoDB自带工具，用于评估磁盘随机IO性能。")])]),o._v(" "),t("p",[o._v("包组件可以在"),t("a",{attrs:{href:"https://docs.mongodb.com/manual/reference/program/#mongodb-package-components",target:"_blank",rel:"noopener noreferrer"}},[o._v("官网MongoDB Package Components 在新窗口打开"),t("OutboundLink")],1),o._v("找到详细的用法。")]),o._v(" "),t("p",[t("img",{attrs:{src:n(2366),alt:""}})]),o._v(" "),t("p",[o._v("其中最主要的程序当然是mongod（数据库服务），mongod在不同的部署方案中（单机部署，副本集部署，分片集群部署），通过不同的配置，可以扮演多种不同的角色：")]),o._v(" "),t("ul",[t("li",[o._v("在单机部署中扮演 数据库服务器（提供所有读写功能）")]),o._v(" "),t("li",[o._v("在副本集部署中，通过配置，可以部署为 primary节点（主服务器，负责写数据，也可以提供查询）、secondary节点（从服务器，它从主节点复制数据，也可以提供查询）、以及arbiter节点（仲裁节点，不保存数据，主要用于参与选举投票）")]),o._v(" "),t("li",[o._v("在分片集群中，除了在每个分片中扮演上述角色外，还扮演着配置服务器的角色（存储有分片集群的所有元数据信息，mongos的数据路由分发等都要依赖于它）")])]),o._v(" "),t("p",[o._v("在一台服务器上，可以启动多个mongod服务。但在实际生产部署中，通常还是建议一台服务器部署一个mongod实例，这样不仅减少资源竞争，而且服务器故障也不会同时影响到多个服务。")]),o._v(" "),t("h1",{attrs:{id:"mongodb数据逻辑结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongodb数据逻辑结构"}},[o._v("#")]),o._v(" MongoDB数据逻辑结构")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("MongoDB 数据逻辑结构分为数据库（database）、集合（collection）、文档（document）三层 :")]),o._v(" "),t("ul",[t("li",[o._v("一个mongod实例中允许创建多个数据库。")]),o._v(" "),t("li",[o._v("一个数据库中允许创建多个集合（集合相当于关系型数据库的表）。")]),o._v(" "),t("li",[o._v("一个集合则是由若干个文档构成（文档相当于关系型数据库的行，是MongoDB中数据的基本单元）。")])]),o._v(" "),t("p",[t("img",{attrs:{src:n(2367),alt:""}})]),o._v(" "),t("h3",{attrs:{id:"数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库"}},[o._v("#")]),o._v(" 数据库")]),o._v(" "),t("blockquote",[t("p",[o._v("一个数据库中可以创建多个集合，原则上我们通常把逻辑相近的集合都放在一个数据库中，当然出于性能或者数据量的关系，也可能进行拆分。")])]),o._v(" "),t("p",[o._v("在MongoDB中有几个内建的数据库：")]),o._v(" "),t("ul",[t("li",[t("strong",[o._v("admin")]),o._v(" admin库主要存放有数据库帐号相关信息。")]),o._v(" "),t("li",[t("strong",[o._v("local")]),o._v(" local数据库永远不会被复制到从节点，可以用来存储限于本地单台服务器的任意集合副本集的配置信息、oplog就存储在local库中。\n"),t("ul",[t("li",[o._v("重要的数据不要存储在local库，因为没有冗余副本，如果这个节点故障，存储在local库的数据就无法正常使用了。")])])]),o._v(" "),t("li",[t("strong",[o._v("config")]),o._v(" config数据库用于分片集群环境，存放了分片相关的元数据信息。")]),o._v(" "),t("li",[t("strong",[o._v("test")]),o._v(" MongoDB默认创建的一个测试库，连接mongod服务时，如果不指定连接的具体数据库，默认就会连接到test库。")])]),o._v(" "),t("p",[t("img",{attrs:{src:n(2368),alt:""}})]),o._v(" "),t("h3",{attrs:{id:"集合"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集合"}},[o._v("#")]),o._v(" 集合")]),o._v(" "),t("blockquote",[t("p",[o._v("集合由若干条文档记录构成。")])]),o._v(" "),t("ul",[t("li",[o._v("前面介绍MongoDB的时候提到过，集合是"),t("strong",[o._v("schema-less")]),o._v("的（无模式或动态模式），这意味着集合不需要在读写数据前创建模式就可以使用，集合中的文档也可以拥有不同的字段，随时可以任意增减某个文档的字段。")]),o._v(" "),t("li",[o._v("在集合上可以对文档进行"),t("strong",[o._v("增删改查")]),o._v("以及进行"),t("strong",[o._v("聚合")]),o._v("操作。")]),o._v(" "),t("li",[o._v("在集合上还可以对文档中的字段创建"),t("strong",[o._v("索引")]),o._v("。")]),o._v(" "),t("li",[o._v("除了一般的集合外，还可以创建一种叫做**定容集合（capped collection）**类型的集合，这种集合与一般集合主要的区别是，它可以限制集合的容量大小，在数据写满的时候，又可以从头开始覆盖最开始的文档进行循环写入。")]),o._v(" "),t("li",[t("strong",[o._v("副本集")]),o._v("就是利用这种类型的集合作为"),t("strong",[o._v("oplog")]),o._v("，记录primary节点上的写操作，并且同步到从"),t("strong",[o._v("节点重放，以实现主副节点数据复制的功能")]),o._v("。")])]),o._v(" "),t("h3",{attrs:{id:"文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文档"}},[o._v("#")]),o._v(" 文档")]),o._v(" "),t("blockquote",[t("p",[o._v("文档是MongoDB中数据的基本存储单元，它以一种叫做BSON文档的结构表示。BSON，即Binary JSON，多个键及其关联的值有序地存放在其中，类似映射，散列或字典。")])]),o._v(" "),t("ul",[t("li",[o._v("文档中的键/值对是有序的，不同序则是不同文档。并且键是区分大小写的，否则也为不同文档。")]),o._v(" "),t("li",[o._v("文档的键是字符串，而值除了字符串，还可以是int, long, double，boolean，子文档，数组等多种类型。")]),o._v(" "),t("li",[o._v("文档中不能有重复的键。")]),o._v(" "),t("li",[o._v("每个文档都有一个"),t("strong",[o._v("默认的_id键")]),o._v("，它相当于关系型数据库中的主键，这个键的值在同一个集合中必须是唯一的，"),t("strong",[o._v("_id键值默认是ObjectId类型")]),o._v("，在插入文档的时候，如果用户不设置文档的_id值得话，MongoDB会自动生成生成一个唯一的ObjectId值进行填充。")])]),o._v(" "),t("h1",{attrs:{id:"mongodb数据库文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongodb数据库文件"}},[o._v("#")]),o._v(" MongoDB数据库文件")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("注意")]),o._v(" "),t("p",[o._v("MongoDB数据库文件和MongoDB存储的引擎有直接关系，MongoDB一共提供了三种存储引擎：WiredTiger，MMAPV1和In Memory；在MongoDB3.2之前采用的是MMAPV1; 后续版本v3.2开始默认采用WiredTiger； 且在v4.2版本中移除了MMAPV1的引擎。")]),o._v(" "),t("p",[o._v("在后续文章中，还将对MongoDB存储引擎进行详解。")]),o._v(" "),t("h3",{attrs:{id:"mongodb-mmapv1引擎下的数据库文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-mmapv1引擎下的数据库文件"}},[o._v("#")]),o._v(" MongoDB - MMAPv1引擎下的数据库文件")]),o._v(" "),t("blockquote",[t("p",[o._v("由于v3.0后续版本已经弃用了，所以这里不会详细介绍。")])]),o._v(" "),t("ul",[t("li",[o._v("journal 日志文件")]),o._v(" "),t("li",[o._v("namespace 表名文件")]),o._v(" "),t("li",[o._v("data 数据及索引文件")])]),o._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[o._v("db\n|------journal\n           |----_j.0\n           |----_j.1\n           |----lsn\n|------local\n           |----local.ns\n           |----local.0\n           |----local.1\n|------mydb\n           |----mydb.ns\n           |----mydb.0\n           |----mydb.1\n")])]),o._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[o._v("1")]),t("br"),t("span",{staticClass:"line-number"},[o._v("2")]),t("br"),t("span",{staticClass:"line-number"},[o._v("3")]),t("br"),t("span",{staticClass:"line-number"},[o._v("4")]),t("br"),t("span",{staticClass:"line-number"},[o._v("5")]),t("br"),t("span",{staticClass:"line-number"},[o._v("6")]),t("br"),t("span",{staticClass:"line-number"},[o._v("7")]),t("br"),t("span",{staticClass:"line-number"},[o._v("8")]),t("br"),t("span",{staticClass:"line-number"},[o._v("9")]),t("br"),t("span",{staticClass:"line-number"},[o._v("10")]),t("br"),t("span",{staticClass:"line-number"},[o._v("11")]),t("br"),t("span",{staticClass:"line-number"},[o._v("12")]),t("br"),t("span",{staticClass:"line-number"},[o._v("13")]),t("br")])]),t("ul",[t("li",[t("p",[o._v("如果感兴趣可以参看 "),t("a",{attrs:{href:"https://docs.mongodb.com/v3.2/core/mmapv1/",target:"_blank",rel:"noopener noreferrer"}},[o._v("官方文档 - MMAPv1 Storage Engine 在新窗口打开"),t("OutboundLink")],1)])]),o._v(" "),t("li",[t("p",[o._v("如果你希望详解了解MongoDB MMAP的引擎（源码级别），你可以参考这篇"),t("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1004385",target:"_blank",rel:"noopener noreferrer"}},[o._v("MongoDB Mmap 引擎分析 在新窗口打开"),t("OutboundLink")],1)]),o._v(" "),t("ul",[t("li",[t("img",{attrs:{src:n(2369),alt:""}})])])])]),o._v(" "),t("h3",{attrs:{id:"mongodb-wiredtiger"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-wiredtiger"}},[o._v("#")]),o._v(" MongoDB - WiredTiger")]),o._v(" "),t("blockquote",[t("p",[o._v("MongoDB v3.2已经将WiredTiger设置为了默认的存储引擎")])]),o._v(" "),t("p",[t("img",{attrs:{src:n(2370),alt:""}})]),o._v(" "),t("ul",[t("li",[t("code",[o._v("collection-*.wt")]),o._v(" 存储collection的数据")]),o._v(" "),t("li",[t("code",[o._v("index-*.wt")]),o._v(" 存储索引的数据")]),o._v(" "),t("li",[t("code",[o._v("WiredTiger")]),o._v(" 存储基本配置信息")]),o._v(" "),t("li",[t("code",[o._v("WiredTiger.wt")]),o._v(" 存储所有其它collection的元数据信息")]),o._v(" "),t("li",[t("code",[o._v("WiredTiger.lock")]),o._v(" 存储进程ID，用于防止多个进程连接同一个Wiredtiger数据库")]),o._v(" "),t("li",[t("code",[o._v("WiredTiger.turtle")]),o._v(" 存储WiredTiger.wt的元数据信息")]),o._v(" "),t("li",[t("code",[o._v("journal")]),o._v(" 存储Write ahead log")])]),o._v(" "),t("p",[o._v("后续的文章将对WiredTiger存储引擎进行详解。")]),o._v(" "),t("h1",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[o._v("#")]),o._v(" 参考文章")]),o._v(" "),t("hr"),o._v(" "),t("ul",[t("li",[o._v("https://blog.csdn.net/eagle89/article/details/80606372")]),o._v(" "),t("li",[o._v("https://blog.csdn.net/iteye_19607/article/details/82643225")]),o._v(" "),t("li",[o._v("https://blog.csdn.net/zhaowen25/article/details/41871383")]),o._v(" "),t("li",[o._v("https://zhuanlan.zhihu.com/p/34248254)")])])])}),[],!1,null,null,null);t.default=a.exports}}]);