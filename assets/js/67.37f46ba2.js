(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{2446:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-1-1.8e2ab324.png"},2447:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-1-0.4da2a048.png"},2448:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-0.88a78e10.png"},2449:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-1.d3a551f9.png"},2450:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-2.d9867cec.png"},2451:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-3.9be5f87e.png"},2452:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-4.e10ddbaf.png"},2453:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-5.52f8bb77.png"},2454:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-6.ed5a0d16.png"},2455:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-7.6fb34fda.png"},2456:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-8.a68abef8.png"},2457:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-9.f4f1fae7.png"},2458:function(a,t,s){a.exports=s.p+"assets/img/es-introduce-2-10.afada793.png"},3935:function(a,t,s){"use strict";s.r(t);var e=s(7),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"es详解-认知-elastic-stack生态和场景方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#es详解-认知-elastic-stack生态和场景方案"}},[a._v("#")]),a._v(" ES详解 - 认知：Elastic Stack生态和场景方案")]),a._v(" "),t("p",[a._v("=================================================================")]),a._v(" "),t("blockquote",[t("p",[a._v("在了解ElaticSearch之后，我们还要了解Elastic背后的生态即我们常说的ELK；与此同时，还会给你展示ElasticSearch的案例场景，让你在学习ES前对它有个全局的印象。@pdai")])]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#es%E8%AF%A6%E8%A7%A3---%E8%AE%A4%E7%9F%A5elastic-stack%E7%94%9F%E6%80%81%E5%92%8C%E5%9C%BA%E6%99%AF%E6%96%B9%E6%A1%88"}},[a._v("ES详解 - 认知：Elastic Stack生态和场景方案")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#elastic-stack%E7%94%9F%E6%80%81"}},[a._v("Elastic Stack生态")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#beats"}},[a._v("Beats")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#logstash"}},[a._v("Logstash")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#elasticsearch"}},[a._v("ElasticSearch")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#kibana"}},[a._v("Kibana")])])])]),a._v(" "),t("li",[t("a",{attrs:{href:"#%E4%BB%8E%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E7%B3%BB%E7%BB%9F%E7%9C%8Bes-stack%E7%9A%84%E5%8F%91%E5%B1%95"}},[a._v("从日志收集系统看ES Stack的发展")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#beatselasticsearchkibana"}},[a._v("beats+elasticsearch+kibana")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#beatslogstathelasticsearchkibana"}},[a._v("beats+logstath+elasticsearch+kibana")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#beatsmqlogstashelasticsearchkibana"}},[a._v("beats+MQ+logstash+elasticsearch+kibana")])])])]),a._v(" "),t("li",[t("a",{attrs:{href:"#elastic-stack%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"}},[a._v("Elastic Stack最佳实践")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E7%B3%BB%E7%BB%9F"}},[a._v("日志收集系统")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#metric%E6%94%B6%E9%9B%86%E5%92%8Capm%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7"}},[a._v("Metric收集和APM性能监控")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#%E5%A4%9A%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E6%96%B9%E6%A1%88"}},[a._v("多数据中心方案")])])])]),a._v(" "),t("li",[t("a",{attrs:{href:"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"}},[a._v("参考文章")])])])])]),a._v(" "),t("h1",{attrs:{id:"elastic-stack生态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elastic-stack生态"}},[a._v("#")]),a._v(" Elastic Stack生态")]),a._v(" "),t("hr"),a._v(" "),t("blockquote",[t("p",[a._v("Beats + Logstash + ElasticSearch + Kibana")])]),a._v(" "),t("p",[a._v("如下是我从官方博客中找到图，这张图展示了ELK生态以及基于ELK的场景（最上方）")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2446),alt:""}})]),a._v(" "),t("p",[a._v("由于Elastic X-Pack是面向收费的，所以我们不妨也把X-Pack放进去，看看哪些是由X-Pack带来的，在阅读官网文档时将方便你甄别重点：")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2447),alt:""}})]),a._v(" "),t("h3",{attrs:{id:"beats"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#beats"}},[a._v("#")]),a._v(" Beats")]),a._v(" "),t("p",[a._v("Beats是一个面向"),t("strong",[a._v("轻量型采集器")]),a._v("的平台，这些采集器可以从边缘机器向Logstash、ElasticSearch发送数据，它是由Go语言进行开发的，运行效率方面比较快。从下图中可以看出，不同Beats的套件是针对不同的数据源。")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2448),alt:""}})]),a._v(" "),t("h3",{attrs:{id:"logstash"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#logstash"}},[a._v("#")]),a._v(" Logstash")]),a._v(" "),t("p",[a._v("Logstash是"),t("strong",[a._v("动态数据收集管道")]),a._v("，拥有可扩展的插件生态系统，支持从不同来源采集数据，转换数据，并将数据发送到不同的存储库中。其能够与ElasticSearch产生强大的协同作用，后被Elastic公司在2013年收购。")]),a._v(" "),t("p",[a._v("它具有如下特性：")]),a._v(" "),t("p",[a._v("1）实时解析和转换数据；")]),a._v(" "),t("p",[a._v("2）可扩展，具有200多个插件；")]),a._v(" "),t("p",[a._v("3）可靠性、安全性。Logstash会通过持久化队列来保证至少将运行中的事件送达一次，同时将数据进行传输加密；")]),a._v(" "),t("p",[a._v("4）监控；")]),a._v(" "),t("h3",{attrs:{id:"elasticsearch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch"}},[a._v("#")]),a._v(" ElasticSearch")]),a._v(" "),t("p",[a._v("ElasticSearch对数据进行"),t("strong",[a._v("搜索、分析和存储")]),a._v("，其是基于JSON的分布式搜索和分析引擎，专门为实现水平可扩展性、高可靠性和管理便捷性而设计的。")]),a._v(" "),t("p",[a._v("它的实现原理主要分为以下几个步骤：")]),a._v(" "),t("p",[a._v("1）首先用户将数据提交到ElasticSearch数据库中；")]),a._v(" "),t("p",[a._v("2）再通过分词控制器将对应的语句分词；")]),a._v(" "),t("p",[a._v("3）将分词结果及其权重一并存入，以备用户在搜索数据时，根据权重将结果排名和打分，将返回结果呈现给用户；")]),a._v(" "),t("h3",{attrs:{id:"kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kibana"}},[a._v("#")]),a._v(" Kibana")]),a._v(" "),t("p",[a._v("Kibana实现"),t("strong",[a._v("数据可视化")]),a._v("，其作用就是在ElasticSearch中进行民航。Kibana能够以图表的形式呈现数据，并且具有可扩展的用户界面，可以全方位的配置和管理ElasticSearch。")]),a._v(" "),t("p",[a._v("Kibana最早的时候是基于Logstash创建的工具，后被Elastic公司在2013年收购。")]),a._v(" "),t("p",[a._v("1）Kibana可以提供各种可视化的图表；")]),a._v(" "),t("p",[a._v("2）可以通过机器学习的技术，对异常情况进行检测，用于提前发现可疑问题；")]),a._v(" "),t("h1",{attrs:{id:"从日志收集系统看es-stack的发展"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#从日志收集系统看es-stack的发展"}},[a._v("#")]),a._v(" 从日志收集系统看ES Stack的发展")]),a._v(" "),t("hr"),a._v(" "),t("blockquote",[t("p",[a._v("我们看下ELK技术栈的演化，通常体现在日志收集系统中。")])]),a._v(" "),t("p",[a._v("一个典型的日志系统包括：")]),a._v(" "),t("p",[a._v("（1）收集：能够采集多种来源的日志数据")]),a._v(" "),t("p",[a._v("（2）传输：能够稳定的把日志数据解析过滤并传输到存储系统")]),a._v(" "),t("p",[a._v("（3）存储：存储日志数据")]),a._v(" "),t("p",[a._v("（4）分析：支持 UI 分析")]),a._v(" "),t("p",[a._v("（5）警告：能够提供错误报告，监控机制")]),a._v(" "),t("h3",{attrs:{id:"beats-elasticsearch-kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#beats-elasticsearch-kibana"}},[a._v("#")]),a._v(" beats+elasticsearch+kibana")]),a._v(" "),t("p",[a._v("Beats采集数据后，存储在ES中，有Kibana可视化的展示。")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2449),alt:""}})]),a._v(" "),t("h3",{attrs:{id:"beats-logstath-elasticsearch-kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#beats-logstath-elasticsearch-kibana"}},[a._v("#")]),a._v(" beats+logstath+elasticsearch+kibana")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2450),alt:""}})]),a._v(" "),t("p",[a._v("该框架是在上面的框架的基础上引入了logstash，引入logstash带来的好处如下：")]),a._v(" "),t("p",[a._v("（1）Logstash具有基于磁盘的自适应缓冲系统，该系统将吸收传入的吞吐量，从而减轻背压。")]),a._v(" "),t("p",[a._v("（2）从其他数据源（例如数据库，S3或消息传递队列）中提取。")]),a._v(" "),t("p",[a._v("（3）将数据发送到多个目的地，例如S3，HDFS或写入文件。")]),a._v(" "),t("p",[a._v("（4）使用条件数据流逻辑组成更复杂的处理管道。")]),a._v(" "),t("p",[t("strong",[a._v("beats结合logstash带来的优势")]),a._v("：")]),a._v(" "),t("p",[a._v("（1）水平可扩展性，高可用性和可变负载处理：beats和logstash可以实现节点之间的负载均衡，多个logstash可以实现logstash的高可用")]),a._v(" "),t("p",[a._v("（2）消息持久性与至少一次交付保证：使用beats或Winlogbeat进行日志收集时，可以保证至少一次交付。从Filebeat或Winlogbeat到Logstash以及从Logstash到Elasticsearch的两种通信协议都是同步的，并且支持确认。Logstash持久队列提供跨节点故障的保护。对于Logstash中的磁盘级弹性，确保磁盘冗余非常重要。")]),a._v(" "),t("p",[a._v("（3）具有身份验证和有线加密的端到端安全传输：从Beats到Logstash以及从 Logstash到Elasticsearch的传输都可以使用加密方式传递 。与Elasticsearch进行通讯时，有很多安全选项，包括基本身份验证，TLS，PKI，LDAP，AD和其他自定义领域")]),a._v(" "),t("p",[t("strong",[a._v("增加更多的数据源")]),a._v(" 比如：TCP，UDP和HTTP协议是将数据输入Logstash的常用方法")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2451),alt:""}})]),a._v(" "),t("h3",{attrs:{id:"beats-mq-logstash-elasticsearch-kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#beats-mq-logstash-elasticsearch-kibana"}},[a._v("#")]),a._v(" beats+MQ+logstash+elasticsearch+kibana")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2452),alt:""}})]),a._v(" "),t("p",[a._v("在如上的基础上我们可以在beats和logstash中间添加一些组件redis、kafka、RabbitMQ等，添加中间件将会有如下好处：")]),a._v(" "),t("p",[a._v("（1）降低对日志所在机器的影响，这些机器上一般都部署着反向代理或应用服务，本身负载就很重了，所以尽可能的在这些机器上少做事；")]),a._v(" "),t("p",[a._v("（2）如果有很多台机器需要做日志收集，那么让每台机器都向Elasticsearch持续写入数据，必然会对Elasticsearch造成压力，因此需要对数据进行缓冲，同时，这样的缓冲也可以一定程度的保护数据不丢失；")]),a._v(" "),t("p",[a._v("（3）将日志数据的格式化与处理放到Indexer中统一做，可以在一处修改代码、部署，避免需要到多台机器上去修改配置；")]),a._v(" "),t("h1",{attrs:{id:"elastic-stack最佳实践"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elastic-stack最佳实践"}},[a._v("#")]),a._v(" Elastic Stack最佳实践")]),a._v(" "),t("hr"),a._v(" "),t("blockquote",[t("p",[a._v("我们再看下官方开发成员分享的最佳实践。")])]),a._v(" "),t("h3",{attrs:{id:"日志收集系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日志收集系统"}},[a._v("#")]),a._v(" 日志收集系统")]),a._v(" "),t("p",[a._v("（PS：就是我们上面阐述的）")]),a._v(" "),t("p",[a._v("基本的日志系统")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2453),alt:""}})]),a._v(" "),t("p",[a._v("增加数据源，和使用MQ")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2454),alt:""}})]),a._v(" "),t("h3",{attrs:{id:"metric收集和apm性能监控"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#metric收集和apm性能监控"}},[a._v("#")]),a._v(" Metric收集和APM性能监控")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2455),alt:""}})]),a._v(" "),t("h3",{attrs:{id:"多数据中心方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多数据中心方案"}},[a._v("#")]),a._v(" 多数据中心方案")]),a._v(" "),t("p",[a._v("通过冗余实现数据高可用")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2456),alt:""}})]),a._v(" "),t("p",[a._v("两个数据采集中心（比如采集两个工厂的数据），采集数据后的汇聚")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2457),alt:""}})]),a._v(" "),t("p",[a._v("数据分散，跨集群的搜索")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2458),alt:""}})]),a._v(" "),t("h1",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[a._v("#")]),a._v(" 参考文章")]),a._v(" "),t("hr"),a._v(" "),t("ul",[t("li",[a._v("https://www.elastic.co/cn/elasticsearch/")]),a._v(" "),t("li",[a._v("https://www.elastic.co/pdf/architecture-best-practices.pdf")]),a._v(" "),t("li",[a._v("https://www.elastic.co/guide/en/logstash/current/deploying-and-scaling.html")]),a._v(" "),t("li",[a._v("https://www.cnblogs.com/supersnowyao/p/11110703.html")]),a._v(" "),t("li",[a._v("https://blog.51cto.com/wutengfei/2645627)")])])])}),[],!1,null,null,null);t.default=r.exports}}]);