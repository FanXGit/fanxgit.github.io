(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{1152:function(n,s,a){n.exports=a.p+"assets/img/springboot-xxl-job-8.01db7717.png"},1153:function(n,s,a){n.exports=a.p+"assets/img/springboot-xxl-job-1.99a68bd3.png"},1154:function(n,s){n.exports="data:image/png;base64,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"},1155:function(n,s,a){n.exports=a.p+"assets/img/springboot-xxl-job-3.f12f9455.png"},1156:function(n,s,a){n.exports=a.p+"assets/img/springboot-xxl-job-4.5cf98130.png"},1157:function(n,s,a){n.exports=a.p+"assets/img/springboot-xxl-job-5.53e82c7e.png"},1158:function(n,s,a){n.exports=a.p+"assets/img/springboot-xxl-job-6.34cb5bfa.png"},1159:function(n,s,a){n.exports=a.p+"assets/img/springboot-xxl-job-7.6194d138.png"},3709:function(n,s,a){"use strict";a.r(s);var e=a(7),t=Object(e.a)({},(function(){var n=this,s=n._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h1",{attrs:{id:"springboot定时任务-分布式xxl-job方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#springboot定时任务-分布式xxl-job方式"}},[n._v("#")]),n._v(" SpringBoot定时任务 - 分布式xxl-job方式")]),n._v(" "),s("blockquote",[s("p",[n._v("除了前文介绍的ElasticJob，xxl-job在很多中小公司有着应用（虽然其代码和设计等质量并不太高，License不够开放，有着个人主义色彩，但是其具体开箱使用的便捷性和功能相对完善性，这是中小团队采用的主要原因）；XXL-JOB是一个分布式任务调度平台，其核心设计目标是开发迅速、学习简单、轻量级、易扩展。本文介绍XXL-JOB以及SpringBoot的集成。@pdai")])]),n._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#springboot%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1---%E5%88%86%E5%B8%83%E5%BC%8Fxxl-job%E6%96%B9%E5%BC%8F"}},[n._v("SpringBoot定时任务 - 分布式xxl-job方式")]),n._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#%E7%9F%A5%E8%AF%86%E5%87%86%E5%A4%87"}},[n._v("知识准备")]),n._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#%E5%88%86%E5%B8%83%E5%BC%8F%E4%BB%BB%E5%8A%A1%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB"}},[n._v("分布式任务知识体系")])]),n._v(" "),s("li",[s("a",{attrs:{href:"#%E4%BB%80%E4%B9%88%E6%98%AFxxl-job"}},[n._v("什么是xxl-job")])]),n._v(" "),s("li",[s("a",{attrs:{href:"#xxl-job%E7%9A%84%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"}},[n._v("xxl-job的架构设计")]),n._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3"}},[n._v("设计思想")])]),n._v(" "),s("li",[s("a",{attrs:{href:"#%E7%B3%BB%E7%BB%9F%E7%BB%84%E6%88%90"}},[n._v("系统组成")])]),n._v(" "),s("li",[s("a",{attrs:{href:"#%E6%9E%B6%E6%9E%84%E5%9B%BE"}},[n._v("架构图")])])])])])]),n._v(" "),s("li",[s("a",{attrs:{href:"#%E5%AE%9E%E7%8E%B0%E6%A1%88%E4%BE%8B"}},[n._v("实现案例")]),n._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#bean%E6%A8%A1%E5%BC%8F%E5%9F%BA%E4%BA%8E%E6%96%B9%E6%B3%95"}},[n._v("Bean模式(基于方法)")]),n._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#job%E7%9A%84%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E4%BE%9D%E8%B5%96"}},[n._v("Job的开发环境依赖")])]),n._v(" "),s("li",[s("a",{attrs:{href:"#job%E7%9A%84%E5%BC%80%E5%8F%91"}},[n._v("Job的开发")])]),n._v(" "),s("li",[s("a",{attrs:{href:"#job%E7%9A%84%E8%B0%83%E5%BA%A6%E9%85%8D%E7%BD%AE%E5%92%8C%E6%89%A7%E8%A1%8C"}},[n._v("Job的调度配置和执行")])])])]),n._v(" "),s("li",[s("a",{attrs:{href:"#bean%E6%A8%A1%E5%BC%8F%E5%9F%BA%E4%BA%8E%E7%B1%BB"}},[n._v("Bean模式(基于类)")]),n._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#job%E7%9A%84%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E4%BE%9D%E8%B5%96-1"}},[n._v("Job的开发环境依赖")])]),n._v(" "),s("li",[s("a",{attrs:{href:"#job%E7%9A%84%E5%BC%80%E5%8F%91-1"}},[n._v("Job的开发")])]),n._v(" "),s("li",[s("a",{attrs:{href:"#job%E7%9A%84%E8%B0%83%E5%BA%A6%E9%85%8D%E7%BD%AE%E5%92%8C%E6%89%A7%E8%A1%8C-1"}},[n._v("Job的调度配置和执行")])])])]),n._v(" "),s("li",[s("a",{attrs:{href:"#glue%E6%A8%A1%E5%BC%8F"}},[n._v("GLUE模式")]),n._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#%E9%85%8D%E7%BD%AE%E5%92%8C%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B"}},[n._v("配置和启动流程")])]),n._v(" "),s("li",[s("a",{attrs:{href:"#glue%E6%A8%A1%E5%BC%8F%E8%BF%98%E6%9C%89%E5%93%AA%E4%BA%9B"}},[n._v("GLUE模式还有哪些")])])])]),n._v(" "),s("li",[s("a",{attrs:{href:"#%E6%9B%B4%E5%A4%9A%E9%85%8D%E7%BD%AE%E7%9A%84%E8%AF%B4%E6%98%8E"}},[n._v("更多配置的说明")])])])]),n._v(" "),s("li",[s("a",{attrs:{href:"#%E7%A4%BA%E4%BE%8B%E6%BA%90%E7%A0%81"}},[n._v("示例源码")])])])])]),n._v(" "),s("h1",{attrs:{id:"知识准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#知识准备"}},[n._v("#")]),n._v(" 知识准备")]),n._v(" "),s("hr"),n._v(" "),s("blockquote",[s("p",[n._v("需要对分布式任务的知识体系和xxl-Job有基本的理解。@pdai")])]),n._v(" "),s("h3",{attrs:{id:"分布式任务知识体系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分布式任务知识体系"}},[n._v("#")]),n._v(" 分布式任务知识体系")]),n._v(" "),s("blockquote",[s("p",[n._v("站在分布式任务知识体系的角度看分布式任务。")])]),n._v(" "),s("p",[s("a",{attrs:{href:"https://pdai.tech/md/arch/arch-z-job.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("分布式系统 - 分布式任务及实现方案"),s("OutboundLink")],1)]),n._v(" "),s("ul",[s("li",[n._v("本文主要介绍定时任务的基础和单体方式下定时任务方案的演化，以及常见的分布式任务方案(包括Quartz Cluster，ElasticJob，xxl-job等）和技术实现要点。")])]),n._v(" "),s("h3",{attrs:{id:"什么是xxl-job"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是xxl-job"}},[n._v("#")]),n._v(" 什么是xxl-job")]),n._v(" "),s("blockquote",[s("p",[n._v("XXL-JOB是一个分布式任务调度平台，其核心设计目标是开发迅速、学习简单、轻量级、易扩展。现已开放源代码并接入多家公司线上产品线，开箱即用。如下内容来源于"),s("a",{attrs:{href:"https://www.xuxueli.com/xxl-job/",target:"_blank",rel:"noopener noreferrer"}},[n._v("xxl-job官网 在新窗口打开"),s("OutboundLink")],1)])]),n._v(" "),s("p",[n._v("支持如下特性：")]),n._v(" "),s("ul",[s("li",[n._v("1、简单：支持通过Web页面对任务进行CRUD操作，操作简单，一分钟上手；")]),n._v(" "),s("li",[n._v("2、动态：支持动态修改任务状态、启动/停止任务，以及终止运行中任务，即时生效；")]),n._v(" "),s("li",[n._v("3、调度中心HA（中心式）：调度采用中心式设计，“调度中心”自研调度组件并支持集群部署，可保证调度中心HA；")]),n._v(" "),s("li",[n._v('4、执行器HA（分布式）：任务分布式执行，任务"执行器"支持集群部署，可保证任务执行HA；')]),n._v(" "),s("li",[n._v("5、注册中心: 执行器会周期性自动注册任务, 调度中心将会自动发现注册的任务并触发执行。同时，也支持手动录入执行器地址；")]),n._v(" "),s("li",[n._v("6、弹性扩容缩容：一旦有新执行器机器上线或者下线，下次调度时将会重新分配任务；")]),n._v(" "),s("li",[n._v("7、触发策略：提供丰富的任务触发策略，包括：Cron触发、固定间隔触发、固定延时触发、API（事件）触发、人工触发、父子任务触发；")]),n._v(" "),s("li",[n._v("8、调度过期策略：调度中心错过调度时间的补偿处理策略，包括：忽略、立即补偿触发一次等；")]),n._v(" "),s("li",[n._v("9、阻塞处理策略：调度过于密集执行器来不及处理时的处理策略，策略包括：单机串行（默认）、丢弃后续调度、覆盖之前调度；")]),n._v(" "),s("li",[n._v("10、任务超时控制：支持自定义任务超时时间，任务运行超时将会主动中断任务；")]),n._v(" "),s("li",[n._v("11、任务失败重试：支持自定义任务失败重试次数，当任务失败时将会按照预设的失败重试次数主动进行重试；其中分片任务支持分片粒度的失败重试；")]),n._v(" "),s("li",[n._v("12、任务失败告警；默认提供邮件方式失败告警，同时预留扩展接口，可方便的扩展短信、钉钉等告警方式；")]),n._v(" "),s("li",[n._v("13、路由策略：执行器集群部署时提供丰富的路由策略，包括：第一个、最后一个、轮询、随机、一致性HASH、最不经常使用、最近最久未使用、故障转移、忙碌转移等；")]),n._v(" "),s("li",[n._v('14、分片广播任务：执行器集群部署时，任务路由策略选择"分片广播"情况下，一次任务调度将会广播触发集群中所有执行器执行一次任务，可根据分片参数开发分片任务；')]),n._v(" "),s("li",[n._v("15、动态分片：分片广播任务以执行器为维度进行分片，支持动态扩容执行器集群从而动态增加分片数量，协同进行业务处理；在进行大数据量业务操作时可显著提升任务处理能力和速度。")]),n._v(" "),s("li",[n._v('16、故障转移：任务路由策略选择"故障转移"情况下，如果执行器集群中某一台机器故障，将会自动Failover切换到一台正常的执行器发送调度请求。')]),n._v(" "),s("li",[n._v("17、任务进度监控：支持实时监控任务进度；")]),n._v(" "),s("li",[n._v("18、Rolling实时日志：支持在线查看调度结果，并且支持以Rolling方式实时查看执行器输出的完整的执行日志；")]),n._v(" "),s("li",[n._v("19、GLUE：提供Web IDE，支持在线开发任务逻辑代码，动态发布，实时编译生效，省略部署上线的过程。支持30个版本的历史版本回溯。")]),n._v(" "),s("li",[n._v("20、脚本任务：支持以GLUE模式开发和运行脚本任务，包括Shell、Python、NodeJS、PHP、PowerShell等类型脚本;")]),n._v(" "),s("li",[n._v('21、命令行任务：原生提供通用命令行任务Handler（Bean任务，"CommandJobHandler"）；业务方只需要提供命令行即可；')]),n._v(" "),s("li",[n._v("22、任务依赖：支持配置子任务依赖，当父任务执行结束且执行成功后将会主动触发一次子任务的执行, 多个子任务用逗号分隔；")]),n._v(" "),s("li",[n._v("23、一致性：“调度中心”通过DB锁保证集群分布式调度的一致性, 一次任务调度只会触发一次执行；")]),n._v(" "),s("li",[n._v("24、自定义任务参数：支持在线配置调度任务入参，即时生效；")]),n._v(" "),s("li",[n._v("25、调度线程池：调度系统多线程触发调度运行，确保调度精确执行，不被堵塞；")]),n._v(" "),s("li",[n._v("26、数据加密：调度中心和执行器之间的通讯进行数据加密，提升调度信息安全性；")]),n._v(" "),s("li",[n._v("27、邮件报警：任务失败时支持邮件报警，支持配置多邮件地址群发报警邮件；")]),n._v(" "),s("li",[n._v("28、推送maven中央仓库: 将会把最新稳定版推送到maven中央仓库, 方便用户接入和使用;")]),n._v(" "),s("li",[n._v("29、运行报表：支持实时查看运行数据，如任务数量、调度次数、执行器数量等；以及调度报表，如调度日期分布图，调度成功分布图等；")]),n._v(" "),s("li",[n._v("30、全异步：任务调度流程全异步化设计实现，如异步调度、异步运行、异步回调等，有效对密集调度进行流量削峰，理论上支持任意时长任务的运行；")]),n._v(" "),s("li",[n._v("31、跨语言：调度中心与执行器提供语言无关的 RESTful API 服务，第三方任意语言可据此对接调度中心或者实现执行器。除此之外，还提供了 “多任务模式”和“httpJobHandler”等其他跨语言方案；")]),n._v(" "),s("li",[n._v("32、国际化：调度中心支持国际化设置，提供中文、英文两种可选语言，默认为中文；")]),n._v(" "),s("li",[n._v("33、容器化：提供官方docker镜像，并实时更新推送dockerhub，进一步实现产品开箱即用；")]),n._v(" "),s("li",[n._v('34、线程池隔离：调度线程池进行隔离拆分，慢任务自动降级进入"Slow"线程池，避免耗尽调度线程，提高系统稳定性；')]),n._v(" "),s("li",[n._v("35、用户管理：支持在线管理系统用户，存在管理员、普通用户两种角色；")]),n._v(" "),s("li",[n._v("36、权限控制：执行器维度进行权限控制，管理员拥有全量权限，普通用户需要分配执行器权限后才允许相关操作；")])]),n._v(" "),s("h3",{attrs:{id:"xxl-job的架构设计"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xxl-job的架构设计"}},[n._v("#")]),n._v(" xxl-job的架构设计")]),n._v(" "),s("h4",{attrs:{id:"设计思想"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设计思想"}},[n._v("#")]),n._v(" 设计思想")]),n._v(" "),s("p",[n._v("将调度行为抽象形成“调度中心”公共平台，而平台自身并不承担业务逻辑，“调度中心”负责发起调度请求。")]),n._v(" "),s("p",[n._v("将任务抽象成分散的JobHandler，交由“执行器”统一管理，“执行器”负责接收调度请求并执行对应的JobHandler中业务逻辑。")]),n._v(" "),s("p",[n._v("因此，“调度”和“任务”两部分可以相互解耦，提高系统整体稳定性和扩展性；")]),n._v(" "),s("h4",{attrs:{id:"系统组成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#系统组成"}},[n._v("#")]),n._v(" 系统组成")]),n._v(" "),s("ol",[s("li",[s("strong",[n._v("调度模块")]),n._v("（调度中心）\n"),s("ol",[s("li",[n._v("负责管理调度信息，按照调度配置发出调度请求，自身不承担业务代码。调度系统与任务解耦，提高了系统可用性和稳定性，同时调度系统性能不再受限于任务模块；")]),n._v(" "),s("li",[n._v("支持可视化、简单且动态的管理调度信息，包括任务新建，更新，删除，GLUE开发和任务报警等，所有上述操作都会实时生效，同时支持监控调度结果以及执行日志，支持执行器Failover。")])])]),n._v(" "),s("li",[s("strong",[n._v("执行模块")]),n._v("（执行器）：\n"),s("ol",[s("li",[n._v("负责接收调度请求并执行任务逻辑。任务模块专注于任务的执行等操作，开发和维护更加简单和高效；")]),n._v(" "),s("li",[n._v("接收“调度中心”的执行请求、终止请求和日志请求等。")])])])]),n._v(" "),s("h4",{attrs:{id:"架构图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#架构图"}},[n._v("#")]),n._v(" 架构图")]),n._v(" "),s("p",[s("img",{attrs:{src:a(1152),alt:""}})]),n._v(" "),s("h1",{attrs:{id:"实现案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现案例"}},[n._v("#")]),n._v(" 实现案例")]),n._v(" "),s("hr"),n._v(" "),s("blockquote",[s("p",[n._v("主要介绍SpringBoot集成xxl-job的方式：Bean模式（基于方法和基于类）； 以及基于在线配置代码/脚本的GLUE模式。")])]),n._v(" "),s("h3",{attrs:{id:"bean模式-基于方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bean模式-基于方法"}},[n._v("#")]),n._v(" Bean模式(基于方法)")]),n._v(" "),s("blockquote",[s("p",[n._v("Bean模式任务，支持基于方法的开发方式，每个任务对应一个方法。基于方法开发的任务，底层会生成JobHandler代理，和基于类的方式一样，任务也会以JobHandler的形式存在于执行器任务容器中。")])]),n._v(" "),s("p",[s("strong",[n._v("优点")]),n._v("：")]),n._v(" "),s("ul",[s("li",[n._v("每个任务只需要开发一个方法，并添加”@XxlJob”注解即可，更加方便、快速。")]),n._v(" "),s("li",[n._v("支持自动扫描任务并注入到执行器容器。")])]),n._v(" "),s("p",[s("strong",[n._v("缺点")]),n._v("：要求Spring容器环境；")]),n._v(" "),s("h4",{attrs:{id:"job的开发环境依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#job的开发环境依赖"}},[n._v("#")]),n._v(" Job的开发环境依赖")]),n._v(" "),s("p",[n._v("Maven 依赖")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("<dependency>\n    <groupId>com.xuxueli</groupId>\n    <artifactId>xxl-job-core</artifactId>\n    <version>2.3.1</version>\n</dependency>\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br")])]),s("p",[n._v("application.properties配置")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('# web port\nserver.port=8081\n# no web\n#spring.main.web-environment=false\n\n# log config\nlogging.config=classpath:logback.xml\n\n\n### xxl-job admin address list, such as "http://address" or "http://address01,http://address02"\nxxl.job.admin.addresses=http://127.0.0.1:8080/xxl-job-admin\n\n### xxl-job, access token\nxxl.job.accessToken=default_token\n\n### xxl-job executor appname\nxxl.job.executor.appname=xxl-job-executor-sample\n### xxl-job executor registry-address: default use address to registry , otherwise use ip:port if address is null\nxxl.job.executor.address=\n### xxl-job executor server-info\nxxl.job.executor.ip=\nxxl.job.executor.port=9999\n### xxl-job executor log-path\nxxl.job.executor.logpath=/data/applogs/xxl-job/jobhandler\n### xxl-job executor log-retention-days\nxxl.job.executor.logretentiondays=30\n\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br")])]),s("p",[n._v("Config配置(PS：这里我是直接拿的xxl-job demo中的配置，实际开发中可以封装一个starter自动注入)")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('package tech.pdai.springboot.xxljob.config;\n\nimport com.xxl.job.core.executor.impl.XxlJobSpringExecutor;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n/**\n * xxl-job config\n *\n * @author xuxueli 2017-04-28\n */\n@Configuration\npublic class XxlJobConfig {\n    private Logger logger = LoggerFactory.getLogger(XxlJobConfig.class);\n\n    @Value("${xxl.job.admin.addresses}")\n    private String adminAddresses;\n\n    @Value("${xxl.job.accessToken}")\n    private String accessToken;\n\n    @Value("${xxl.job.executor.appname}")\n    private String appname;\n\n    @Value("${xxl.job.executor.address}")\n    private String address;\n\n    @Value("${xxl.job.executor.ip}")\n    private String ip;\n\n    @Value("${xxl.job.executor.port}")\n    private int port;\n\n    @Value("${xxl.job.executor.logpath}")\n    private String logPath;\n\n    @Value("${xxl.job.executor.logretentiondays}")\n    private int logRetentionDays;\n\n\n    @Bean\n    public XxlJobSpringExecutor xxlJobExecutor() {\n        logger.info(">>>>>>>>>>> xxl-job config init.");\n        XxlJobSpringExecutor xxlJobSpringExecutor = new XxlJobSpringExecutor();\n        xxlJobSpringExecutor.setAdminAddresses(adminAddresses);\n        xxlJobSpringExecutor.setAppname(appname);\n        xxlJobSpringExecutor.setAddress(address);\n        xxlJobSpringExecutor.setIp(ip);\n        xxlJobSpringExecutor.setPort(port);\n        xxlJobSpringExecutor.setAccessToken(accessToken);\n        xxlJobSpringExecutor.setLogPath(logPath);\n        xxlJobSpringExecutor.setLogRetentionDays(logRetentionDays);\n\n        // Bean方法模式\n        // 通过扫描@XxlJob方式注册\n\n        // 注册Bean类模式\n        XxlJobExecutor.registJobHandler("beanClassDemoJobHandler", new BeanClassDemoJob());\n\n        return xxlJobSpringExecutor;\n    }\n\n}\n\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br"),s("span",{staticClass:"line-number"},[n._v("38")]),s("br"),s("span",{staticClass:"line-number"},[n._v("39")]),s("br"),s("span",{staticClass:"line-number"},[n._v("40")]),s("br"),s("span",{staticClass:"line-number"},[n._v("41")]),s("br"),s("span",{staticClass:"line-number"},[n._v("42")]),s("br"),s("span",{staticClass:"line-number"},[n._v("43")]),s("br"),s("span",{staticClass:"line-number"},[n._v("44")]),s("br"),s("span",{staticClass:"line-number"},[n._v("45")]),s("br"),s("span",{staticClass:"line-number"},[n._v("46")]),s("br"),s("span",{staticClass:"line-number"},[n._v("47")]),s("br"),s("span",{staticClass:"line-number"},[n._v("48")]),s("br"),s("span",{staticClass:"line-number"},[n._v("49")]),s("br"),s("span",{staticClass:"line-number"},[n._v("50")]),s("br"),s("span",{staticClass:"line-number"},[n._v("51")]),s("br"),s("span",{staticClass:"line-number"},[n._v("52")]),s("br"),s("span",{staticClass:"line-number"},[n._v("53")]),s("br"),s("span",{staticClass:"line-number"},[n._v("54")]),s("br"),s("span",{staticClass:"line-number"},[n._v("55")]),s("br"),s("span",{staticClass:"line-number"},[n._v("56")]),s("br"),s("span",{staticClass:"line-number"},[n._v("57")]),s("br"),s("span",{staticClass:"line-number"},[n._v("58")]),s("br"),s("span",{staticClass:"line-number"},[n._v("59")]),s("br"),s("span",{staticClass:"line-number"},[n._v("60")]),s("br"),s("span",{staticClass:"line-number"},[n._v("61")]),s("br"),s("span",{staticClass:"line-number"},[n._v("62")]),s("br"),s("span",{staticClass:"line-number"},[n._v("63")]),s("br"),s("span",{staticClass:"line-number"},[n._v("64")]),s("br"),s("span",{staticClass:"line-number"},[n._v("65")]),s("br"),s("span",{staticClass:"line-number"},[n._v("66")]),s("br"),s("span",{staticClass:"line-number"},[n._v("67")]),s("br")])]),s("h4",{attrs:{id:"job的开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#job的开发"}},[n._v("#")]),n._v(" Job的开发")]),n._v(" "),s("p",[n._v("开发步骤：")]),n._v(" "),s("ol",[s("li",[n._v("任务开发：在Spring Bean实例中，开发Job方法；")]),n._v(" "),s("li",[n._v('注解配置：为Job方法添加注解 "@XxlJob(value="自定义jobhandler名称", init = "JobHandler初始化方法", destroy = "JobHandler销毁方法")"，注解value值对应的是调度中心新建任务的JobHandler属性的值。')]),n._v(" "),s("li",[n._v('执行日志：需要通过 "XxlJobHelper.log" 打印执行日志；')]),n._v(" "),s("li",[n._v('任务结果：默认任务结果为 "成功" 状态，不需要主动设置；如有诉求，比如设置任务结果为失败，可以通过 "XxlJobHelper.handleFail/handleSuccess" 自主设置任务结果；')])]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('package tech.pdai.springboot.xxljob.job;\n\nimport java.io.BufferedInputStream;\nimport java.io.BufferedReader;\nimport java.io.DataOutputStream;\nimport java.io.InputStreamReader;\nimport java.net.HttpURLConnection;\nimport java.net.URL;\nimport java.util.Arrays;\n\nimport com.xxl.job.core.context.XxlJobHelper;\nimport com.xxl.job.core.handler.annotation.XxlJob;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.stereotype.Component;\n\n/**\n * XxlJob开发示例（Bean模式 - 方法）\n * \n */\n@Slf4j\n@Component\npublic class BeanMethodDemoJob {\n\n    /**\n     * 1、简单任务示例（Bean模式）\n     */\n    @XxlJob("demoJobHandler")\n    public void demoJobHandler() {\n        XxlJobHelper.log("demoJobHandler execute...");\n    }\n\n    /**\n     * 2、分片广播任务\n     */\n    @XxlJob("shardingJobHandler")\n    public void shardingJobHandler() throws Exception {\n        // logback console日志\n        log.info("shardingJobHandler execute...");\n\n        // 通过xxl记录到DB中的日志\n        XxlJobHelper.log("shardingJobHandler execute...");\n\n        // 分片参数\n        int shardIndex = XxlJobHelper.getShardIndex();\n        int shardTotal = XxlJobHelper.getShardTotal();\n\n        XxlJobHelper.log("分片参数：当前分片序号 = {}, 总分片数 = {}", shardIndex, shardTotal);\n\n        // 业务逻辑\n        for (int i = 0; i < shardTotal; i++) {\n            if (i==shardIndex) {\n                XxlJobHelper.log("第 {} 片, 命中分片开始处理", i);\n            } else {\n                XxlJobHelper.log("第 {} 片, 忽略", i);\n            }\n        }\n\n    }\n\n\n    /**\n     * 3、命令行任务\n     */\n    @XxlJob("commandJobHandler")\n    public void commandJobHandler() throws Exception {\n        XxlJobHelper.log("commandJobHandler execute...");\n\n        String command = XxlJobHelper.getJobParam();\n        int exitValue = -1;\n\n        BufferedReader bufferedReader = null;\n        try {\n            // command process\n            ProcessBuilder processBuilder = new ProcessBuilder();\n            processBuilder.command(command);\n            processBuilder.redirectErrorStream(true);\n\n            Process process = processBuilder.start();\n            //Process process = Runtime.getRuntime().exec(command);\n\n            BufferedInputStream bufferedInputStream = new BufferedInputStream(process.getInputStream());\n            bufferedReader = new BufferedReader(new InputStreamReader(bufferedInputStream));\n\n            // command log\n            String line;\n            while ((line = bufferedReader.readLine())!=null) {\n                XxlJobHelper.log(line);\n            }\n\n            // command exit\n            process.waitFor();\n            exitValue = process.exitValue();\n        } catch (Exception e) {\n            XxlJobHelper.log(e);\n        } finally {\n            if (bufferedReader!=null) {\n                bufferedReader.close();\n            }\n        }\n\n        if (exitValue==0) {\n            // default success\n        } else {\n            XxlJobHelper.handleFail("command exit value(" + exitValue + ") is failed");\n        }\n\n    }\n\n\n    /**\n     * 4、跨平台Http任务\n     * 参数示例：\n     * "url: http://www.baidu.com\\n" +\n     * "method: get\\n" +\n     * "data: content\\n";\n     */\n    @XxlJob("httpJobHandler")\n    public void httpJobHandler() throws Exception {\n        XxlJobHelper.log("httpJobHandler execute...");\n\n        // param parse\n        String param = XxlJobHelper.getJobParam();\n        if (param==null || param.trim().length()==0) {\n            XxlJobHelper.log("param[" + param + "] invalid.");\n\n            XxlJobHelper.handleFail();\n            return;\n        }\n\n        String[] httpParams = param.split("\\n");\n        String url = null;\n        String method = null;\n        String data = null;\n        for (String httpParam : httpParams) {\n            if (httpParam.startsWith("url:")) {\n                url = httpParam.substring(httpParam.indexOf("url:") + 4).trim();\n            }\n            if (httpParam.startsWith("method:")) {\n                method = httpParam.substring(httpParam.indexOf("method:") + 7).trim().toUpperCase();\n            }\n            if (httpParam.startsWith("data:")) {\n                data = httpParam.substring(httpParam.indexOf("data:") + 5).trim();\n            }\n        }\n\n        // param valid\n        if (url==null || url.trim().length()==0) {\n            XxlJobHelper.log("url[" + url + "] invalid.");\n\n            XxlJobHelper.handleFail();\n            return;\n        }\n        if (method==null || !Arrays.asList("GET", "POST").contains(method)) {\n            XxlJobHelper.log("method[" + method + "] invalid.");\n\n            XxlJobHelper.handleFail();\n            return;\n        }\n        boolean isPostMethod = method.equals("POST");\n\n        // request\n        HttpURLConnection connection = null;\n        BufferedReader bufferedReader = null;\n        try {\n            // connection\n            URL realUrl = new URL(url);\n            connection = (HttpURLConnection) realUrl.openConnection();\n\n            // connection setting\n            connection.setRequestMethod(method);\n            connection.setDoOutput(isPostMethod);\n            connection.setDoInput(true);\n            connection.setUseCaches(false);\n            connection.setReadTimeout(5 * 1000);\n            connection.setConnectTimeout(3 * 1000);\n            connection.setRequestProperty("connection", "Keep-Alive");\n            connection.setRequestProperty("Content-Type", "application/json;charset=UTF-8");\n            connection.setRequestProperty("Accept-Charset", "application/json;charset=UTF-8");\n\n            // do connection\n            connection.connect();\n\n            // data\n            if (isPostMethod && data!=null && data.trim().length() > 0) {\n                DataOutputStream dataOutputStream = new DataOutputStream(connection.getOutputStream());\n                dataOutputStream.write(data.getBytes("UTF-8"));\n                dataOutputStream.flush();\n                dataOutputStream.close();\n            }\n\n            // valid StatusCode\n            int statusCode = connection.getResponseCode();\n            if (statusCode!=200) {\n                throw new RuntimeException("Http Request StatusCode(" + statusCode + ") Invalid.");\n            }\n\n            // result\n            bufferedReader = new BufferedReader(new InputStreamReader(connection.getInputStream(), "UTF-8"));\n            StringBuilder result = new StringBuilder();\n            String line;\n            while ((line = bufferedReader.readLine())!=null) {\n                result.append(line);\n            }\n            String responseMsg = result.toString();\n\n            XxlJobHelper.log(responseMsg);\n\n            return;\n        } catch (Exception e) {\n            XxlJobHelper.log(e);\n\n            XxlJobHelper.handleFail();\n            return;\n        } finally {\n            try {\n                if (bufferedReader!=null) {\n                    bufferedReader.close();\n                }\n                if (connection!=null) {\n                    connection.disconnect();\n                }\n            } catch (Exception e2) {\n                XxlJobHelper.log(e2);\n            }\n        }\n\n    }\n\n    /**\n     * 5、生命周期任务示例：任务初始化与销毁时，支持自定义相关逻辑；\n     */\n    @XxlJob(value = "demoJobHandler2", init = "init", destroy = "destroy")\n    public void demoJobHandler2() throws Exception {\n        XxlJobHelper.log("demoJobHandler2, execute...");\n    }\n\n    public void init() {\n        log.info("init");\n    }\n\n    public void destroy() {\n        log.info("destroy");\n    }\n\n\n}\n\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br"),s("span",{staticClass:"line-number"},[n._v("38")]),s("br"),s("span",{staticClass:"line-number"},[n._v("39")]),s("br"),s("span",{staticClass:"line-number"},[n._v("40")]),s("br"),s("span",{staticClass:"line-number"},[n._v("41")]),s("br"),s("span",{staticClass:"line-number"},[n._v("42")]),s("br"),s("span",{staticClass:"line-number"},[n._v("43")]),s("br"),s("span",{staticClass:"line-number"},[n._v("44")]),s("br"),s("span",{staticClass:"line-number"},[n._v("45")]),s("br"),s("span",{staticClass:"line-number"},[n._v("46")]),s("br"),s("span",{staticClass:"line-number"},[n._v("47")]),s("br"),s("span",{staticClass:"line-number"},[n._v("48")]),s("br"),s("span",{staticClass:"line-number"},[n._v("49")]),s("br"),s("span",{staticClass:"line-number"},[n._v("50")]),s("br"),s("span",{staticClass:"line-number"},[n._v("51")]),s("br"),s("span",{staticClass:"line-number"},[n._v("52")]),s("br"),s("span",{staticClass:"line-number"},[n._v("53")]),s("br"),s("span",{staticClass:"line-number"},[n._v("54")]),s("br"),s("span",{staticClass:"line-number"},[n._v("55")]),s("br"),s("span",{staticClass:"line-number"},[n._v("56")]),s("br"),s("span",{staticClass:"line-number"},[n._v("57")]),s("br"),s("span",{staticClass:"line-number"},[n._v("58")]),s("br"),s("span",{staticClass:"line-number"},[n._v("59")]),s("br"),s("span",{staticClass:"line-number"},[n._v("60")]),s("br"),s("span",{staticClass:"line-number"},[n._v("61")]),s("br"),s("span",{staticClass:"line-number"},[n._v("62")]),s("br"),s("span",{staticClass:"line-number"},[n._v("63")]),s("br"),s("span",{staticClass:"line-number"},[n._v("64")]),s("br"),s("span",{staticClass:"line-number"},[n._v("65")]),s("br"),s("span",{staticClass:"line-number"},[n._v("66")]),s("br"),s("span",{staticClass:"line-number"},[n._v("67")]),s("br"),s("span",{staticClass:"line-number"},[n._v("68")]),s("br"),s("span",{staticClass:"line-number"},[n._v("69")]),s("br"),s("span",{staticClass:"line-number"},[n._v("70")]),s("br"),s("span",{staticClass:"line-number"},[n._v("71")]),s("br"),s("span",{staticClass:"line-number"},[n._v("72")]),s("br"),s("span",{staticClass:"line-number"},[n._v("73")]),s("br"),s("span",{staticClass:"line-number"},[n._v("74")]),s("br"),s("span",{staticClass:"line-number"},[n._v("75")]),s("br"),s("span",{staticClass:"line-number"},[n._v("76")]),s("br"),s("span",{staticClass:"line-number"},[n._v("77")]),s("br"),s("span",{staticClass:"line-number"},[n._v("78")]),s("br"),s("span",{staticClass:"line-number"},[n._v("79")]),s("br"),s("span",{staticClass:"line-number"},[n._v("80")]),s("br"),s("span",{staticClass:"line-number"},[n._v("81")]),s("br"),s("span",{staticClass:"line-number"},[n._v("82")]),s("br"),s("span",{staticClass:"line-number"},[n._v("83")]),s("br"),s("span",{staticClass:"line-number"},[n._v("84")]),s("br"),s("span",{staticClass:"line-number"},[n._v("85")]),s("br"),s("span",{staticClass:"line-number"},[n._v("86")]),s("br"),s("span",{staticClass:"line-number"},[n._v("87")]),s("br"),s("span",{staticClass:"line-number"},[n._v("88")]),s("br"),s("span",{staticClass:"line-number"},[n._v("89")]),s("br"),s("span",{staticClass:"line-number"},[n._v("90")]),s("br"),s("span",{staticClass:"line-number"},[n._v("91")]),s("br"),s("span",{staticClass:"line-number"},[n._v("92")]),s("br"),s("span",{staticClass:"line-number"},[n._v("93")]),s("br"),s("span",{staticClass:"line-number"},[n._v("94")]),s("br"),s("span",{staticClass:"line-number"},[n._v("95")]),s("br"),s("span",{staticClass:"line-number"},[n._v("96")]),s("br"),s("span",{staticClass:"line-number"},[n._v("97")]),s("br"),s("span",{staticClass:"line-number"},[n._v("98")]),s("br"),s("span",{staticClass:"line-number"},[n._v("99")]),s("br"),s("span",{staticClass:"line-number"},[n._v("100")]),s("br"),s("span",{staticClass:"line-number"},[n._v("101")]),s("br"),s("span",{staticClass:"line-number"},[n._v("102")]),s("br"),s("span",{staticClass:"line-number"},[n._v("103")]),s("br"),s("span",{staticClass:"line-number"},[n._v("104")]),s("br"),s("span",{staticClass:"line-number"},[n._v("105")]),s("br"),s("span",{staticClass:"line-number"},[n._v("106")]),s("br"),s("span",{staticClass:"line-number"},[n._v("107")]),s("br"),s("span",{staticClass:"line-number"},[n._v("108")]),s("br"),s("span",{staticClass:"line-number"},[n._v("109")]),s("br"),s("span",{staticClass:"line-number"},[n._v("110")]),s("br"),s("span",{staticClass:"line-number"},[n._v("111")]),s("br"),s("span",{staticClass:"line-number"},[n._v("112")]),s("br"),s("span",{staticClass:"line-number"},[n._v("113")]),s("br"),s("span",{staticClass:"line-number"},[n._v("114")]),s("br"),s("span",{staticClass:"line-number"},[n._v("115")]),s("br"),s("span",{staticClass:"line-number"},[n._v("116")]),s("br"),s("span",{staticClass:"line-number"},[n._v("117")]),s("br"),s("span",{staticClass:"line-number"},[n._v("118")]),s("br"),s("span",{staticClass:"line-number"},[n._v("119")]),s("br"),s("span",{staticClass:"line-number"},[n._v("120")]),s("br"),s("span",{staticClass:"line-number"},[n._v("121")]),s("br"),s("span",{staticClass:"line-number"},[n._v("122")]),s("br"),s("span",{staticClass:"line-number"},[n._v("123")]),s("br"),s("span",{staticClass:"line-number"},[n._v("124")]),s("br"),s("span",{staticClass:"line-number"},[n._v("125")]),s("br"),s("span",{staticClass:"line-number"},[n._v("126")]),s("br"),s("span",{staticClass:"line-number"},[n._v("127")]),s("br"),s("span",{staticClass:"line-number"},[n._v("128")]),s("br"),s("span",{staticClass:"line-number"},[n._v("129")]),s("br"),s("span",{staticClass:"line-number"},[n._v("130")]),s("br"),s("span",{staticClass:"line-number"},[n._v("131")]),s("br"),s("span",{staticClass:"line-number"},[n._v("132")]),s("br"),s("span",{staticClass:"line-number"},[n._v("133")]),s("br"),s("span",{staticClass:"line-number"},[n._v("134")]),s("br"),s("span",{staticClass:"line-number"},[n._v("135")]),s("br"),s("span",{staticClass:"line-number"},[n._v("136")]),s("br"),s("span",{staticClass:"line-number"},[n._v("137")]),s("br"),s("span",{staticClass:"line-number"},[n._v("138")]),s("br"),s("span",{staticClass:"line-number"},[n._v("139")]),s("br"),s("span",{staticClass:"line-number"},[n._v("140")]),s("br"),s("span",{staticClass:"line-number"},[n._v("141")]),s("br"),s("span",{staticClass:"line-number"},[n._v("142")]),s("br"),s("span",{staticClass:"line-number"},[n._v("143")]),s("br"),s("span",{staticClass:"line-number"},[n._v("144")]),s("br"),s("span",{staticClass:"line-number"},[n._v("145")]),s("br"),s("span",{staticClass:"line-number"},[n._v("146")]),s("br"),s("span",{staticClass:"line-number"},[n._v("147")]),s("br"),s("span",{staticClass:"line-number"},[n._v("148")]),s("br"),s("span",{staticClass:"line-number"},[n._v("149")]),s("br"),s("span",{staticClass:"line-number"},[n._v("150")]),s("br"),s("span",{staticClass:"line-number"},[n._v("151")]),s("br"),s("span",{staticClass:"line-number"},[n._v("152")]),s("br"),s("span",{staticClass:"line-number"},[n._v("153")]),s("br"),s("span",{staticClass:"line-number"},[n._v("154")]),s("br"),s("span",{staticClass:"line-number"},[n._v("155")]),s("br"),s("span",{staticClass:"line-number"},[n._v("156")]),s("br"),s("span",{staticClass:"line-number"},[n._v("157")]),s("br"),s("span",{staticClass:"line-number"},[n._v("158")]),s("br"),s("span",{staticClass:"line-number"},[n._v("159")]),s("br"),s("span",{staticClass:"line-number"},[n._v("160")]),s("br"),s("span",{staticClass:"line-number"},[n._v("161")]),s("br"),s("span",{staticClass:"line-number"},[n._v("162")]),s("br"),s("span",{staticClass:"line-number"},[n._v("163")]),s("br"),s("span",{staticClass:"line-number"},[n._v("164")]),s("br"),s("span",{staticClass:"line-number"},[n._v("165")]),s("br"),s("span",{staticClass:"line-number"},[n._v("166")]),s("br"),s("span",{staticClass:"line-number"},[n._v("167")]),s("br"),s("span",{staticClass:"line-number"},[n._v("168")]),s("br"),s("span",{staticClass:"line-number"},[n._v("169")]),s("br"),s("span",{staticClass:"line-number"},[n._v("170")]),s("br"),s("span",{staticClass:"line-number"},[n._v("171")]),s("br"),s("span",{staticClass:"line-number"},[n._v("172")]),s("br"),s("span",{staticClass:"line-number"},[n._v("173")]),s("br"),s("span",{staticClass:"line-number"},[n._v("174")]),s("br"),s("span",{staticClass:"line-number"},[n._v("175")]),s("br"),s("span",{staticClass:"line-number"},[n._v("176")]),s("br"),s("span",{staticClass:"line-number"},[n._v("177")]),s("br"),s("span",{staticClass:"line-number"},[n._v("178")]),s("br"),s("span",{staticClass:"line-number"},[n._v("179")]),s("br"),s("span",{staticClass:"line-number"},[n._v("180")]),s("br"),s("span",{staticClass:"line-number"},[n._v("181")]),s("br"),s("span",{staticClass:"line-number"},[n._v("182")]),s("br"),s("span",{staticClass:"line-number"},[n._v("183")]),s("br"),s("span",{staticClass:"line-number"},[n._v("184")]),s("br"),s("span",{staticClass:"line-number"},[n._v("185")]),s("br"),s("span",{staticClass:"line-number"},[n._v("186")]),s("br"),s("span",{staticClass:"line-number"},[n._v("187")]),s("br"),s("span",{staticClass:"line-number"},[n._v("188")]),s("br"),s("span",{staticClass:"line-number"},[n._v("189")]),s("br"),s("span",{staticClass:"line-number"},[n._v("190")]),s("br"),s("span",{staticClass:"line-number"},[n._v("191")]),s("br"),s("span",{staticClass:"line-number"},[n._v("192")]),s("br"),s("span",{staticClass:"line-number"},[n._v("193")]),s("br"),s("span",{staticClass:"line-number"},[n._v("194")]),s("br"),s("span",{staticClass:"line-number"},[n._v("195")]),s("br"),s("span",{staticClass:"line-number"},[n._v("196")]),s("br"),s("span",{staticClass:"line-number"},[n._v("197")]),s("br"),s("span",{staticClass:"line-number"},[n._v("198")]),s("br"),s("span",{staticClass:"line-number"},[n._v("199")]),s("br"),s("span",{staticClass:"line-number"},[n._v("200")]),s("br"),s("span",{staticClass:"line-number"},[n._v("201")]),s("br"),s("span",{staticClass:"line-number"},[n._v("202")]),s("br"),s("span",{staticClass:"line-number"},[n._v("203")]),s("br"),s("span",{staticClass:"line-number"},[n._v("204")]),s("br"),s("span",{staticClass:"line-number"},[n._v("205")]),s("br"),s("span",{staticClass:"line-number"},[n._v("206")]),s("br"),s("span",{staticClass:"line-number"},[n._v("207")]),s("br"),s("span",{staticClass:"line-number"},[n._v("208")]),s("br"),s("span",{staticClass:"line-number"},[n._v("209")]),s("br"),s("span",{staticClass:"line-number"},[n._v("210")]),s("br"),s("span",{staticClass:"line-number"},[n._v("211")]),s("br"),s("span",{staticClass:"line-number"},[n._v("212")]),s("br"),s("span",{staticClass:"line-number"},[n._v("213")]),s("br"),s("span",{staticClass:"line-number"},[n._v("214")]),s("br"),s("span",{staticClass:"line-number"},[n._v("215")]),s("br"),s("span",{staticClass:"line-number"},[n._v("216")]),s("br"),s("span",{staticClass:"line-number"},[n._v("217")]),s("br"),s("span",{staticClass:"line-number"},[n._v("218")]),s("br"),s("span",{staticClass:"line-number"},[n._v("219")]),s("br"),s("span",{staticClass:"line-number"},[n._v("220")]),s("br"),s("span",{staticClass:"line-number"},[n._v("221")]),s("br"),s("span",{staticClass:"line-number"},[n._v("222")]),s("br"),s("span",{staticClass:"line-number"},[n._v("223")]),s("br"),s("span",{staticClass:"line-number"},[n._v("224")]),s("br"),s("span",{staticClass:"line-number"},[n._v("225")]),s("br"),s("span",{staticClass:"line-number"},[n._v("226")]),s("br"),s("span",{staticClass:"line-number"},[n._v("227")]),s("br"),s("span",{staticClass:"line-number"},[n._v("228")]),s("br"),s("span",{staticClass:"line-number"},[n._v("229")]),s("br"),s("span",{staticClass:"line-number"},[n._v("230")]),s("br"),s("span",{staticClass:"line-number"},[n._v("231")]),s("br"),s("span",{staticClass:"line-number"},[n._v("232")]),s("br"),s("span",{staticClass:"line-number"},[n._v("233")]),s("br"),s("span",{staticClass:"line-number"},[n._v("234")]),s("br"),s("span",{staticClass:"line-number"},[n._v("235")]),s("br"),s("span",{staticClass:"line-number"},[n._v("236")]),s("br"),s("span",{staticClass:"line-number"},[n._v("237")]),s("br"),s("span",{staticClass:"line-number"},[n._v("238")]),s("br"),s("span",{staticClass:"line-number"},[n._v("239")]),s("br"),s("span",{staticClass:"line-number"},[n._v("240")]),s("br"),s("span",{staticClass:"line-number"},[n._v("241")]),s("br"),s("span",{staticClass:"line-number"},[n._v("242")]),s("br"),s("span",{staticClass:"line-number"},[n._v("243")]),s("br"),s("span",{staticClass:"line-number"},[n._v("244")]),s("br"),s("span",{staticClass:"line-number"},[n._v("245")]),s("br"),s("span",{staticClass:"line-number"},[n._v("246")]),s("br"),s("span",{staticClass:"line-number"},[n._v("247")]),s("br")])]),s("p",[n._v("(@pdai: 从设计的角度，xxl-job可以对上述不同类型进行细分)")]),n._v(" "),s("h4",{attrs:{id:"job的调度配置和执行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#job的调度配置和执行"}},[n._v("#")]),n._v(" Job的调度配置和执行")]),n._v(" "),s("p",[n._v('新增Job, 并把上述的@XxlJob(value="自定义jobhandler名称", init = "JobHandler初始化方法", destroy = "JobHandler销毁方法")中 '),s("strong",[n._v("自定义jobhandler名称")]),n._v(" 填写到JobHandler中。")]),n._v(" "),s("p",[n._v("其它配置如下：")]),n._v(" "),s("p",[s("img",{attrs:{src:a(1153),alt:""}})]),n._v(" "),s("p",[n._v("可以选择操作中执行一次任务，或者启动（按照Cron执行)")]),n._v(" "),s("p",[s("img",{attrs:{src:a(1154),alt:""}})]),n._v(" "),s("p",[n._v("可以查看执行的记录")]),n._v(" "),s("p",[s("img",{attrs:{src:a(1155),alt:""}})]),n._v(" "),s("p",[n._v("进一步可以看每个执行记录的执行日志")]),n._v(" "),s("p",[s("img",{attrs:{src:a(1156),alt:""}})]),n._v(" "),s("h3",{attrs:{id:"bean模式-基于类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bean模式-基于类"}},[n._v("#")]),n._v(" Bean模式(基于类)")]),n._v(" "),s("blockquote",[s("p",[n._v("Bean模式任务，支持基于类的开发方式，每个任务对应一个Java类。")])]),n._v(" "),s("p",[s("strong",[n._v("优点")]),n._v("：不限制项目环境，兼容性好。即使是无框架项目，如main方法直接启动的项目也可以提供支持，可以参考示例项目 “xxl-job-executor-sample-frameless”；")]),n._v(" "),s("p",[s("strong",[n._v("缺点")]),n._v("：")]),n._v(" "),s("ul",[s("li",[n._v("每个任务需要占用一个Java类，造成类的浪费；")]),n._v(" "),s("li",[n._v("不支持自动扫描任务并注入到执行器容器，需要手动注入。")])]),n._v(" "),s("h4",{attrs:{id:"job的开发环境依赖-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#job的开发环境依赖-2"}},[n._v("#")]),n._v(" Job的开发环境依赖")]),n._v(" "),s("p",[n._v("同Bean模式(基于方法)")]),n._v(" "),s("h4",{attrs:{id:"job的开发-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#job的开发-2"}},[n._v("#")]),n._v(" Job的开发")]),n._v(" "),s("p",[n._v("开发步骤：")]),n._v(" "),s("ol",[s("li",[n._v("执行器项目中，开发Job类：\n"),s("ul",[s("li",[n._v('开发一个继承自"com.xxl.job.core.handler.IJobHandler"的JobHandler类，实现其中任务方法。')]),n._v(" "),s("li",[n._v("手动通过如下方式注入到执行器容器。")])])]),n._v(" "),s("li",[n._v("注册jobHandler\n"),s("ul",[s("li",[s("code",[n._v('XxlJobExecutor.registJobHandler("xxxxxJobHandler", new xxxxxJobHandler());')])])])])]),n._v(" "),s("p",[n._v("Job开发")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('package tech.pdai.springboot.xxljob.job;\n\nimport com.xxl.job.core.handler.IJobHandler;\nimport lombok.extern.slf4j.Slf4j;\n\n/**\n * @author pdai\n */\n@Slf4j\npublic class BeanClassDemoJob extends IJobHandler {\n\n    @Override\n    public void execute() throws Exception {\n        log.info("BeanClassDemoJob, execute...");\n    }\n}\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br")])]),s("p",[n._v("注册jobHandler(@pdai: 这里xxl-job设计的不好，是可以通过IJobHandler来自动注册的)")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('XxlJobExecutor.registJobHandler("beanClassDemoJobHandler", new BeanClassDemoJob());\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[n._v("启动SpringBoot应用, 可以发现注册的")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("...\n20:34:15.385 logback [main] INFO  c.x.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job register jobhandler success, name:beanClassDemoJobHandler, jobHandler:tech.pdai.springboot.xxljob.job.BeanClassDemoJob@640ab13c\n...\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br")])]),s("h4",{attrs:{id:"job的调度配置和执行-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#job的调度配置和执行-2"}},[n._v("#")]),n._v(" Job的调度配置和执行")]),n._v(" "),s("p",[n._v("同Bean模式(基于方法)")]),n._v(" "),s("p",[n._v("在调度器中添加执行后，后台执行的日志如下：")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("20:41:00.021 logback [xxl-job, EmbedServer bizThreadPool-1023773196] INFO  c.x.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job regist JobThread success, jobId:5, handler:tech.pdai.springboot.xxljob.job.BeanClassDemoJob@640ab13c\n20:41:00.022 logback [xxl-job, JobThread-5-1654681260021] INFO  t.p.s.xxljob.job.BeanClassDemoJob - BeanClassDemoJob, execute...\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br")])]),s("h3",{attrs:{id:"glue模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#glue模式"}},[n._v("#")]),n._v(" GLUE模式")]),n._v(" "),s("blockquote",[s("p",[n._v("任务以源码方式维护在调度中心，支持通过Web IDE在线更新，实时编译和生效，因此不需要指定JobHandler。")])]),n._v(" "),s("h4",{attrs:{id:"配置和启动流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置和启动流程"}},[n._v("#")]),n._v(" 配置和启动流程")]),n._v(" "),s("p",[n._v("开发流程如下：")]),n._v(" "),s("p",[n._v("创建GLUE类型的Job（这里以Java为例）")]),n._v(" "),s("p",[s("img",{attrs:{src:a(1157),alt:""}})]),n._v(" "),s("p",[n._v("选中指定任务，点击该任务右侧“GLUE”按钮，将会前往GLUE任务的Web IDE界面，在该界面支持对任务代码进行开发（也可以在IDE中开发完成后，复制粘贴到编辑中）。")]),n._v(" "),s("p",[n._v("版本回溯功能（支持30个版本的版本回溯）：在GLUE任务的Web IDE界面，选择右上角下拉框“版本回溯”，会列出该GLUE的更新历史，选择相应版本即可显示该版本代码，保存后GLUE代码即回退到对应的历史版本；")]),n._v(" "),s("p",[s("img",{attrs:{src:a(1158),alt:""}})]),n._v(" "),s("p",[n._v("执行后的记录如下")]),n._v(" "),s("p",[s("img",{attrs:{src:a(1159),alt:""}})]),n._v(" "),s("h4",{attrs:{id:"glue模式还有哪些"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#glue模式还有哪些"}},[n._v("#")]),n._v(" GLUE模式还有哪些")]),n._v(" "),s("p",[n._v("xxl-job一共支持如下几种GLUE模式：")]),n._v(" "),s("ul",[s("li",[n._v('GLUE模式(Java)：任务以源码方式维护在调度中心；该模式的任务实际上是一段继承自IJobHandler的Java类代码并 "groovy" 源码方式维护，它在执行器项目中运行，可使用@Resource/@Autowire注入执行器里中的其他服务；')]),n._v(" "),s("li",[n._v('GLUE模式(Shell)：任务以源码方式维护在调度中心；该模式的任务实际上是一段 "shell" 脚本；')]),n._v(" "),s("li",[n._v('GLUE模式(Python)：任务以源码方式维护在调度中心；该模式的任务实际上是一段 "python" 脚本；')]),n._v(" "),s("li",[n._v('GLUE模式(PHP)：任务以源码方式维护在调度中心；该模式的任务实际上是一段 "php" 脚本；')]),n._v(" "),s("li",[n._v('GLUE模式(NodeJS)：任务以源码方式维护在调度中心；该模式的任务实际上是一段 "nodejs" 脚本；')]),n._v(" "),s("li",[n._v('GLUE模式(PowerShell)：任务以源码方式维护在调度中心；该模式的任务实际上是一段 "PowerShell" 脚本；')])]),n._v(" "),s("h3",{attrs:{id:"更多配置的说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更多配置的说明"}},[n._v("#")]),n._v(" 更多配置的说明")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('+ 基础配置：\n  - 执行器：任务的绑定的执行器，任务触发调度时将会自动发现注册成功的执行器, 实现任务自动发现功能; 另一方面也可以方便的进行任务分组。每个任务必须绑定一个执行器, 可在 "执行器管理" 进行设置;\n  - 任务描述：任务的描述信息，便于任务管理；\n  - 负责人：任务的负责人；\n  - 报警邮件：任务调度失败时邮件通知的邮箱地址，支持配置多邮箱地址，配置多个邮箱地址时用逗号分隔；\n\n+ 触发配置：\n  - 调度类型：\n      + 无：该类型不会主动触发调度；\n      + CRON：该类型将会通过CRON，触发任务调度；\n      + 固定速度：该类型将会以固定速度，触发任务调度；按照固定的间隔时间，周期性触发；\n      + 固定延迟：该类型将会以固定延迟，触发任务调度；按照固定的延迟时间，从上次调度结束后开始计算延迟时间，到达延迟时间后触发下次调度；\n  - CRON：触发任务执行的Cron表达式；\n  - 固定速度：固件速度的时间间隔，单位为秒；\n  - 固定延迟：固件延迟的时间间隔，单位为秒；\n    \n+ 高级配置：\n    - 路由策略：当执行器集群部署时，提供丰富的路由策略，包括；\n        FIRST（第一个）：固定选择第一个机器；\n        LAST（最后一个）：固定选择最后一个机器；\n        ROUND（轮询）：；\n        RANDOM（随机）：随机选择在线的机器；\n        CONSISTENT_HASH（一致性HASH）：每个任务按照Hash算法固定选择某一台机器，且所有任务均匀散列在不同机器上。\n        LEAST_FREQUENTLY_USED（最不经常使用）：使用频率最低的机器优先被选举；\n        LEAST_RECENTLY_USED（最近最久未使用）：最久未使用的机器优先被选举；\n        FAILOVER（故障转移）：按照顺序依次进行心跳检测，第一个心跳检测成功的机器选定为目标执行器并发起调度；\n        BUSYOVER（忙碌转移）：按照顺序依次进行空闲检测，第一个空闲检测成功的机器选定为目标执行器并发起调度；\n        SHARDING_BROADCAST(分片广播)：广播触发对应集群中所有机器执行一次任务，同时系统自动传递分片参数；可根据分片参数开发分片任务；\n    - 子任务：每个任务都拥有一个唯一的任务ID(任务ID可以从任务列表获取)，当本任务执行结束并且执行成功时，将会触发子任务ID所对应的任务的一次主动调度。\n    - 调度过期策略：\n        - 忽略：调度过期后，忽略过期的任务，从当前时间开始重新计算下次触发时间；\n        - 立即执行一次：调度过期后，立即执行一次，并从当前时间开始重新计算下次触发时间；\n    - 阻塞处理策略：调度过于密集执行器来不及处理时的处理策略；\n        单机串行（默认）：调度请求进入单机执行器后，调度请求进入FIFO队列并以串行方式运行；\n        丢弃后续调度：调度请求进入单机执行器后，发现执行器存在运行的调度任务，本次请求将会被丢弃并标记为失败；\n        覆盖之前调度：调度请求进入单机执行器后，发现执行器存在运行的调度任务，将会终止运行中的调度任务并清空队列，然后运行本地调度任务；\n    - 任务超时时间：支持自定义任务超时时间，任务运行超时将会主动中断任务；\n    - 失败重试次数；支持自定义任务失败重试次数，当任务失败时将会按照预设的失败重试次数主动进行重试；\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br"),s("span",{staticClass:"line-number"},[n._v("38")]),s("br")])]),s("h1",{attrs:{id:"示例源码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例源码"}},[n._v("#")]),n._v(" 示例源码")]),n._v(" "),s("hr"),n._v(" "),s("p",[n._v("https://github.com/realpdai/tech-pdai-spring-demos")])])}),[],!1,null,null,null);s.default=t.exports}}]);