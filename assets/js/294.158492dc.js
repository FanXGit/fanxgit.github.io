(window.webpackJsonp=window.webpackJsonp||[]).push([[294],{1174:function(n,e,t){n.exports=t.p+"assets/img/springboot-file-pdf-itext-2.a976689b.png"},1175:function(n,e,t){n.exports=t.p+"assets/img/springboot-file-pdf-itext-1.2f5245dc.png"},1176:function(n,e,t){n.exports=t.p+"assets/img/springboot-file-pdf-itext-3.d1778422.png"},3715:function(n,e,t){"use strict";t.r(e);var s=t(7),a=Object(s.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"springboot集成文件-集成itextpdf之导出pdf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#springboot集成文件-集成itextpdf之导出pdf"}},[n._v("#")]),n._v(" SpringBoot集成文件 - 集成itextpdf之导出PDF")]),n._v(" "),e("blockquote",[e("p",[n._v("除了处理word, excel等文件外，最为常见的就是PDF的导出了。在java技术栈中，PDF创建和操作最为常用的itext了，但是使用itext一定要了解其版本历史和License问题，在早前版本使用的是MPL和LGPL双许可协议，在5.x以上版本中使用的是AGPLv3(这个协议意味着，只有个人用途和开源的项目才能使用itext这个库，否则是需要收费的)。本文主要介绍通过SpringBoot集成itextpdf实现PDF导出功能。@pdai")])]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#springboot%E9%9B%86%E6%88%90%E6%96%87%E4%BB%B6---%E9%9B%86%E6%88%90itextpdf%E4%B9%8B%E5%AF%BC%E5%87%BApdf"}},[n._v("SpringBoot集成文件 - 集成itextpdf之导出PDF")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E7%9F%A5%E8%AF%86%E5%87%86%E5%A4%87"}},[n._v("知识准备")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E4%BB%80%E4%B9%88%E6%98%AFitext"}},[n._v("什么是itext")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#itext%E7%9A%84%E5%8E%86%E5%8F%B2%E7%89%88%E6%9C%AC%E5%92%8Clicense%E9%97%AE%E9%A2%98"}},[n._v("itext的历史版本和License问题")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E6%A0%87%E5%87%86%E7%9A%84itextpdf%E5%AF%BC%E5%87%BA%E7%9A%84%E6%AD%A5%E9%AA%A4"}},[n._v("标准的itextpdf导出的步骤")])])])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E5%AE%9E%E7%8E%B0%E6%A1%88%E4%BE%8B"}},[n._v("实现案例")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#pom%E4%BE%9D%E8%B5%96"}},[n._v("Pom依赖")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E5%AF%BC%E5%87%BApdf"}},[n._v("导出PDF")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E6%B7%BB%E5%8A%A0%E9%A1%B5%E7%9C%89%E9%A1%B5%E8%84%9A%E5%92%8C%E6%B0%B4%E5%8D%B0"}},[n._v("添加页眉页脚和水印")])])])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%90%86%E8%A7%A3"}},[n._v("进一步理解")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E9%81%87%E5%88%B0license%E9%97%AE%E9%A2%98%E6%80%8E%E4%B9%88%E5%8A%9E"}},[n._v("遇到license问题怎么办")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E4%B8%BA%E4%BD%95%E6%B7%BB%E5%8A%A0%E9%A1%B5%E7%9C%89%E9%A1%B5%E8%84%9A%E5%92%8C%E6%B0%B4%E5%8D%B0%E6%98%AF%E9%80%9A%E8%BF%87pdfpageevent%E6%9D%A5%E5%AE%8C%E6%88%90"}},[n._v("为何添加页眉页脚和水印是通过PdfPageEvent来完成")])])])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E7%A4%BA%E4%BE%8B%E6%BA%90%E7%A0%81"}},[n._v("示例源码")])]),n._v(" "),e("li",[e("a",{attrs:{href:"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"}},[n._v("参考文章")])])])])]),n._v(" "),e("h1",{attrs:{id:"知识准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#知识准备"}},[n._v("#")]),n._v(" 知识准备")]),n._v(" "),e("hr"),n._v(" "),e("blockquote",[e("p",[n._v("需要了解itext，以及itext历史版本变迁，以及license的问题。")])]),n._v(" "),e("h3",{attrs:{id:"什么是itext"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是itext"}},[n._v("#")]),n._v(" 什么是itext")]),n._v(" "),e("blockquote",[e("p",[n._v("来源于百度百科：iText是著名的开放源码的站点sourceforge一个项目(由Bruno Lowagie编写)，是一个用Java和.NET语言写的库，用来创建和修改PDF文件。通过iText不仅可以生成PDF或rtf的文档，而且可以将XML、Html文件转化为PDF文件。 iText的安装非常方便，下载iText.jar文件后，只需要在系统的CLASSPATH中加入iText.jar的路径，在程序中就可以使用iText类库了。")])]),n._v(" "),e("p",[n._v("iText提供除了基本的创建、修改PDF文件外的其他高级的PDF特性，例如基于PKI的签名，40位和128位加密，颜色校正，带标签的PDF，PDF表单(AcroForms)，PDF/X,通过ICC配置文件和条形码进行颜色管理。这些特性被一些产品和服务中使用，包括Eclipse BIRT，Jasper Reports，JBoss Seam，Windward Reports和pdftk。")]),n._v(" "),e("p",[n._v("一般情况下，iText使用在有以下一个要求的项目中：")]),n._v(" "),e("ul",[e("li",[n._v("内容无法提前利用：取决于用户的输入或实时的数据库信息。")]),n._v(" "),e("li",[n._v("由于内容，页面过多，PDF文档不能手动生成。")]),n._v(" "),e("li",[n._v("文档需在无人参与，批处理模式下自动创建。")]),n._v(" "),e("li",[n._v("内容被定制或个性化；例如，终端客户的名字需要标记在大量的页面上。")])]),n._v(" "),e("h3",{attrs:{id:"itext的历史版本和license问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#itext的历史版本和license问题"}},[n._v("#")]),n._v(" itext的历史版本和License问题")]),n._v(" "),e("blockquote",[e("p",[n._v("使用itext一定要了解其版本历史，和License问题，在早前版本使用的是"),e("strong",[n._v("MPL和LGPL双许可协议")]),n._v("，在5.x以上版本中使用的是"),e("strong",[n._v("AGPLv3")]),n._v("(这个协议意味着，只有个人用途和开源的项目才能使用itext这个库，否则是需要收费的)")])]),n._v(" "),e("ul",[e("li",[e("strong",[n._v("iText 0.x-2.x/iTextSharp 3.x-4.x")]),n._v(" "),e("ul",[e("li",[n._v("更新时间是2000-2009")]),n._v(" "),e("li",[n._v("使用的是"),e("strong",[n._v("MPL和LGPL双许可协议")])]),n._v(" "),e("li",[n._v("最近的更新是2009年，版本号是"),e("strong",[n._v("iText 2.1.7")]),n._v("/iTextSharp 4.1.6.0")]),n._v(" "),e("li",[n._v("此时引入包的GAV版本如下：")])])])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("<dependency>\n  <groupId>com.lowagie</groupId>\n  <artifactId>itext</artifactId>\n  <version>2.1.7</version>\n</dependency>\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br")])]),e("ul",[e("li",[e("strong",[n._v("iText 5.x和iTextSharp 5.x")]),n._v(" "),e("ul",[e("li",[n._v("更新时间是2009-2016, 公司化运作，并标准化和提高性能")]),n._v(" "),e("li",[n._v("开始使用**"),e("a",{attrs:{href:"https://github.com/itext/itextpdf/blob/develop/LICENSE.md",target:"_blank",rel:"noopener noreferrer"}},[n._v("AGPLv3协议 在新窗口打开"),e("OutboundLink")],1),n._v("**\n"),e("ul",[e("li",[e("strong",[n._v("只有个人用途和开源的项目才能使用itext这个库，否则是需要收费的")])])])]),n._v(" "),e("li",[n._v("iTextSharp被设计成iText库的.NET版本，并且与iText版本号同步，iText 5.0.0和iTextSharp5.0.0同时发布")]),n._v(" "),e("li",[n._v("新功能不在这里面增加，但是官方会修复重要的bug")]),n._v(" "),e("li",[n._v("此时引入包的GAV版本如下：")])])])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("<dependency>\n  <groupId>com.itextpdf</groupId>\n  <artifactId>itextpdf</artifactId>\n  <version>5.5.13.3</version>\n</dependency>\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br")])]),e("ul",[e("li",[e("strong",[n._v("iText 7.x")]),n._v(" "),e("ul",[e("li",[n._v("更新时间是2016到现在")]),n._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/itext/itextpdf/blob/develop/LICENSE.md",target:"_blank",rel:"noopener noreferrer"}},[n._v("AGPLv3协议 在新窗口打开"),e("OutboundLink")],1)]),n._v(" "),e("li",[n._v("完全重写，重点关注可扩展性和模块化")]),n._v(" "),e("li",[n._v("不适用iTextSharp这个名称，都统称为iText,有Java和.Net版本")]),n._v(" "),e("li",[n._v("JDK 1.7+")]),n._v(" "),e("li",[n._v("此时引入包的GAV版本如下：")])])])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("<dependency>\n  <groupId>com.itextpdf</groupId>\n  <artifactId>itext7-core</artifactId>\n  <version>7.2.2</version>\n  <type>pom</type>\n</dependency>\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br")])]),e("p",[n._v("注：iText变化后，GitHub上有团队基于4.x版本（MPL和LGPL双许可协议）fork了一个分支成为"),e("a",{attrs:{href:"https://github.com/LibrePDF/OpenPDF/",target:"_blank",rel:"noopener noreferrer"}},[n._v("OpenPDF 在新窗口打开"),e("OutboundLink")],1),n._v("，并继续维护该项目。")]),n._v(" "),e("h3",{attrs:{id:"标准的itextpdf导出的步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#标准的itextpdf导出的步骤"}},[n._v("#")]),n._v(" 标准的itextpdf导出的步骤")]),n._v(" "),e("p",[n._v("itextpdf导出pdf主要包含如下几步：")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("@Override\npublic Document generateItextPdfDocument(OutputStream os) throws Exception {\n    // 1. 创建文档\n    Document document = new Document(PageSize.A4);\n\n    // 2. 绑定输出流（通过pdfwriter)\n    PdfWriter.getInstance(document, os);\n\n    // 3. 打开文档\n    document.open();\n\n    // 4. 往文档中添加内容\n    document.add(xxx);\n\n    // 5. 关闭文档\n    document.close();\n    return document;\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br")])]),e("p",[n._v("document中添加的Element有哪些呢？")]),n._v(" "),e("p",[e("img",{attrs:{src:t(1174),alt:""}})]),n._v(" "),e("p",[n._v("需要说明下如下概念之前的差别：")]),n._v(" "),e("ul",[e("li",[e("strong",[n._v("Chunk")]),n._v("：文档的文本的最小块单位")]),n._v(" "),e("li",[e("strong",[n._v("Phrase")]),n._v("：一系列以特定间距（两行之间的距离）作为参数的块")]),n._v(" "),e("li",[e("strong",[n._v("Paragraph")]),n._v("：段落是一系列块和（或）短句。同短句一样，段落有确定的间距。用户还可以指定缩排；在边和（或）右边保留一定空白，段落可以左对齐、右对齐和居中对齐。添加到文档中的每一个段落将自动另起一行。")])]),n._v(" "),e("p",[n._v("（其它从字面上就可以看出，所以这里具体就不做解释了）")]),n._v(" "),e("h1",{attrs:{id:"实现案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实现案例"}},[n._v("#")]),n._v(" 实现案例")]),n._v(" "),e("hr"),n._v(" "),e("blockquote",[e("p",[n._v("这里展示SpringBoot集成itext5导出PDF的例子。")])]),n._v(" "),e("h3",{attrs:{id:"pom依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pom依赖"}},[n._v("#")]),n._v(" Pom依赖")]),n._v(" "),e("p",[n._v("引入poi的依赖包")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("<dependency>\n    <groupId>com.itextpdf</groupId>\n    <artifactId>itextpdf</artifactId>\n    <version>5.5.13.3</version>\n</dependency>\n<dependency>\n    <groupId>com.itextpdf</groupId>\n    <artifactId>itext-asian</artifactId>\n    <version>5.2.0</version>\n</dependency>\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br")])]),e("h3",{attrs:{id:"导出pdf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导出pdf"}},[n._v("#")]),n._v(" 导出PDF")]),n._v(" "),e("p",[n._v("UserController中导出的方法")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('package tech.pdai.springboot.file.word.poi.controller;\n\n\nimport java.io.OutputStream;\n\nimport javax.servlet.http.HttpServletResponse;\n\nimport io.swagger.annotations.ApiOperation;\nimport org.apache.poi.xwpf.usermodel.XWPFDocument;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport tech.pdai.springboot.file.word.poi.service.IUserService;\n\n/**\n * @author pdai\n */\n@RestController\n@RequestMapping("/user")\npublic class UserController {\n\n    @Autowired\n    private IUserService userService;\n\n    @ApiOperation("Download Word")\n    @GetMapping("/word/download")\n    public void download(HttpServletResponse response) {\n        try {\n            XWPFDocument document = userService.generateWordXWPFDocument();\n            response.reset();\n            response.setContentType("application/vnd.ms-excel");\n            response.setHeader("Content-disposition",\n                    "attachment;filename=user_world_" + System.currentTimeMillis() + ".docx");\n            OutputStream os = response.getOutputStream();\n            document.write(os);\n            os.close();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n}\n\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br")])]),e("p",[n._v("UserServiceImple中导出PDF方法")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('@Override\npublic Document generateItextPdfDocument(OutputStream os) throws Exception {\n    // document\n    Document document = new Document(PageSize.A4);\n    PdfWriter.getInstance(document, os);\n\n    // open\n    document.open();\n\n    // add content - pdf meta information\n    document.addAuthor("pdai");\n    document.addCreationDate();\n    document.addTitle("pdai-pdf-itextpdf");\n    document.addKeywords("pdf-pdai-keyword");\n    document.addCreator("pdai");\n\n    // add content -  page content\n\n    // Title\n    document.add(createTitle("Java 全栈知识体系"));\n\n    // Chapter 1\n    document.add(createChapterH1("1. 知识准备"));\n    document.add(createChapterH2("1.1 什么是POI"));\n    document.add(createParagraph("Apache POI 是创建和维护操作各种符合Office Open XML（OOXML）标准和微软的OLE 2复合文档格式（OLE2）的Java API。用它可以使用Java读取和创建,修改MS Excel文件.而且,还可以使用Java读取和创建MS Word和MSPowerPoint文件。更多请参考[官方文档](https://poi.apache.org/index.html)"));\n    document.add(createChapterH2("1.2 POI中基础概念"));\n    document.add(createParagraph("生成xls和xlsx有什么区别？POI对Excel中的对象的封装对应关系？"));\n\n    // Chapter 2\n    document.add(createChapterH1("2. 实现案例"));\n    document.add(createChapterH2("2.1 用户列表示例"));\n    document.add(createParagraph("以导出用户列表为例"));\n\n    // 表格\n    List<User> userList = getUserList();\n    PdfPTable table = new PdfPTable(new float[]{20, 40, 50, 40, 40});\n    table.setTotalWidth(500);\n    table.setLockedWidth(true);\n    table.setHorizontalAlignment(Element.ALIGN_CENTER);\n    table.getDefaultCell().setBorder(1);\n\n    for (int i = 0; i < userList.size(); i++) {\n        table.addCell(createCell(userList.get(i).getId() + ""));\n        table.addCell(createCell(userList.get(i).getUserName()));\n        table.addCell(createCell(userList.get(i).getEmail()));\n        table.addCell(createCell(userList.get(i).getPhoneNumber() + ""));\n        table.addCell(createCell(userList.get(i).getDescription()));\n    }\n    document.add(table);\n\n    document.add(createChapterH2("2.2 图片导出示例"));\n    document.add(createParagraph("以导出图片为例"));\n    // 图片\n    Resource resource = new ClassPathResource("pdai-guli.png");\n    Image image = Image.getInstance(resource.getURL());\n    // Image image = Image.getInstance("/Users/pdai/pdai/www/tech-pdai-spring-demos/481-springboot-demo-file-pdf-itextpdf/src/main/resources/pdai-guli.png");\n    image.setAlignment(Element.ALIGN_CENTER);\n    image.scalePercent(60); // 缩放\n    document.add(image);\n\n    // close\n    document.close();\n    return document;\n}\n\nprivate List<User> getUserList() {\n    List<User> userList = new ArrayList<>();\n    for (int i = 0; i < 5; i++) {\n        userList.add(User.builder()\n                .id(Long.parseLong(i + "")).userName("pdai" + i).email("pdai@pdai.tech" + i).phoneNumber(121231231231L)\n                .description("hello world" + i)\n                .build());\n    }\n    return userList;\n}\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br"),e("span",{staticClass:"line-number"},[n._v("47")]),e("br"),e("span",{staticClass:"line-number"},[n._v("48")]),e("br"),e("span",{staticClass:"line-number"},[n._v("49")]),e("br"),e("span",{staticClass:"line-number"},[n._v("50")]),e("br"),e("span",{staticClass:"line-number"},[n._v("51")]),e("br"),e("span",{staticClass:"line-number"},[n._v("52")]),e("br"),e("span",{staticClass:"line-number"},[n._v("53")]),e("br"),e("span",{staticClass:"line-number"},[n._v("54")]),e("br"),e("span",{staticClass:"line-number"},[n._v("55")]),e("br"),e("span",{staticClass:"line-number"},[n._v("56")]),e("br"),e("span",{staticClass:"line-number"},[n._v("57")]),e("br"),e("span",{staticClass:"line-number"},[n._v("58")]),e("br"),e("span",{staticClass:"line-number"},[n._v("59")]),e("br"),e("span",{staticClass:"line-number"},[n._v("60")]),e("br"),e("span",{staticClass:"line-number"},[n._v("61")]),e("br"),e("span",{staticClass:"line-number"},[n._v("62")]),e("br"),e("span",{staticClass:"line-number"},[n._v("63")]),e("br"),e("span",{staticClass:"line-number"},[n._v("64")]),e("br"),e("span",{staticClass:"line-number"},[n._v("65")]),e("br"),e("span",{staticClass:"line-number"},[n._v("66")]),e("br"),e("span",{staticClass:"line-number"},[n._v("67")]),e("br"),e("span",{staticClass:"line-number"},[n._v("68")]),e("br"),e("span",{staticClass:"line-number"},[n._v("69")]),e("br"),e("span",{staticClass:"line-number"},[n._v("70")]),e("br"),e("span",{staticClass:"line-number"},[n._v("71")]),e("br"),e("span",{staticClass:"line-number"},[n._v("72")]),e("br"),e("span",{staticClass:"line-number"},[n._v("73")]),e("br"),e("span",{staticClass:"line-number"},[n._v("74")]),e("br"),e("span",{staticClass:"line-number"},[n._v("75")]),e("br")])]),e("p",[n._v("在实现时可以将如下创建文档内容的方法封装到Util工具类中")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('\nprivate Paragraph createTitle(String content) throws IOException, DocumentException {\n    Font font = new Font(getBaseFont(), 24, Font.BOLD);\n    Paragraph paragraph = new Paragraph(content, font);\n    paragraph.setAlignment(Element.ALIGN_CENTER);\n    return paragraph;\n}\n\n\nprivate Paragraph createChapterH1(String content) throws IOException, DocumentException {\n    Font font = new Font(getBaseFont(), 22, Font.BOLD);\n    Paragraph paragraph = new Paragraph(content, font);\n    paragraph.setAlignment(Element.ALIGN_LEFT);\n    return paragraph;\n}\n\nprivate Paragraph createChapterH2(String content) throws IOException, DocumentException {\n    Font font = new Font(getBaseFont(), 18, Font.BOLD);\n    Paragraph paragraph = new Paragraph(content, font);\n    paragraph.setAlignment(Element.ALIGN_LEFT);\n    return paragraph;\n}\n\nprivate Paragraph createParagraph(String content) throws IOException, DocumentException {\n    Font font = new Font(getBaseFont(), 12, Font.NORMAL);\n    Paragraph paragraph = new Paragraph(content, font);\n    paragraph.setAlignment(Element.ALIGN_LEFT);\n    paragraph.setIndentationLeft(12); //设置左缩进\n    paragraph.setIndentationRight(12); //设置右缩进\n    paragraph.setFirstLineIndent(24); //设置首行缩进\n    paragraph.setLeading(20f); //行间距\n    paragraph.setSpacingBefore(5f); //设置段落上空白\n    paragraph.setSpacingAfter(10f); //设置段落下空白\n    return paragraph;\n}\n\npublic PdfPCell createCell(String content) throws IOException, DocumentException {\n    PdfPCell cell = new PdfPCell();\n    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);\n    cell.setHorizontalAlignment(Element.ALIGN_CENTER);\n    Font font = new Font(getBaseFont(), 12, Font.NORMAL);\n    cell.setPhrase(new Phrase(content, font));\n    return cell;\n}\n\nprivate BaseFont getBaseFont() throws IOException, DocumentException {\n    return BaseFont.createFont("STSong-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);\n}\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br"),e("span",{staticClass:"line-number"},[n._v("47")]),e("br"),e("span",{staticClass:"line-number"},[n._v("48")]),e("br")])]),e("p",[n._v("导出后的PDF")]),n._v(" "),e("p",[e("img",{attrs:{src:t(1175),alt:""}})]),n._v(" "),e("h3",{attrs:{id:"添加页眉页脚和水印"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加页眉页脚和水印"}},[n._v("#")]),n._v(" 添加页眉页脚和水印")]),n._v(" "),e("blockquote",[e("p",[n._v("在itextpdf 5.x 中可以利用PdfPageEvent来完成页眉页脚和水印。")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('package tech.pdai.springboot.file.pdf.itextpdf.pdf;\n\nimport com.itextpdf.text.BaseColor;\nimport com.itextpdf.text.Document;\nimport com.itextpdf.text.Element;\nimport com.itextpdf.text.Phrase;\nimport com.itextpdf.text.pdf.BaseFont;\nimport com.itextpdf.text.pdf.ColumnText;\nimport com.itextpdf.text.pdf.PdfContentByte;\nimport com.itextpdf.text.pdf.PdfGState;\nimport com.itextpdf.text.pdf.PdfPageEventHelper;\nimport com.itextpdf.text.pdf.PdfTemplate;\nimport com.itextpdf.text.pdf.PdfWriter;\n\n/**\n * @author pdai\n */\npublic class MyHeaderFooterPageEventHelper extends PdfPageEventHelper {\n\n    private String headLeftTitle;\n\n    private String headRightTitle;\n\n    private String footerLeft;\n\n    private String waterMark;\n\n    private PdfTemplate total;\n\n    public MyHeaderFooterPageEventHelper(String headLeftTitle, String headRightTitle, String footerLeft, String waterMark) {\n        this.headLeftTitle = headLeftTitle;\n        this.headRightTitle = headRightTitle;\n        this.footerLeft = footerLeft;\n        this.waterMark = waterMark;\n    }\n\n    @Override\n    public void onOpenDocument(PdfWriter writer, Document document) {\n        total = writer.getDirectContent().createTemplate(30, 16);\n    }\n\n    @Override\n    public void onEndPage(PdfWriter writer, Document document) {\n        BaseFont bf = null;\n        try {\n            bf = BaseFont.createFont("STSong-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n\n        // page header and footer\n        addPageHeaderAndFooter(writer, document, bf);\n\n        // watermark\n        if (waterMark!=null) {\n            addWaterMark(writer, document, bf);\n        }\n    }\n\n    private void addPageHeaderAndFooter(PdfWriter writer, Document document, BaseFont bf) {\n        PdfContentByte cb = writer.getDirectContent();\n        cb.saveState();\n\n        cb.beginText();\n\n        cb.setColorFill(BaseColor.GRAY);\n        cb.setFontAndSize(bf, 10);\n\n\n        // header\n        float x = document.top(-10);\n        cb.showTextAligned(PdfContentByte.ALIGN_LEFT,\n                headLeftTitle,\n                document.left(), x, 0);\n        cb.showTextAligned(PdfContentByte.ALIGN_RIGHT,\n                headRightTitle,\n                document.right(), x, 0);\n\n        // footer\n        float y = document.bottom(-10);\n        cb.showTextAligned(PdfContentByte.ALIGN_LEFT,\n                footerLeft,\n                document.left(), y, 0);\n        cb.showTextAligned(PdfContentByte.ALIGN_CENTER,\n                String.format("- %d -", writer.getPageNumber()),\n                (document.right() + document.left()) / 2,\n                y, 0);\n\n        cb.endText();\n\n        cb.restoreState();\n    }\n\n    private void addWaterMark(PdfWriter writer, Document document, BaseFont bf) {\n        for (int i = 1; i < 7; i++) {\n            for (int j = 1; j < 10; j++) {\n                PdfContentByte cb = writer.getDirectContent();\n                cb.saveState();\n                cb.beginText();\n                cb.setColorFill(BaseColor.GRAY);\n                PdfGState gs = new PdfGState();\n                gs.setFillOpacity(0.1f);\n                cb.setGState(gs);\n                cb.setFontAndSize(bf, 12);\n                cb.showTextAligned(Element.ALIGN_MIDDLE, waterMark, 75 * i,\n                        80 * j, 30);\n                cb.endText();\n                cb.restoreState();\n            }\n        }\n    }\n\n    @Override\n    public void onCloseDocument(PdfWriter writer, Document document) {\n        ColumnText.showTextAligned(total, Element.ALIGN_LEFT, new Phrase(String.valueOf(writer.getPageNumber() - 1)), 2,\n                2, 0);\n    }\n}\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br"),e("span",{staticClass:"line-number"},[n._v("47")]),e("br"),e("span",{staticClass:"line-number"},[n._v("48")]),e("br"),e("span",{staticClass:"line-number"},[n._v("49")]),e("br"),e("span",{staticClass:"line-number"},[n._v("50")]),e("br"),e("span",{staticClass:"line-number"},[n._v("51")]),e("br"),e("span",{staticClass:"line-number"},[n._v("52")]),e("br"),e("span",{staticClass:"line-number"},[n._v("53")]),e("br"),e("span",{staticClass:"line-number"},[n._v("54")]),e("br"),e("span",{staticClass:"line-number"},[n._v("55")]),e("br"),e("span",{staticClass:"line-number"},[n._v("56")]),e("br"),e("span",{staticClass:"line-number"},[n._v("57")]),e("br"),e("span",{staticClass:"line-number"},[n._v("58")]),e("br"),e("span",{staticClass:"line-number"},[n._v("59")]),e("br"),e("span",{staticClass:"line-number"},[n._v("60")]),e("br"),e("span",{staticClass:"line-number"},[n._v("61")]),e("br"),e("span",{staticClass:"line-number"},[n._v("62")]),e("br"),e("span",{staticClass:"line-number"},[n._v("63")]),e("br"),e("span",{staticClass:"line-number"},[n._v("64")]),e("br"),e("span",{staticClass:"line-number"},[n._v("65")]),e("br"),e("span",{staticClass:"line-number"},[n._v("66")]),e("br"),e("span",{staticClass:"line-number"},[n._v("67")]),e("br"),e("span",{staticClass:"line-number"},[n._v("68")]),e("br"),e("span",{staticClass:"line-number"},[n._v("69")]),e("br"),e("span",{staticClass:"line-number"},[n._v("70")]),e("br"),e("span",{staticClass:"line-number"},[n._v("71")]),e("br"),e("span",{staticClass:"line-number"},[n._v("72")]),e("br"),e("span",{staticClass:"line-number"},[n._v("73")]),e("br"),e("span",{staticClass:"line-number"},[n._v("74")]),e("br"),e("span",{staticClass:"line-number"},[n._v("75")]),e("br"),e("span",{staticClass:"line-number"},[n._v("76")]),e("br"),e("span",{staticClass:"line-number"},[n._v("77")]),e("br"),e("span",{staticClass:"line-number"},[n._v("78")]),e("br"),e("span",{staticClass:"line-number"},[n._v("79")]),e("br"),e("span",{staticClass:"line-number"},[n._v("80")]),e("br"),e("span",{staticClass:"line-number"},[n._v("81")]),e("br"),e("span",{staticClass:"line-number"},[n._v("82")]),e("br"),e("span",{staticClass:"line-number"},[n._v("83")]),e("br"),e("span",{staticClass:"line-number"},[n._v("84")]),e("br"),e("span",{staticClass:"line-number"},[n._v("85")]),e("br"),e("span",{staticClass:"line-number"},[n._v("86")]),e("br"),e("span",{staticClass:"line-number"},[n._v("87")]),e("br"),e("span",{staticClass:"line-number"},[n._v("88")]),e("br"),e("span",{staticClass:"line-number"},[n._v("89")]),e("br"),e("span",{staticClass:"line-number"},[n._v("90")]),e("br"),e("span",{staticClass:"line-number"},[n._v("91")]),e("br"),e("span",{staticClass:"line-number"},[n._v("92")]),e("br"),e("span",{staticClass:"line-number"},[n._v("93")]),e("br"),e("span",{staticClass:"line-number"},[n._v("94")]),e("br"),e("span",{staticClass:"line-number"},[n._v("95")]),e("br"),e("span",{staticClass:"line-number"},[n._v("96")]),e("br"),e("span",{staticClass:"line-number"},[n._v("97")]),e("br"),e("span",{staticClass:"line-number"},[n._v("98")]),e("br"),e("span",{staticClass:"line-number"},[n._v("99")]),e("br"),e("span",{staticClass:"line-number"},[n._v("100")]),e("br"),e("span",{staticClass:"line-number"},[n._v("101")]),e("br"),e("span",{staticClass:"line-number"},[n._v("102")]),e("br"),e("span",{staticClass:"line-number"},[n._v("103")]),e("br"),e("span",{staticClass:"line-number"},[n._v("104")]),e("br"),e("span",{staticClass:"line-number"},[n._v("105")]),e("br"),e("span",{staticClass:"line-number"},[n._v("106")]),e("br"),e("span",{staticClass:"line-number"},[n._v("107")]),e("br"),e("span",{staticClass:"line-number"},[n._v("108")]),e("br"),e("span",{staticClass:"line-number"},[n._v("109")]),e("br"),e("span",{staticClass:"line-number"},[n._v("110")]),e("br"),e("span",{staticClass:"line-number"},[n._v("111")]),e("br"),e("span",{staticClass:"line-number"},[n._v("112")]),e("br"),e("span",{staticClass:"line-number"},[n._v("113")]),e("br"),e("span",{staticClass:"line-number"},[n._v("114")]),e("br"),e("span",{staticClass:"line-number"},[n._v("115")]),e("br"),e("span",{staticClass:"line-number"},[n._v("116")]),e("br"),e("span",{staticClass:"line-number"},[n._v("117")]),e("br"),e("span",{staticClass:"line-number"},[n._v("118")]),e("br")])]),e("p",[n._v("添加水印后导出后的PDF")]),n._v(" "),e("p",[e("img",{attrs:{src:t(1176),alt:""}})]),n._v(" "),e("h1",{attrs:{id:"进一步理解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#进一步理解"}},[n._v("#")]),n._v(" 进一步理解")]),n._v(" "),e("hr"),n._v(" "),e("blockquote",[e("p",[n._v("通过如下几个问题进一步理解itextpdf。")])]),n._v(" "),e("h3",{attrs:{id:"遇到license问题怎么办"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#遇到license问题怎么办"}},[n._v("#")]),n._v(" 遇到license问题怎么办")]),n._v(" "),e("p",[n._v("如前文所述，使用itext一定要了解其版本历史和License问题，在早前版本使用的是"),e("strong",[n._v("MPL和LGPL双许可协议")]),n._v("，在5.x以上版本中使用的是"),e("strong",[n._v("AGPLv3")]),n._v("。 有两种选择：")]),n._v(" "),e("ol",[e("li",[n._v("使用2.1.7版本")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("<dependency>\n  <groupId>com.lowagie</groupId>\n  <artifactId>itext</artifactId>\n  <version>2.1.7</version>\n</dependency>\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[n._v("使用OpenPDF")])]),n._v(" "),e("p",[n._v("GitHub上有团队基于itext 4.x版本（MPL和LGPL双许可协议）fork了一个分支成为"),e("a",{attrs:{href:"https://github.com/LibrePDF/OpenPDF/",target:"_blank",rel:"noopener noreferrer"}},[n._v("OpenPDF 在新窗口打开"),e("OutboundLink")],1),n._v("，并继续维护该项目。")]),n._v(" "),e("h3",{attrs:{id:"为何添加页眉页脚和水印是通过pdfpageevent来完成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为何添加页眉页脚和水印是通过pdfpageevent来完成"}},[n._v("#")]),n._v(" 为何添加页眉页脚和水印是通过PdfPageEvent来完成")]),n._v(" "),e("blockquote",[e("p",[n._v("为何添加页眉页脚和水印是通过PdfPageEvent来完成？")])]),n._v(" "),e("p",[n._v('举个例子，如果我们在上述例子中需要在页脚中显示 “Page 1 of 3", 即总页数怎么办呢？而itext是流模式的写入内容，只有写到最后，才能知道有多少页，那么显示总页数必须在内容写完之后（或者关闭之前）确定；这就是为什么在onEndPage方法时才会写每页的页眉页脚。')]),n._v(" "),e("p",[n._v("iText仅在调用释放模板方法后才将PdfTemplate写入到OutputStream中，否则对象将一直保存在内存中，直到关闭文档。所以我们可以在最后关闭文档前，使用PdfTemplate写入总页码。可以理解成先写个占位符，然后统一替换。")]),n._v(" "),e("h1",{attrs:{id:"示例源码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#示例源码"}},[n._v("#")]),n._v(" 示例源码")]),n._v(" "),e("hr"),n._v(" "),e("p",[n._v("https://github.com/realpdai/tech-pdai-spring-demos")]),n._v(" "),e("h1",{attrs:{id:"参考文章"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[n._v("#")]),n._v(" 参考文章")]),n._v(" "),e("hr"),n._v(" "),e("p",[n._v("https://itextpdf.com")]),n._v(" "),e("p",[n._v("https://blog.csdn.net/u012397189/article/details/80196974")])])}),[],!1,null,null,null);e.default=a.exports}}]);